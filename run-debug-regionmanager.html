<!DOCTYPE html>
<html>
<head>
    <title>RegionManager Debug Console</title>
    <style>
        body { font-family: monospace; background: #1e1e1e; color: #fff; padding: 20px; }
        .instructions { background: #2d2d2d; padding: 15px; border-radius: 5px; margin-bottom: 20px; }
        .script { background: #0d47a1; padding: 10px; border-radius: 5px; color: #fff; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <h1>üîç RegionManager Debug Console</h1>
    
    <div class="instructions">
        <h3>Instructions:</h3>
        <p>1. Open your Fast Planner application in another tab</p>
        <p>2. Wait for it to fully load and detect the Gulf of Mexico region</p>
        <p>3. Open the browser console (F12)</p>
        <p>4. Copy and paste this entire script into the console and press Enter</p>
        <p>5. Report back the results to identify why auto-loading isn't working</p>
    </div>

    <div class="script">
        <h3>Copy this script to console:</h3>
        <pre id="script-content">
// Debug why RegionManager auto-loading isn't working
console.log('üîç REGIONMANAGER DEBUG: Checking why auto-loading failed...');

// 1. Check if RegionManager was created
console.log('üìä 1. REGIONMANAGER CREATION:');
console.log('  - window.regionManager exists:', !!window.regionManager);
console.log('  - window.regionManagerRef exists:', !!window.regionManagerRef);

if (window.regionManager) {
  console.log('  - RegionManager methods:', Object.getOwnPropertyNames(window.regionManager.__proto__));
  
  // Test getCurrentRegion
  try {
    const currentRegion = window.regionManager.getCurrentRegion();
    console.log('  - getCurrentRegion() result:', currentRegion);
  } catch (error) {
    console.error('  - getCurrentRegion() error:', error);
  }
} else {
  console.log('  - ‚ùå RegionManager not created - this is the problem!');
}

// 2. Check manager creation logs
console.log('\nüìä 2. MANAGER CREATION LOGS:');
console.log('  Look above for these logs:');
console.log('  - "FastPlannerApp: Creating RegionManager instance"');
console.log('  - "üöÄ AUTO-LOADING: Triggering platform load for region..."');

// 3. Check manager creation conditions
console.log('\nüìä 3. MANAGER CREATION CONDITIONS:');
console.log('  - mapManagerRef.current:', !!window.mapManagerRef?.current);
console.log('  - platformManagerRef.current:', !!window.platformManagerRef?.current);
console.log('  - Both required for RegionManager creation');

// 4. Manual trigger test
console.log('\nüìä 4. MANUAL TRIGGER TEST:');
if (window.platformManager && window.client) {
  console.log('  - Manually triggering Gulf of Mexico platform load...');
  
  window.platformManager.loadPlatformsFromFoundry(window.client, "GULF_OF_MEXICO")
    .then(result => {
      console.log('  ‚úÖ Manual load result:', result?.length || 0, 'platforms');
      if (result?.length > 0) {
        console.log('  - Sample platform:', result[0]);
        
        // Check map after 2 seconds
        setTimeout(() => {
          const map = window.mapManager?.map;
          if (map) {
            const source = map.getSource('major-platforms');
            console.log('  - Map now shows:', source?._data?.features?.length || 0, 'features');
          }
        }, 2000);
      }
    })
    .catch(error => {
      console.error('  ‚ùå Manual load error:', error);
    });
} else {
  console.log('  - ‚ùå Cannot manually trigger - missing platformManager or client');
}

// 5. Check activeRegionFromContext
console.log('\nüìä 5. REGION CONTEXT:');
console.log('  - activeRegionFromContext:', window.activeRegionFromContext);
console.log('  - This should be used by RegionManager');
        </pre>
    </div>

    <p><strong>This will help us identify exactly why the RegionManager auto-loading mechanism isn't triggering despite perfect region detection.</strong></p>
</body>
</html>