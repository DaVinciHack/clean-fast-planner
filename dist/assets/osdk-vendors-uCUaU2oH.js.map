{"version":3,"file":"osdk-vendors-uCUaU2oH.js","sources":["../../node_modules/@osdk/api/build/browser/aggregate/WhereClause.js","../../node_modules/@osdk/api/build/browser/mapping/DurationMapping.js","../../node_modules/@osdk/api/build/browser/groupby/GroupByClause.js","../../node_modules/@osdk/api/build/browser/timeseries/timeseries.js","../../node_modules/@osdk/shared.net.errors/build/browser/PalantirApiError.js","../../node_modules/@osdk/shared.net.errors/build/browser/UnknownError.js","../../node_modules/@osdk/client/build/browser/actions/ActionValidationError.js","../../node_modules/@osdk/api/build/browser/experimental/createMediaReference.js","../../node_modules/@osdk/api/build/browser/experimental/fetchOneByRid.js","../../node_modules/@osdk/api/build/browser/experimental/fetchPageByRid.js","../../node_modules/@osdk/api/build/browser/experimental/getBulkLinks.js","../../node_modules/@osdk/shared.client/index.js","../../node_modules/@osdk/shared.client2/index.js","../../node_modules/@osdk/shared.net.platformapi/node_modules/@osdk/shared.net.errors/build/browser/PalantirApiError.js","../../node_modules/@osdk/shared.net.platformapi/node_modules/@osdk/shared.net.errors/build/browser/UnknownError.js","../../node_modules/@osdk/shared.net.platformapi/build/browser/foundryPlatformFetch.js","../../node_modules/@osdk/foundry.ontologies/build/browser/public/Action.js","../../node_modules/@osdk/foundry.ontologies/build/browser/public/ActionTypeV2.js","../../node_modules/@osdk/foundry.ontologies/build/browser/public/Attachment.js","../../node_modules/@osdk/foundry.ontologies/build/browser/public/MediaReferenceProperty.js","../../node_modules/@osdk/foundry.ontologies/build/browser/public/ObjectTypeV2.js","../../node_modules/@osdk/foundry.ontologies/build/browser/public/OntologyInterface.js","../../node_modules/@osdk/foundry.ontologies/build/browser/public/OntologyObjectSet.js","../../node_modules/@osdk/foundry.ontologies/build/browser/public/Query.js","../../node_modules/@osdk/foundry.ontologies/build/browser/public/QueryType.js","../../node_modules/@osdk/foundry.ontologies/build/browser/public/TimeSeriesPropertyV2.js","../../node_modules/@osdk/foundry.ontologies/build/browser/public/TimeSeriesValueBankProperty.js","../../node_modules/@osdk/client.unstable/node_modules/conjure-lite/dist/index.mjs","../../node_modules/@osdk/client.unstable/build/browser/index.js","../../node_modules/tiny-invariant/dist/esm/tiny-invariant.js","../../node_modules/@osdk/client/build/browser/objectSet/conjureUnionType.js","../../node_modules/@osdk/client/build/browser/ontology/makeConjureContext.js","../../node_modules/@osdk/client/build/browser/pageRequestAsAsyncIter.js","../../node_modules/@osdk/client/build/browser/object/SimpleCache.js","../../node_modules/@osdk/client/build/browser/__unstable/ConjureSupport.js","../../node_modules/@osdk/client/build/browser/__unstable/createBulkLinksAsyncIterFactory.js","../../node_modules/@osdk/shared.net.fetch/build/browser/createFetchHeaderMutator.js","../../node_modules/@osdk/shared.net.fetch/build/browser/createFetchOrThrow.js","../../node_modules/fetch-retry/dist/fetch-retry.umd.js","../../node_modules/@osdk/shared.net.fetch/build/browser/createRetryingFetch.js","../../node_modules/@osdk/client/build/browser/util/addUserAgentAndRequestContextHeaders.js","../../node_modules/@osdk/client/build/browser/util/augmentRequestContext.js","../../node_modules/@osdk/client/build/browser/object/AttachmentUpload.js","../../node_modules/@osdk/client/build/browser/object/mediaUpload.js","../../node_modules/@osdk/client/build/browser/internal/conversions/modernToLegacyWhereClause.js","../../node_modules/@osdk/client/build/browser/derivedProperties/derivedPropertyDefinitionFactory.js","../../node_modules/@osdk/client/build/browser/derivedProperties/createWithPropertiesObjectSet.js","../../node_modules/@osdk/client/build/browser/internal/conversions/legacyToModernSingleAggregationResult.js","../../node_modules/@osdk/client/build/browser/internal/conversions/modernToLegacyAggregationClause.js","../../node_modules/@osdk/client/build/browser/internal/conversions/modernToLegacyGroupByClause.js","../../node_modules/@osdk/client/build/browser/util/objectSetUtils.js","../../node_modules/@osdk/client/build/browser/object/aggregate.js","../../node_modules/@osdk/client/build/browser/util/extractRdpDefinition.js","../../node_modules/@osdk/client/build/browser/object/fetchPage.js","../../node_modules/@osdk/client/build/browser/object/fetchSingle.js","../../node_modules/@osdk/client/build/browser/util/WireObjectSet.js","../../node_modules/isomorphic-ws/browser.js","../../node_modules/@osdk/client/build/browser/objectSet/ObjectSetListenerWebsocket.js","../../node_modules/@osdk/client/build/browser/objectSet/createObjectSet.js","../../node_modules/@osdk/client/build/browser/util/interfaceUtils.js","../../node_modules/@osdk/client/build/browser/util/isObjectSpecifiersObject.js","../../node_modules/@osdk/client/build/browser/util/isOntologyObjectV2.js","../../node_modules/@osdk/client/build/browser/util/isPoint.js","../../node_modules/@osdk/client/build/browser/util/toDataValue.js","../../node_modules/@osdk/client/build/browser/actions/applyAction.js","../../node_modules/@osdk/client/build/browser/Client.js","../../node_modules/@osdk/shared.client.impl/build/browser/createSharedClientContext.js","../../node_modules/@osdk/client/build/browser/util/streamutils.js","../../node_modules/@osdk/client/build/browser/util/timeseriesUtils.js","../../node_modules/@osdk/client/build/browser/createGeotimeSeriesProperty.js","../../node_modules/@osdk/client/build/browser/createMediaReferenceProperty.js","../../node_modules/@osdk/client/build/browser/createTimeseriesProperty.js","../../node_modules/@osdk/client/build/browser/public-utils/hydrateAttachmentFromRid.js","../../node_modules/@osdk/client/build/browser/util/objectSpecifierUtils.js","../../node_modules/@osdk/client/build/browser/ontology/OntologyProvider.js","../../node_modules/@osdk/client/build/browser/object/convertWireToOsdkObjects/InternalSymbols.js","../../node_modules/@osdk/client/build/browser/object/convertWireToOsdkObjects/createOsdkInterface.js","../../node_modules/@osdk/client/build/browser/object/convertWireToOsdkObjects/getDollarAs.js","../../node_modules/@osdk/client/build/browser/object/convertWireToOsdkObjects/getDollarLink.js","../../node_modules/@osdk/client/build/browser/object/convertWireToOsdkObjects/createOsdkObject.js","../../node_modules/@osdk/client/build/browser/object/convertWireToOsdkObjects.js","../../node_modules/@osdk/client/build/browser/object/Cache.js","../../node_modules/@osdk/generator-converters/build/browser/wirePropertyV2ToSdkPropertyDefinition.js","../../node_modules/@osdk/generator-converters/build/browser/__UNSTABLE_wireInterfaceTypeV2ToSdkObjectDefinition.js","../../node_modules/@osdk/generator-converters/build/browser/getEditedEntities.js","../../node_modules/@osdk/generator-converters/build/browser/wireActionTypeV2ToSdkActionMetadata.js","../../node_modules/@osdk/generator-converters/build/browser/wirePropertyV2ToSdkPrimaryKeyTypeDefinition.js","../../node_modules/@osdk/generator-converters/build/browser/wireObjectTypeFullMetadataToSdkObjectMetadata.js","../../node_modules/@osdk/generator-converters/build/browser/isNullableQueryDataType.js","../../node_modules/@osdk/generator-converters/build/browser/wireQueryDataTypeToQueryDataTypeDefinition.js","../../node_modules/@osdk/generator-converters/build/browser/wireQueryTypeV2ToSdkQueryMetadata.js","../../node_modules/@osdk/client/build/browser/ontology/loadActionMetadata.js","../../node_modules/@osdk/client/build/browser/ontology/loadFullObjectMetadata.js","../../node_modules/@osdk/client/build/browser/ontology/loadInterfaceMetadata.js","../../node_modules/@osdk/client/build/browser/ontology/loadQueryMetadata.js","../../node_modules/@osdk/client/build/browser/ontology/StandardOntologyProvider.js","../../node_modules/@osdk/client/build/browser/util/UserAgent.js","../../node_modules/@osdk/client/build/browser/createMinimalClient.js","../../node_modules/@osdk/client/build/browser/fetchMetadata.js","../../node_modules/@osdk/client/build/browser/logger/BaseLogger.js","../../node_modules/@osdk/client/build/browser/logger/MinimalLogger.js","../../node_modules/@osdk/client/build/browser/util/toDataValueQueries.js","../../node_modules/@osdk/client/build/browser/queries/applyQuery.js","../../node_modules/@osdk/client/build/browser/createClient.js","../../node_modules/@flight-app/sdk/esm/OntologyMetadata.js","../../node_modules/@flight-app/sdk/esm/ontology/actions/buildLegsFlightPlanner20.js","../../node_modules/@flight-app/sdk/esm/ontology/actions/calculateFlightTimes.js","../../node_modules/@flight-app/sdk/esm/ontology/actions/calculateSunriseSunset.js","../../node_modules/@flight-app/sdk/esm/ontology/actions/createFlightLogObject.js","../../node_modules/@flight-app/sdk/esm/ontology/actions/createFlightWithWaypoints.js","../../node_modules/@flight-app/sdk/esm/ontology/actions/createNewFlightFp2.js","../../node_modules/@flight-app/sdk/esm/ontology/actions/editExistingFlightFp2.js","../../node_modules/@flight-app/sdk/esm/ontology/actions/flightAppUpdateEtdAndCrew.js","../../node_modules/@flight-app/sdk/esm/ontology/actions/flightFuelFpv2.js","../../node_modules/@flight-app/sdk/esm/ontology/actions/flightWeatherRiskTriggeredLightningWaves.js","../../node_modules/@flight-app/sdk/esm/ontology/actions/getGlobalWindsForFlight.js","../../node_modules/@flight-app/sdk/esm/ontology/actions/getWeatherForAlternates.js","../../node_modules/@flight-app/sdk/esm/ontology/actions/pseudoWeatherSegments.js","../../node_modules/@flight-app/sdk/esm/ontology/actions/singleFlightAutomation.js","../../node_modules/@flight-app/sdk/esm/ontology/actions/updateAlternantOneStep.js","../../node_modules/@flight-app/sdk/esm/ontology/actions/updateFastPlannerFlight.js","../../node_modules/@flight-app/sdk/esm/ontology/actions/updateWeatherByRegion.js","../../node_modules/@flight-app/sdk/esm/ontology/actions/weatherWebookNorwayV9.js","../../node_modules/@flight-app/sdk/esm/ontology/objects/AirportsData.js","../../node_modules/@flight-app/sdk/esm/ontology/objects/AllGtLocationsV2.js","../../node_modules/@flight-app/sdk/esm/ontology/objects/Asset.js","../../node_modules/@flight-app/sdk/esm/ontology/objects/BristowHelidecks.js","../../node_modules/@flight-app/sdk/esm/ontology/objects/FlightFuelDburbury.js","../../node_modules/@flight-app/sdk/esm/ontology/objects/FlightLogObject.js","../../node_modules/@flight-app/sdk/esm/ontology/objects/FuelPolicyBuilder.js","../../node_modules/@flight-app/sdk/esm/ontology/objects/InternationalWeather.js","../../node_modules/@flight-app/sdk/esm/ontology/objects/LegObjectOutputObject.js","../../node_modules/@flight-app/sdk/esm/ontology/objects/MainFlightObjectFp2.js","../../node_modules/@flight-app/sdk/esm/ontology/objects/MainFuelV2.js","../../node_modules/@flight-app/sdk/esm/ontology/objects/NorwayWeatherDatav2.js","../../node_modules/@flight-app/sdk/esm/ontology/objects/NorwayWeatherSegments.js","../../node_modules/@flight-app/sdk/esm/ontology/objects/NorwayWeatherXv8.js","../../node_modules/@flight-app/sdk/esm/ontology/objects/RegionalWeatherMinimaSettings.js","../../node_modules/@flight-app/sdk/esm/ontology/objects/User.js","../../node_modules/oauth4webapi/build/index.js","../../node_modules/typescript-event-target/dist/index.mjs","../../node_modules/@osdk/oauth/build/browser/throwIfError.js","../../node_modules/@osdk/oauth/build/browser/common.js","../../node_modules/delay/index.js","../../node_modules/@osdk/oauth/build/browser/utils.js","../../node_modules/@osdk/oauth/build/browser/createPublicOauthClient.js","../../node_modules/@osdk/foundry.admin/build/browser/public/User.js"],"sourcesContent":["/*\n * Copyright 2023 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// the value side of this needs to match DistanceUnit from @osdk/foundry but we don't\n// want the dependency\nexport const DistanceUnitMapping = {\n  \"centimeter\": \"CENTIMETERS\",\n  \"centimeters\": \"CENTIMETERS\",\n  \"cm\": \"CENTIMETERS\",\n  \"meter\": \"METERS\",\n  \"meters\": \"METERS\",\n  \"m\": \"METERS\",\n  \"kilometer\": \"KILOMETERS\",\n  \"kilometers\": \"KILOMETERS\",\n  \"km\": \"KILOMETERS\",\n  \"inch\": \"INCHES\",\n  \"inches\": \"INCHES\",\n  \"foot\": \"FEET\",\n  \"feet\": \"FEET\",\n  \"yard\": \"YARDS\",\n  \"yards\": \"YARDS\",\n  \"mile\": \"MILES\",\n  \"miles\": \"MILES\",\n  \"nautical_mile\": \"NAUTICAL_MILES\",\n  \"nauticalMile\": \"NAUTICAL_MILES\",\n  \"nautical miles\": \"NAUTICAL_MILES\"\n};\n\n// FIXME we need to represent all types\n//# sourceMappingURL=WhereClause.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const TimeDurationMapping = {\n  \"sec\": \"SECONDS\",\n  \"seconds\": \"SECONDS\",\n  \"min\": \"MINUTES\",\n  \"minute\": \"MINUTES\",\n  \"minutes\": \"MINUTES\",\n  \"hr\": \"HOURS\",\n  \"hrs\": \"HOURS\",\n  \"hour\": \"HOURS\",\n  \"hours\": \"HOURS\",\n  \"day\": \"DAYS\",\n  \"days\": \"DAYS\",\n  \"wk\": \"WEEKS\",\n  \"week\": \"WEEKS\",\n  \"weeks\": \"WEEKS\",\n  \"mos\": \"MONTHS\",\n  \"month\": \"MONTHS\",\n  \"months\": \"MONTHS\",\n  \"yr\": \"YEARS\",\n  \"year\": \"YEARS\",\n  \"years\": \"YEARS\"\n};\n//# sourceMappingURL=DurationMapping.js.map","/*\n * Copyright 2023 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { TimeDurationMapping } from \"../mapping/DurationMapping.js\";\nexport const DurationMapping = {\n  ...TimeDurationMapping,\n  \"quarter\": \"QUARTERS\",\n  \"quarters\": \"QUARTERS\"\n};\n//# sourceMappingURL=GroupByClause.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { TimeDurationMapping } from \"../mapping/DurationMapping.js\";\nexport const TimeseriesDurationMapping = {\n  \"ms\": \"MILLISECONDS\",\n  \"milliseconds\": \"MILLISECONDS\",\n  ...TimeDurationMapping\n};\n//# sourceMappingURL=timeseries.js.map","/*\n * Copyright 2023 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport class PalantirApiError extends Error {\n  constructor(message, errorName, errorCode, statusCode, errorInstanceId, parameters) {\n    super(message);\n    this.message = message;\n    this.errorName = errorName;\n    this.errorCode = errorCode;\n    this.statusCode = statusCode;\n    this.errorInstanceId = errorInstanceId;\n    this.parameters = parameters;\n  }\n}\n//# sourceMappingURL=PalantirApiError.js.map","/*\n * Copyright 2023 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { PalantirApiError } from \"./PalantirApiError.js\";\nexport class UnknownError extends PalantirApiError {\n  constructor(message, errorName, originalError, statusCode) {\n    super(message, errorName, undefined, statusCode);\n    this.originalError = originalError;\n  }\n}\n//# sourceMappingURL=UnknownError.js.map","/*\n * Copyright 2023 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport class ActionValidationError extends Error {\n  constructor(validation) {\n    super(\"Validation Error: \" + JSON.stringify(validation, null, 2));\n    this.validation = validation;\n  }\n}\n//# sourceMappingURL=ActionValidationError.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @experimental This feature is experimental and might change in the future.\n *\n * Uploads a media item to the media property of the specified object type.\n *\n * @param data - Data to upload as media item\n * @param fileName - Name that will be assigned as path to the uploaded media item.\n * @param objectType - Object type to which the media item will be uploaded.\n * @param propertyType - Media reference property of the corresponding object type to which the media item will be uploaded.\n *\n * @returns media reference of the uploaded media item.\n */\n\nexport const __EXPERIMENTAL__NOT_SUPPORTED_YET__createMediaReference = {\n  name: \"__EXPERIMENTAL__NOT_SUPPORTED_YET__createMediaReference\",\n  type: \"experiment\",\n  version: \"2.1.0\"\n};\n//# sourceMappingURL=createMediaReference.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const __EXPERIMENTAL__NOT_SUPPORTED_YET__fetchOneByRid = {\n  name: \"__EXPERIMENTAL__NOT_SUPPORTED_YET__fetchOneByRid\",\n  type: \"experiment\",\n  version: \"2.1.0\"\n};\n//# sourceMappingURL=fetchOneByRid.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const __EXPERIMENTAL__NOT_SUPPORTED_YET__fetchPageByRid = {\n  name: \"__EXPERIMENTAL__NOT_SUPPORTED_YET__fetchPageByRid\",\n  type: \"experiment\",\n  version: \"2.2.0\"\n};\n//# sourceMappingURL=fetchPageByRid.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const __EXPERIMENTAL__NOT_SUPPORTED_YET__getBulkLinks = {\n  name: \"__EXPERIMENTAL__NOT_SUPPORTED_YET__getBulkLinks\",\n  type: \"experiment\",\n  version: \"2.0.8\"\n};\n//# sourceMappingURL=getBulkLinks.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const symbolClientContext = Symbol(\"ClientContext\");\n","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const symbolClientContext = \"__osdkClientContext\"\n","/*\n * Copyright 2023 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport class PalantirApiError extends Error {\n  constructor(message, errorName, errorCode, statusCode, errorInstanceId, parameters) {\n    super(message);\n    this.message = message;\n    this.errorName = errorName;\n    this.errorCode = errorCode;\n    this.statusCode = statusCode;\n    this.errorInstanceId = errorInstanceId;\n    this.parameters = parameters;\n  }\n}\n//# sourceMappingURL=PalantirApiError.js.map","/*\n * Copyright 2023 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { PalantirApiError } from \"./PalantirApiError.js\";\nexport class UnknownError extends PalantirApiError {\n  constructor(message, errorType, originalError) {\n    super(message, errorType);\n    this.originalError = originalError;\n  }\n}\n//# sourceMappingURL=UnknownError.js.map","/*\n * Copyright 2023 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { symbolClientContext as oldSymbolClientContext } from \"@osdk/shared.client\";\nimport { symbolClientContext } from \"@osdk/shared.client2\";\nimport { PalantirApiError, UnknownError } from \"@osdk/shared.net.errors\";\nexport async function foundryPlatformFetch(client, [httpMethodNum, origPath, flags, contentType, responseContentType], ...args) {\n  const path = origPath.replace(/\\{([^}]+)\\}/g, () => encodeURIComponent(args.shift()));\n  const body = flags & 1 ? args.shift() : undefined;\n  const queryArgs = flags & 2 ? args.shift() : undefined;\n  const headerArgs = flags & 4 ? args.shift() : undefined;\n  const method = [\"GET\", \"POST\", \"PUT\", \"DELETE\", \"PATCH\"][httpMethodNum];\n  return await apiFetch(client[symbolClientContext] ?? client[oldSymbolClientContext] ?? client, method, path, body, queryArgs, headerArgs, contentType, responseContentType);\n}\nasync function apiFetch(clientCtx, method, endpointPath, data, queryArguments, headers, requestMediaType, responseMediaType) {\n  const url = parseUrl(clientCtx.baseUrl, endpointPath);\n  for (const [key, value] of Object.entries(queryArguments || {})) {\n    if (value == null) {\n      continue;\n    }\n    if (Array.isArray(value)) {\n      for (const item of value) {\n        url.searchParams.append(key, item);\n      }\n    } else {\n      url.searchParams.append(key, value);\n    }\n  }\n  const headersInit = new Headers();\n  headersInit.set(\"Content-Type\", requestMediaType ?? \"application/json\");\n  headersInit.set(\"Accept\", responseMediaType ?? \"application/json\");\n  Object.entries(headers || {}).forEach(([key, value]) => {\n    if (value != null) {\n      headersInit.append(key, value.toString());\n    }\n  });\n  const body = data == null || data instanceof globalThis.Blob ? data : JSON.stringify(data);\n  // Because this uses the client's fetch, there is a 99.99% chance that it is already going\n  // to handle the error case and throw a PalantirApiError since its wrapped in a\n  // createFetchOrThrow.\n  const response = await clientCtx.fetch(url.toString(), {\n    body,\n    method: method,\n    headers: headersInit\n  });\n  // However, if we ended up using a \"regular\" fetch, the\n  // error status codes are not thrown by fetch automatically,\n  // we have to look at the ok property and behave accordingly\n  if (!response.ok) {\n    try {\n      const convertedError = await response.json();\n      return new PalantirApiError(convertedError.message, convertedError.errorName, convertedError.errorCode, response.status, convertedError.errorInstanceId, convertedError.parameters);\n    } catch (e) {\n      if (e instanceof Error) {\n        return new UnknownError(e.message, \"UNKNOWN\");\n      }\n      return new UnknownError(\"Unable to parse error response\", \"UNKNOWN\");\n    }\n  }\n  // Do not return anything if its a 204. Do not parse either!\n  if (response.status === 204) {\n    return;\n  }\n  if (responseMediaType == null || responseMediaType === \"application/json\") {\n    return await response.json();\n  }\n  return response;\n}\nexport function parseUrl(baseUrl, endpointPath) {\n  baseUrl += baseUrl.endsWith(\"/\") ? \"\" : \"/\";\n  return new URL(`api${endpointPath}`, baseUrl);\n}\n//# sourceMappingURL=foundryPlatformFetch.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { foundryPlatformFetch as $foundryPlatformFetch } from \"@osdk/shared.net.platformapi\";\n//\nconst _apply = [1, \"/v2/ontologies/{0}/actions/{1}/apply\", 3];\n/**\n * Applies an action using the given parameters.\n *\n * Changes to objects or links stored in Object Storage V1 are eventually consistent and may take some time to be visible.\n * Edits to objects or links in Object Storage V2 will be visible immediately after the action completes.\n *\n * Note that [parameter default values](https://www.palantir.com/docs/foundry/action-types/parameters-default-value/) are not currently supported by\n * this endpoint.\n *\n * Third-party applications using this endpoint via OAuth2 must request the\n * following operation scopes: `api:ontologies-read api:ontologies-write`.\n *\n * @public\n *\n * Required Scopes: [api:ontologies-read, api:ontologies-write]\n * URL: /v2/ontologies/{ontology}/actions/{action}/apply\n */\nexport function apply($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _apply, ...args);\n}\nconst _applyAsync = [1, \"/v2/ontologies/{0}/actions/{1}/applyAsync\", 3];\n/**\n * Applies an action using the given parameters.\n *\n * Changes to objects or links stored in Object Storage V1 are eventually consistent and may take some time to be visible.\n * Edits to objects or links in Object Storage V2 will be visible immediately after the action completes.\n *\n * Note that [parameter default values](https://www.palantir.com/docs/foundry/action-types/parameters-default-value/) are not currently supported by\n * this endpoint.\n *\n * Third-party applications using this endpoint via OAuth2 must request the\n * following operation scopes: `api:ontologies-read api:ontologies-write`.\n *\n * @alpha\n *\n * Required Scopes: [api:ontologies-read, api:ontologies-write]\n * URL: /v2/ontologies/{ontology}/actions/{action}/applyAsync\n */\nexport function applyAsync($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _applyAsync, ...args);\n}\nconst _applyBatch = [1, \"/v2/ontologies/{0}/actions/{1}/applyBatch\", 3];\n/**\n * Applies multiple actions (of the same Action Type) using the given parameters.\n *\n * Changes to objects or links stored in Object Storage V1 are eventually consistent and may take some time to be visible.\n * Edits to objects or links in Object Storage V2 will be visible immediately after the action completes.\n *\n * Up to 20 actions may be applied in one call. Actions that only modify objects in Object Storage v2 and do not\n * call Functions may receive a higher limit.\n *\n * Note that [notifications](https://www.palantir.com/docs/foundry/action-types/notifications/) are not currently supported by this endpoint.\n *\n * Third-party applications using this endpoint via OAuth2 must request the\n * following operation scopes: `api:ontologies-read api:ontologies-write`.\n *\n * @public\n *\n * Required Scopes: [api:ontologies-read, api:ontologies-write]\n * URL: /v2/ontologies/{ontology}/actions/{action}/applyBatch\n */\nexport function applyBatch($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _applyBatch, ...args);\n}\n//# sourceMappingURL=Action.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { foundryPlatformFetch as $foundryPlatformFetch } from \"@osdk/shared.net.platformapi\";\n//\nconst _list = [0, \"/v2/ontologies/{0}/actionTypes\", 2];\n/**\n * Lists the action types for the given Ontology.\n *\n * Each page may be smaller than the requested page size. However, it is guaranteed that if there are more\n * results available, at least one result will be present in the response.\n *\n * Third-party applications using this endpoint via OAuth2 must request the following operation scope: `api:ontologies-read`.\n *\n * @public\n *\n * Required Scopes: [api:ontologies-read]\n * URL: /v2/ontologies/{ontology}/actionTypes\n */\nexport function list($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _list, ...args);\n}\nconst _get = [0, \"/v2/ontologies/{0}/actionTypes/{1}\"];\n/**\n * Gets a specific action type with the given API name.\n *\n * Third-party applications using this endpoint via OAuth2 must request the following operation scope: `api:ontologies-read`.\n *\n * @public\n *\n * Required Scopes: [api:ontologies-read]\n * URL: /v2/ontologies/{ontology}/actionTypes/{actionType}\n */\nexport function get($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _get, ...args);\n}\nconst _getByRid = [0, \"/v2/ontologies/{0}/actionTypes/byRid/{1}\"];\n/**\n * Gets a specific action type with the given RID.\n *\n * Third-party applications using this endpoint via OAuth2 must request the following operation scope: `api:ontologies-read`.\n *\n * @public\n *\n * Required Scopes: [api:ontologies-read]\n * URL: /v2/ontologies/{ontology}/actionTypes/byRid/{actionTypeRid}\n */\nexport function getByRid($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _getByRid, ...args);\n}\n//# sourceMappingURL=ActionTypeV2.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { foundryPlatformFetch as $foundryPlatformFetch } from \"@osdk/shared.net.platformapi\";\n//\nconst _upload = [1, \"/v2/ontologies/attachments/upload\", 7, \"*/*\"];\n/**\n * Upload an attachment to use in an action. Any attachment which has not been linked to an object via\n * an action within one hour after upload will be removed.\n * Previously mapped attachments which are not connected to any object anymore are also removed on\n * a biweekly basis.\n * The body of the request must contain the binary content of the file and the `Content-Type` header must be `application/octet-stream`.\n *\n * Third-party applications using this endpoint via OAuth2 must request the\n * following operation scopes: `api:ontologies-write`.\n *\n * @public\n *\n * Required Scopes: [api:ontologies-write]\n * URL: /v2/ontologies/attachments/upload\n */\nexport function upload($ctx, ...args) {\n  const headerParams = {\n    ...args[2],\n    \"Content-Type\": args[2]?.[\"Content-Type\"] ?? args[0].type,\n    \"Content-Length\": args[0].size.toString()\n  };\n  return $foundryPlatformFetch($ctx, _upload, args[0], args[1], headerParams);\n}\nconst _read = [0, \"/v2/ontologies/attachments/{0}/content\",,, \"*/*\"];\n/**\n * Get the content of an attachment.\n *\n * Third-party applications using this endpoint via OAuth2 must request the\n * following operation scopes: `api:ontologies-read`.\n *\n * @public\n *\n * Required Scopes: [api:ontologies-read]\n * URL: /v2/ontologies/attachments/{attachmentRid}/content\n */\nexport function read($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _read, ...args);\n}\nconst _get = [0, \"/v2/ontologies/attachments/{0}\"];\n/**\n * Get the metadata of an attachment.\n *\n * Third-party applications using this endpoint via OAuth2 must request the\n * following operation scopes: `api:ontologies-read`.\n *\n * @public\n *\n * Required Scopes: [api:ontologies-read]\n * URL: /v2/ontologies/attachments/{attachmentRid}\n */\nexport function get($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _get, ...args);\n}\n//# sourceMappingURL=Attachment.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { foundryPlatformFetch as $foundryPlatformFetch } from \"@osdk/shared.net.platformapi\";\n//\nconst _getMediaContent = [0, \"/v2/ontologies/{0}/objects/{1}/{2}/media/{3}/content\", 2,, \"*/*\"];\n/**\n * Gets the content of a media item referenced by this property.\n *\n * Third-party applications using this endpoint via OAuth2 must request the following operation scopes: `api:ontologies-read`.\n *\n * @beta\n *\n * Required Scopes: [api:ontologies-read]\n * URL: /v2/ontologies/{ontology}/objects/{objectType}/{primaryKey}/media/{property}/content\n */\nexport function getMediaContent($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _getMediaContent, ...args);\n}\nconst _getMediaMetadata = [0, \"/v2/ontologies/{0}/objects/{1}/{2}/media/{3}/metadata\", 2];\n/**\n * Gets metadata about the media item referenced by this property.\n *\n * Third-party applications using this endpoint via OAuth2 must request the following operation scopes: `api:ontologies-read`.\n *\n * @alpha\n *\n * Required Scopes: [api:ontologies-read]\n * URL: /v2/ontologies/{ontology}/objects/{objectType}/{primaryKey}/media/{property}/metadata\n */\nexport function getMediaMetadata($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _getMediaMetadata, ...args);\n}\nconst _upload = [1, \"/v2/ontologies/{0}/objectTypes/{1}/media/{2}/upload\", 3, \"*/*\"];\n/**\n * Uploads a media item to the media set which backs the specified property.  The property must be backed by a single media set and branch, otherwise an error will be thrown.\n * The body of the request must contain the binary content of the file and the `Content-Type` header must be `application/octet-stream`.\n *\n * Third-party applications using this endpoint via OAuth2 must request the following operation scopes: `api:ontologies-read api:ontologies-write`.\n *\n * @beta\n *\n * Required Scopes: [api:ontologies-read, api:ontologies-write]\n * URL: /v2/ontologies/{ontology}/objectTypes/{objectType}/media/{property}/upload\n */\nexport function upload($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _upload, ...args);\n}\n//# sourceMappingURL=MediaReferenceProperty.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { foundryPlatformFetch as $foundryPlatformFetch } from \"@osdk/shared.net.platformapi\";\n//\nconst _list = [0, \"/v2/ontologies/{0}/objectTypes\", 2];\n/**\n * Lists the object types for the given Ontology.\n *\n * Each page may be smaller or larger than the requested page size. However, it is guaranteed that if there are\n * more results available, at least one result will be present in the\n * response.\n *\n * Third-party applications using this endpoint via OAuth2 must request the following operation scope: `api:ontologies-read`.\n *\n * @public\n *\n * Required Scopes: [api:ontologies-read]\n * URL: /v2/ontologies/{ontology}/objectTypes\n */\nexport function list($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _list, ...args);\n}\nconst _get = [0, \"/v2/ontologies/{0}/objectTypes/{1}\"];\n/**\n * Gets a specific object type with the given API name.\n *\n * Third-party applications using this endpoint via OAuth2 must request the following operation scope: `api:ontologies-read`.\n *\n * @public\n *\n * Required Scopes: [api:ontologies-read]\n * URL: /v2/ontologies/{ontology}/objectTypes/{objectType}\n */\nexport function get($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _get, ...args);\n}\nconst _getFullMetadata = [0, \"/v2/ontologies/{0}/objectTypes/{1}/fullMetadata\", 2];\n/**\n * Gets the full metadata for a specific object type with the given API name.\n *\n * Third-party applications using this endpoint via OAuth2 must request the following operation scope: `api:ontologies-read`.\n *\n * @alpha\n *\n * Required Scopes: [api:ontologies-read]\n * URL: /v2/ontologies/{ontology}/objectTypes/{objectType}/fullMetadata\n */\nexport function getFullMetadata($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _getFullMetadata, ...args);\n}\nconst _listOutgoingLinkTypes = [0, \"/v2/ontologies/{0}/objectTypes/{1}/outgoingLinkTypes\", 2];\n/**\n * List the outgoing links for an object type.\n *\n * Third-party applications using this endpoint via OAuth2 must request the\n * following operation scopes: `api:ontologies-read`.\n *\n * @public\n *\n * Required Scopes: [api:ontologies-read]\n * URL: /v2/ontologies/{ontology}/objectTypes/{objectType}/outgoingLinkTypes\n */\nexport function listOutgoingLinkTypes($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _listOutgoingLinkTypes, ...args);\n}\nconst _getOutgoingLinkType = [0, \"/v2/ontologies/{0}/objectTypes/{1}/outgoingLinkTypes/{2}\"];\n/**\n * Get an outgoing link for an object type.\n *\n * Third-party applications using this endpoint via OAuth2 must request the\n * following operation scopes: `api:ontologies-read`.\n *\n * @public\n *\n * Required Scopes: [api:ontologies-read]\n * URL: /v2/ontologies/{ontology}/objectTypes/{objectType}/outgoingLinkTypes/{linkType}\n */\nexport function getOutgoingLinkType($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _getOutgoingLinkType, ...args);\n}\n//# sourceMappingURL=ObjectTypeV2.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { foundryPlatformFetch as $foundryPlatformFetch } from \"@osdk/shared.net.platformapi\";\n//\nconst _list = [0, \"/v2/ontologies/{0}/interfaceTypes\", 2];\n/**\n * :::callout{theme=warning title=Warning}\n * This endpoint is in preview and may be modified or removed at any time.\n * To use this endpoint, add `preview=true` to the request query parameters.\n * :::\n *\n * Lists the interface types for the given Ontology.\n *\n * Each page may be smaller than the requested page size. However, it is guaranteed that if there are more\n * results available, at least one result will be present in the response.\n *\n * Third-party applications using this endpoint via OAuth2 must request the following operation scope: `api:ontologies-read`.\n *\n * @beta\n *\n * Required Scopes: [api:ontologies-read]\n * URL: /v2/ontologies/{ontology}/interfaceTypes\n */\nexport function list($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _list, ...args);\n}\nconst _get = [0, \"/v2/ontologies/{0}/interfaceTypes/{1}\", 2];\n/**\n * :::callout{theme=warning title=Warning}\n * This endpoint is in preview and may be modified or removed at any time.\n * To use this endpoint, add `preview=true` to the request query parameters.\n * :::\n *\n * Gets a specific interface type with the given API name.\n *\n * Third-party applications using this endpoint via OAuth2 must request the following operation scope: `api:ontologies-read`.\n *\n * @beta\n *\n * Required Scopes: [api:ontologies-read]\n * URL: /v2/ontologies/{ontology}/interfaceTypes/{interfaceType}\n */\nexport function get($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _get, ...args);\n}\nconst _search = [1, \"/v2/ontologies/{0}/interfaces/{1}/search\", 3];\n/**\n * :::callout{theme=warning title=Warning}\n * This endpoint will be removed once TS OSDK is updated to use `objectSets/loadObjects` with interface object\n * sets.\n * :::\n * :::callout{theme=warning title=Warning}\n * This endpoint is in preview and may be modified or removed at any time.\n * To use this endpoint, add `preview=true` to the request query parameters.\n * :::\n *\n * Search for objects in the specified ontology and interface type. Any properties specified in the \"where\" or\n * \"orderBy\" parameters must be shared property type API names defined on the interface. The following search\n * queries are supported:\n *\n * | Query type                              | Description                                                                                                       | Supported Types                 |\n * |-----------------------------------------|-------------------------------------------------------------------------------------------------------------------|---------------------------------|\n * | lt                                      | The provided property is less than the provided value.                                                            | number, string, date, timestamp |\n * | gt                                      | The provided property is greater than the provided value.                                                         | number, string, date, timestamp |\n * | lte                                     | The provided property is less than or equal to the provided value.                                                | number, string, date, timestamp |\n * | gte                                     | The provided property is greater than or equal to the provided value.                                             | number, string, date, timestamp |\n * | eq                                      | The provided property is exactly equal to the provided value.                                                     | number, string, date, timestamp |\n * | isNull                                  | The provided property is (or is not) null.                                                                        | all                             |\n * | contains                                | The provided property contains the provided value.                                                                | array                           |\n * | not                                     | The sub-query does not match.                                                                                     | N/A (applied on a query)        |\n * | and                                     | All the sub-queries match.                                                                                        | N/A (applied on queries)        |\n * | or                                      | At least one of the sub-queries match.                                                                            | N/A (applied on queries)        |\n * | startsWith                              | The provided property starts with the provided term.                                                              | string                          |\n * | containsAllTermsInOrderPrefixLastTerm   | The provided property contains all the terms provided in order. The last term can be a partial prefix match.      | string                          |\n * | containsAllTermsInOrder                 | The provided property contains the provided terms as a substring.                                                 | string                          |\n * | containsAnyTerm                         | The provided property contains at least one of the terms separated by whitespace.                                 | string                          |\n * | containsAllTerms                        | The provided property contains all the terms separated by whitespace.                                             | string                          |\n *\n * Queries can be at most three levels deep. By default, terms are separated by whitespace or punctuation (`?!,:;-[](){}'\"~`). Periods (`.`) on their own are ignored.\n * Partial terms are not matched by terms filters except where explicitly noted.\n *\n * Attempting to use an unsupported query will result in a validation error. Third-party applications using this\n * endpoint via OAuth2 must request the following operation scope: `api:ontologies-read`.\n *\n * @alpha\n *\n * Required Scopes: [api:ontologies-read]\n * URL: /v2/ontologies/{ontology}/interfaces/{interfaceType}/search\n */\nexport function search($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _search, ...args);\n}\nconst _aggregate = [1, \"/v2/ontologies/{0}/interfaces/{1}/aggregate\", 3];\n/**\n * :::callout{theme=warning title=Warning}\n * This endpoint will be removed once TS OSDK is updated to use `objectSets/aggregate` with interface object\n * sets.\n * :::\n * :::callout{theme=warning title=Warning}\n * This endpoint is in preview and may be modified or removed at any time.\n * To use this endpoint, add `preview=true` to the request query parameters.\n * :::\n *\n * Perform functions on object fields in the specified ontology and of the specified interface type. Any\n * properties specified in the query must be shared property type API names defined on the interface.\n *\n * Third-party applications using this endpoint via OAuth2 must request the following operation scope: `api:ontologies-read`.\n *\n * @alpha\n *\n * Required Scopes: [api:ontologies-read]\n * URL: /v2/ontologies/{ontology}/interfaces/{interfaceType}/aggregate\n */\nexport function aggregate($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _aggregate, ...args);\n}\n//# sourceMappingURL=OntologyInterface.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { foundryPlatformFetch as $foundryPlatformFetch } from \"@osdk/shared.net.platformapi\";\n//\nconst _createTemporary = [1, \"/v2/ontologies/{0}/objectSets/createTemporary\", 1];\n/**\n * Creates a temporary `ObjectSet` from the given definition. This `ObjectSet` expires after one hour.\n *\n * Third-party applications using this endpoint via OAuth2 must request the\n * following operation scopes: `api:ontologies-read api:ontologies-write`.\n *\n * @beta\n *\n * Required Scopes: [api:ontologies-read, api:ontologies-write]\n * URL: /v2/ontologies/{ontology}/objectSets/createTemporary\n */\nexport function createTemporary($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _createTemporary, ...args);\n}\nconst _get = [0, \"/v2/ontologies/{0}/objectSets/{1}\"];\n/**\n * Gets the definition of the `ObjectSet` with the given RID.\n *\n * Third-party applications using this endpoint via OAuth2 must request the following operation scope: `api:ontologies-read`.\n *\n * @alpha\n *\n * Required Scopes: []\n * URL: /v2/ontologies/{ontology}/objectSets/{objectSetRid}\n */\nexport function get($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _get, ...args);\n}\nconst _load = [1, \"/v2/ontologies/{0}/objectSets/loadObjects\", 3];\n/**\n * Load the ontology objects present in the `ObjectSet` from the provided object set definition.\n *\n * For Object Storage V1 backed objects, this endpoint returns a maximum of 10,000 objects. After 10,000 objects have been returned and if more objects\n * are available, attempting to load another page will result in an `ObjectsExceededLimit` error being returned. There is no limit on Object Storage V2 backed objects.\n *\n * Note that null value properties will not be returned.\n *\n * Vector properties will not be returned unless included in the `select` parameter.\n *\n * Third-party applications using this endpoint via OAuth2 must request the following operation scope: `api:ontologies-read`.\n *\n * @public\n *\n * Required Scopes: [api:ontologies-read]\n * URL: /v2/ontologies/{ontology}/objectSets/loadObjects\n */\nexport function load($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _load, ...args);\n}\nconst _loadMultipleObjectTypes = [1, \"/v2/ontologies/{0}/objectSets/loadObjectsMultipleObjectTypes\", 3];\n/**\n * Load the ontology objects present in the `ObjectSet` from the provided object set definition. The resulting\n * objects may be scoped to an object type, in which all the selected properties on the object type are returned, or scoped\n * to an interface, in which only the object type properties that implement the properties of any interfaces in its\n * scope are returned. For objects that are scoped to an interface in the result, a mapping from interface to\n * object implementation is returned in order to interpret the objects as the interfaces that they implement.\n *\n * For Object Storage V1 backed objects, this endpoint returns a maximum of 10,000 objects. After 10,000 objects have been returned and if more objects\n * are available, attempting to load another page will result in an `ObjectsExceededLimit` error being returned. There is no limit on Object Storage V2 backed objects.\n *\n * Note that null value properties will not be returned. In addition, property metadata (rid, apiName, and primaryKey)\n * will be prefixed with '$' instead of '\\_\\_' as is the case in `loadObjects`.\n *\n * Vector properties will not be returned unless included in the `select` parameter.\n *\n * Third-party applications using this endpoint via OAuth2 must request the following operation scope: `api:ontologies-read`.\n *\n * @beta\n *\n * Required Scopes: [api:ontologies-read]\n * URL: /v2/ontologies/{ontology}/objectSets/loadObjectsMultipleObjectTypes\n */\nexport function loadMultipleObjectTypes($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _loadMultipleObjectTypes, ...args);\n}\nconst _loadObjectsOrInterfaces = [1, \"/v2/ontologies/{0}/objectSets/loadObjectsOrInterfaces\", 3];\n/**\n * Load the ontology objects present in the `ObjectSet` from the provided object set definition. If the requested\n * object set contains interfaces and the object can be viewed as an interface, it will contain the properties\n * defined by the interface. If not, it will contain the properties defined by its object type. This allows directly\n * loading all objects of an interface where all objects are viewed as the interface, for example.\n *\n * Note that the result object set cannot contain a mix of objects with \"interface\" properties and \"object type\"\n * properties. Attempting to load an object set like this will result in an error.\n *\n * For Object Storage V1 backed objects, this endpoint returns a maximum of 10,000 objects. After 10,000 objects have been returned and if more objects\n * are available, attempting to load another page will result in an `ObjectsExceededLimit` error being returned. There is no limit on Object Storage V2 backed objects.\n *\n * Note that null value properties will not be returned. In addition, property metadata (rid, apiName, and primaryKey)\n * will be prefixed with '$' instead of '\\_\\_' as is the case in `/loadObjects`.\n *\n * Vector properties will not be returned unless included in the `select` parameter.\n *\n * Third-party applications using this endpoint via OAuth2 must request the following operation scope: `api:ontologies-read`.\n *\n * @beta\n *\n * Required Scopes: [api:ontologies-read]\n * URL: /v2/ontologies/{ontology}/objectSets/loadObjectsOrInterfaces\n */\nexport function loadObjectsOrInterfaces($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _loadObjectsOrInterfaces, ...args);\n}\nconst _aggregate = [1, \"/v2/ontologies/{0}/objectSets/aggregate\", 3];\n/**\n * Aggregates the ontology objects present in the `ObjectSet` from the provided object set definition.\n *\n * Third-party applications using this endpoint via OAuth2 must request the following operation scope: `api:ontologies-read`.\n *\n * @public\n *\n * Required Scopes: [api:ontologies-read]\n * URL: /v2/ontologies/{ontology}/objectSets/aggregate\n */\nexport function aggregate($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _aggregate, ...args);\n}\n//# sourceMappingURL=OntologyObjectSet.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { foundryPlatformFetch as $foundryPlatformFetch } from \"@osdk/shared.net.platformapi\";\n//\nconst _execute = [1, \"/v2/ontologies/{0}/queries/{1}/execute\", 3];\n/**\n * Executes a Query using the given parameters.\n *\n * Optional parameters do not need to be supplied.\n *\n * Third-party applications using this endpoint via OAuth2 must request the\n * following operation scopes: `api:ontologies-read`.\n *\n * @public\n *\n * Required Scopes: [api:ontologies-read]\n * URL: /v2/ontologies/{ontology}/queries/{queryApiName}/execute\n */\nexport function execute($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _execute, ...args);\n}\n//# sourceMappingURL=Query.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { foundryPlatformFetch as $foundryPlatformFetch } from \"@osdk/shared.net.platformapi\";\n//\nconst _list = [0, \"/v2/ontologies/{0}/queryTypes\", 2];\n/**\n * Lists the query types for the given Ontology.\n *\n * Each page may be smaller than the requested page size. However, it is guaranteed that if there are more\n * results available, at least one result will be present in the response.\n *\n * Third-party applications using this endpoint via OAuth2 must request the following operation scope: `api:ontologies-read`.\n *\n * @public\n *\n * Required Scopes: [api:ontologies-read]\n * URL: /v2/ontologies/{ontology}/queryTypes\n */\nexport function list($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _list, ...args);\n}\nconst _get = [0, \"/v2/ontologies/{0}/queryTypes/{1}\", 2];\n/**\n * Gets a specific query type with the given API name.\n *\n * Third-party applications using this endpoint via OAuth2 must request the following operation scope: `api:ontologies-read`.\n *\n * @public\n *\n * Required Scopes: [api:ontologies-read]\n * URL: /v2/ontologies/{ontology}/queryTypes/{queryApiName}\n */\nexport function get($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _get, ...args);\n}\n//# sourceMappingURL=QueryType.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { foundryPlatformFetch as $foundryPlatformFetch } from \"@osdk/shared.net.platformapi\";\n//\nconst _getFirstPoint = [0, \"/v2/ontologies/{0}/objects/{1}/{2}/timeseries/{3}/firstPoint\", 2];\n/**\n * Get the first point of a time series property.\n *\n * Third-party applications using this endpoint via OAuth2 must request the\n * following operation scopes: `api:ontologies-read`.\n *\n * @public\n *\n * Required Scopes: [api:ontologies-read]\n * URL: /v2/ontologies/{ontology}/objects/{objectType}/{primaryKey}/timeseries/{property}/firstPoint\n */\nexport function getFirstPoint($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _getFirstPoint, ...args);\n}\nconst _getLastPoint = [0, \"/v2/ontologies/{0}/objects/{1}/{2}/timeseries/{3}/lastPoint\", 2];\n/**\n * Get the last point of a time series property.\n *\n * Third-party applications using this endpoint via OAuth2 must request the\n * following operation scopes: `api:ontologies-read`.\n *\n * @public\n *\n * Required Scopes: [api:ontologies-read]\n * URL: /v2/ontologies/{ontology}/objects/{objectType}/{primaryKey}/timeseries/{property}/lastPoint\n */\nexport function getLastPoint($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _getLastPoint, ...args);\n}\nconst _streamPoints = [1, \"/v2/ontologies/{0}/objects/{1}/{2}/timeseries/{3}/streamPoints\", 3,, \"*/*\"];\n/**\n * Stream all of the points of a time series property.\n *\n * Third-party applications using this endpoint via OAuth2 must request the\n * following operation scopes: `api:ontologies-read`.\n *\n * @public\n *\n * Required Scopes: [api:ontologies-read]\n * URL: /v2/ontologies/{ontology}/objects/{objectType}/{primaryKey}/timeseries/{property}/streamPoints\n */\nexport function streamPoints($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _streamPoints, ...args);\n}\n//# sourceMappingURL=TimeSeriesPropertyV2.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { foundryPlatformFetch as $foundryPlatformFetch } from \"@osdk/shared.net.platformapi\";\n//\nconst _getLatestValue = [0, \"/v2/ontologies/{0}/objects/{1}/{2}/timeseries/{3}/latestValue\", 2];\n/**\n * Get the latest value of a property backed by a timeseries. If a specific geotime series integration has both a history and a live integration, we will give precedence to the live integration.\n *\n * Third-party applications using this endpoint via OAuth2 must request the\n * following operation scopes: `api:ontologies-read`.\n *\n * @beta\n *\n * Required Scopes: [api:ontologies-read]\n * URL: /v2/ontologies/{ontology}/objects/{objectType}/{primaryKey}/timeseries/{propertyName}/latestValue\n */\nexport function getLatestValue($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _getLatestValue, ...args);\n}\nconst _streamValues = [1, \"/v2/ontologies/{0}/objects/{1}/{2}/timeseries/{3}/streamValues\", 3,, \"*/*\"];\n/**\n * Stream all of the points of a time series property (this includes geotime series references).\n *\n * Third-party applications using this endpoint via OAuth2 must request the\n * following operation scopes: `api:ontologies-read`.\n *\n * @beta\n *\n * Required Scopes: [api:ontologies-read]\n * URL: /v2/ontologies/{ontology}/objects/{objectType}/{primaryKey}/timeseries/{property}/streamValues\n */\nexport function streamValues($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _streamValues, ...args);\n}\n//# sourceMappingURL=TimeSeriesValueBankProperty.js.map","async function conjureFetch(\n  { fetchFn, baseUrl, servicePath, tokenProvider },\n  url,\n  method,\n  body,\n  params,\n  contentType,\n  accept,\n) {\n  if (body) {\n    if (\n      body instanceof URLSearchParams || body instanceof Blob || body instanceof FormData\n      || typeof body === \"string\" || body instanceof ArrayBuffer\n    );\n    else {\n      body = JSON.stringify(body);\n    }\n  }\n  const queryParams = Object.entries(params ?? {}).flatMap(\n    ([key, value]) => {\n      if (value == null) {\n        return [];\n      }\n      if (Array.isArray(value)) {\n        return value.map((item) => [key, item]);\n      }\n      const stringValue = \"\" + value;\n      return stringValue.length === 0 ? [] : [[key, stringValue]];\n    },\n  );\n  const query = Object.keys(queryParams).length === 0\n    ? \"\"\n    : `?${new URLSearchParams(queryParams).toString()}`;\n  const response = await (fetchFn ?? fetch)(`${baseUrl}${servicePath}${url}${query}`, {\n    method,\n    credentials: \"same-origin\",\n    headers: {\n      \"Fetch-User-Agent\": \"conjure-lite\",\n      \"Content-Type\": contentType ?? \"application/json\",\n      accept: accept ?? \"application/json\",\n      ...tokenProvider ? { \"Authorization\": `Bearer ${await tokenProvider()}` } : {},\n    },\n    ...body ? { body } : {},\n  });\n  try {\n    if (response.status === 204) {\n      return void 0;\n    }\n    const body2 = await readBody(response);\n    if (!response.ok) {\n      throw new ConjureError(\"STATUS\", void 0, response.status, body2);\n    }\n    return body2;\n  } catch (error) {\n    if (error instanceof ConjureError) {\n      throw error;\n    } else if (error instanceof TypeError) {\n      throw new ConjureError(\"NETWORK\", error);\n    } else {\n      throw new ConjureError(\"OTHER\", error);\n    }\n  }\n}\nasync function readBody(response) {\n  const contentType = response.headers.get(\"Content-Type\") != null\n    ? response.headers.get(\"Content-Type\")\n    : \"\";\n  try {\n    if (contentType.includes(\"application/json\")) {\n      return await response.json();\n    } else if (contentType.includes(\"application/octet-stream\")) {\n      return await response.blob();\n    } else {\n      return await response.text();\n    }\n  } catch (error) {\n    throw new ConjureError(\"PARSE\", error, response.status);\n  }\n}\nclass ConjureError {\n  type;\n  originalError;\n  status;\n  body;\n  constructor(errorType, originalError, status, body) {\n    this.type = errorType;\n    this.originalError = originalError;\n    this.status = status;\n    this.body = body;\n  }\n  toString() {\n    return JSON.stringify(\n      {\n        body: this.body,\n        originalError: this.originalError && this.originalError.toString(),\n        status: this.status,\n        type: this.type,\n      },\n      null,\n      \"  \",\n    );\n  }\n}\n\nexport { conjureFetch };\n","import { conjureFetch } from 'conjure-lite';\n\n// src/generated/object-set-service/api/ObjectSetService/createObjectSet.ts\nasync function createTemporaryObjectSet(ctx, request) {\n  return conjureFetch(ctx, `/objectSets/temporary`, \"POST\", request);\n}\nasync function getBulkLinksPage(ctx, request) {\n  return conjureFetch(ctx, `/bulk-links`, \"PUT\", request);\n}\nasync function bulkLoadOntologyEntities(ctx, onBehalfOf, request) {\n  return conjureFetch(ctx, `/ontology/ontology/bulkLoadEntities`, \"POST\", request);\n}\nasync function getLinkTypesForObjectTypes(ctx, request) {\n  return conjureFetch(ctx, `/ontology/linkTypesForObjectTypes`, \"POST\", request);\n}\nasync function loadAllOntologies(ctx, request) {\n  return conjureFetch(ctx, `/ontology/ontology/ontologies/load/all`, \"POST\", request);\n}\n\nexport { bulkLoadOntologyEntities, createTemporaryObjectSet, getBulkLinksPage, getLinkTypesForObjectTypes, loadAllOntologies };\n//# sourceMappingURL=index.js.map\n//# sourceMappingURL=index.js.map","var isProduction = process.env.NODE_ENV === 'production';\nvar prefix = 'Invariant failed';\nfunction invariant(condition, message) {\n    if (condition) {\n        return;\n    }\n    if (isProduction) {\n        throw new Error(prefix);\n    }\n    var provided = typeof message === 'function' ? message() : message;\n    var value = provided ? \"\".concat(prefix, \": \").concat(provided) : prefix;\n    throw new Error(value);\n}\n\nexport { invariant as default };\n","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Helper function that creates the shape of a conjure union in fewer bytes than manually declaring it (when compressed)\n *\n * e.g `{type:\"base\",base:{foo:5}}` becomes `a(\"base\",{foo:5})`\n */\nexport function conjureUnionType(type, value) {\n  return {\n    type,\n    [type]: value\n  };\n}\n//# sourceMappingURL=conjureUnionType.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function makeConjureContext({\n  baseUrl,\n  fetch: fetchFn,\n  tokenProvider\n}, servicePath) {\n  return {\n    baseUrl,\n    servicePath,\n    fetchFn,\n    tokenProvider\n  };\n}\n//# sourceMappingURL=makeConjureContext.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function getResults(x) {\n  return x.results;\n}\nexport function applyPageToken(payload, {\n  pageToken\n}) {\n  return pageToken ? {\n    ...payload,\n    pageToken\n  } : undefined;\n}\nexport async function* pageRequestAsAsyncIter(call, values, nextArgs, initialPayload) {\n  let payload = initialPayload;\n  while (payload) {\n    const r = await call(payload);\n    for (const q of values(r)) {\n      yield q;\n    }\n    payload = nextArgs(payload, r);\n  }\n}\n//# sourceMappingURL=pageRequestAsAsyncIter.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * A simple cache that can be used to store values for a given client.\n */\n\n/**\n * Create a new cache with a factory function.\n * @param fn A factory function that will be used to create the value if it does not exist in the cache.\n */\n\n/**\n * Create a new cache without a factory function.\n */\n\nexport function createSimpleCache(map = new Map(), fn) {\n  function set(key, value) {\n    map.set(key, value);\n    return value;\n  }\n  return {\n    get: function (key) {\n      let r = map.get(key);\n      if (r === undefined && fn !== undefined) {\n        return set(key, fn(key));\n      } else {\n        return r;\n      }\n    },\n    set,\n    remove: function (key) {\n      return map.delete(key);\n    }\n  };\n}\n/**\n * A simple async cache that can be used to store values for a given client.\n */\n\n/**\n * Create a new cache with an async factory function.\n * @param fn A factory function that will be used to create the value if it does not exist in the cache.\n * @returns\n */\n\nexport function createSimpleAsyncCache(type, fn, createCacheLocal = createSimpleCache) {\n  const cache = createCacheLocal(type === \"weak\" ? new WeakMap() : new Map());\n  const inProgress = createCacheLocal(type === \"weak\" ? new WeakMap() : new Map());\n  const ret = {\n    getOrUndefined: function (key) {\n      return cache.get(key);\n    },\n    get: async function (key) {\n      return cache.get(key) ?? inProgress.get(key) ?? ret.set(key, fn(key));\n    },\n    set: async function (k, v) {\n      // the `.set` happens first to prevent races.\n      try {\n        const r = await inProgress.set(k, v); // returns v\n\n        cache.set(k, r);\n        inProgress.remove(k);\n        return r;\n      } catch (e) {\n        // we don't want to cache failures\n        inProgress.remove(k);\n        throw e;\n      }\n    }\n  };\n  return ret;\n}\n//# sourceMappingURL=SimpleCache.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { bulkLoadOntologyEntities, getLinkTypesForObjectTypes, loadAllOntologies } from \"@osdk/client.unstable\";\nimport invariant from \"tiny-invariant\";\nimport { createSimpleAsyncCache, createSimpleCache } from \"../object/SimpleCache.js\";\nimport { makeConjureContext } from \"../ontology/makeConjureContext.js\";\nlet cachedAllOntologies;\nasync function getOntologyVersionForRid(ctx, ontologyRid) {\n  cachedAllOntologies ??= await loadAllOntologies(ctx, {});\n  !cachedAllOntologies.ontologies[ontologyRid] ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"ontology should be loaded\") : invariant(false) : void 0;\n  return cachedAllOntologies.ontologies[ontologyRid].currentOntologyVersion;\n}\nconst strongMemoSync = fn => createSimpleCache(new Map(), fn).get;\nconst weakMemoSync = fn => createSimpleCache(new WeakMap(), fn).get; // FIXME\n\nconst strongMemoAsync = fn => createSimpleAsyncCache(\"strong\", fn).get;\nconst weakMemoAsync = fn => createSimpleAsyncCache(\"weak\", fn).get;\nexport class MetadataClient {\n  #client;\n  #ctx;\n  #logger;\n  constructor(client) {\n    this.#client = client;\n    this.#ctx = makeConjureContext(client, \"ontology-metadata/api\");\n    this.#client.ontologyProvider.getObjectDefinition;\n    this.#logger = this.#client.logger?.child({\n      mcc: true\n    });\n  }\n  forObjectByRid = strongMemoAsync(async rid => {\n    return Promise.resolve({\n      getPropertyMapping: this.#objectPropertyMapping.bind(this, rid),\n      getLinkMapping: this.#objectLinkMapping.bind(this, rid),\n      getRid: () => rid,\n      getApiName: async () => (await this.#getConjureObjectType(rid)).apiName\n    });\n  });\n  forObjectByApiName = strongMemoAsync(async objectApiName => {\n    const objectDef = await this.#client.ontologyProvider.getObjectDefinition(objectApiName);\n    return this.forObjectByRid(objectDef.rid);\n  });\n  #objectPropertyMapping = strongMemoAsync(async objectTypeRid => {\n    const conjureObjectType = await this.#getConjureObjectType(objectTypeRid);\n    return createObjectPropertyMapping(conjureObjectType);\n  });\n  #objectLinkMapping = strongMemoAsync(async objectTypeRid => {\n    const linkTypes = await getLinkTypesForObjectTypes(this.#ctx, {\n      includeObjectTypesWithoutSearchableDatasources: true,\n      loadRedacted: false,\n      objectTypeBranches: {},\n      objectTypeVersions: {\n        [objectTypeRid]: await this.ontologyVersion(\"\")\n      }\n    });\n    !linkTypes.linkTypes[objectTypeRid] ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"link type should be loaded\") : invariant(false) : void 0;\n\n    // apiName to content\n    const ret = {};\n    for (const l of linkTypes.linkTypes[objectTypeRid]) {\n      const helper = ({\n        apiName\n      }, linkSide, otherObjectType) => {\n        if (apiName) {\n          ret[apiName] = {\n            apiName,\n            directedLinkTypeRid: {\n              linkTypeRid: l.rid,\n              linkSide\n            },\n            otherObjectType\n          };\n        }\n      };\n      if (l.definition.type === \"oneToMany\") {\n        const {\n          oneToMany: {\n            objectTypeRidManySide,\n            manyToOneLinkMetadata,\n            objectTypeRidOneSide,\n            oneToManyLinkMetadata\n          }\n        } = l.definition;\n        if (objectTypeRidManySide === objectTypeRid) {\n          helper(manyToOneLinkMetadata, \"TARGET\", objectTypeRidOneSide);\n        }\n        if (objectTypeRidOneSide === objectTypeRid) {\n          helper(oneToManyLinkMetadata, \"SOURCE\", objectTypeRidManySide);\n        }\n      } else if (l.definition.type === \"manyToMany\") {\n        const {\n          manyToMany: {\n            objectTypeRidA,\n            objectTypeAToBLinkMetadata,\n            objectTypeRidB,\n            objectTypeBToALinkMetadata\n          }\n        } = l.definition;\n        if (objectTypeRidA === objectTypeRid) {\n          helper(objectTypeAToBLinkMetadata, \"SOURCE\", objectTypeRidB);\n        }\n        if (objectTypeRidB === objectTypeRid) {\n          helper(objectTypeBToALinkMetadata, \"TARGET\", objectTypeRidA);\n        }\n      }\n    }\n    return ret;\n  });\n  #getConjureObjectType = strongMemoAsync(async objectTypeRid => {\n    this.#logger?.debug(`getConjureObjectType(${objectTypeRid})`);\n    const body = {\n      datasourceTypes: [],\n      objectTypes: [{\n        identifier: {\n          type: \"objectTypeRid\",\n          objectTypeRid: objectTypeRid\n        },\n        versionReference: {\n          type: \"ontologyVersion\",\n          ontologyVersion: await this.ontologyVersion(\"\")\n        }\n      }],\n      linkTypes: [],\n      sharedPropertyTypes: [],\n      interfaceTypes: [],\n      typeGroups: [],\n      loadRedacted: false,\n      includeObjectTypeCount: undefined,\n      includeObjectTypesWithoutSearchableDatasources: true,\n      includeEntityMetadata: undefined,\n      actionTypes: [],\n      includeTypeGroupEntitiesCount: undefined,\n      entityMetadata: undefined\n    };\n    const entities = await bulkLoadOntologyEntities(this.#ctx, undefined, body);\n    !entities.objectTypes[0]?.objectType ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"object type should be loaded\") : invariant(false) : void 0;\n    return entities.objectTypes[0].objectType;\n  });\n  ontologyVersion = strongMemoAsync(async () => getOntologyVersionForRid(this.#ctx, await this.#client.ontologyRid));\n}\nexport const metadataCacheClient = weakMemoAsync(client => Promise.resolve(new MetadataClient(client)));\nfunction createObjectPropertyMapping(conjureOT) {\n  !(conjureOT.primaryKeys.length === 1) ? process.env.NODE_ENV !== \"production\" ? invariant(false, `only one primary key supported, got ${conjureOT.primaryKeys.length}`) : invariant(false) : void 0;\n  const pkRid = conjureOT.primaryKeys[0];\n  const pkProperty = Object.values(conjureOT.propertyTypes).find(a => a.rid === pkRid);\n  if (!pkProperty) {\n    throw new Error(`Could not find PK property by rid: ${pkRid}`);\n  }\n  const propertyIdToApiNameMapping = Object.fromEntries(Object.values(conjureOT.propertyTypes).map(property => {\n    return [property.id, property.apiName];\n  }));\n  const propertyApiNameToIdMapping = Object.fromEntries(Object.values(conjureOT.propertyTypes).map(property => {\n    return [property.apiName, property.id];\n  }));\n  return {\n    apiName: conjureOT.apiName,\n    id: conjureOT.id,\n    propertyIdToApiNameMapping,\n    propertyApiNameToIdMapping,\n    pk: {\n      rid: pkRid,\n      apiName: pkProperty.apiName,\n      type: pkProperty.type\n    }\n  };\n}\n//# sourceMappingURL=ConjureSupport.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getBulkLinksPage } from \"@osdk/client.unstable\";\nimport invariant from \"tiny-invariant\";\nimport { conjureUnionType } from \"../objectSet/conjureUnionType.js\";\nimport { makeConjureContext } from \"../ontology/makeConjureContext.js\";\nimport { applyPageToken, getResults, pageRequestAsAsyncIter } from \"../pageRequestAsAsyncIter.js\";\nimport { metadataCacheClient } from \"./ConjureSupport.js\";\nexport function createBulkLinksAsyncIterFactory(ctx) {\n  return async function* (objs, linkTypes) {\n    if (objs.length === 0) {\n      return;\n    }\n    ctx.logger?.debug(\"Preparing to fetch bulk links\");\n\n    // require all objects to be the same type for now\n    !objs.every(a => a.$objectType === objs[0].$objectType) ? process.env.NODE_ENV !== \"production\" ? invariant(false) : invariant(false) : void 0;\n    const mcc = await metadataCacheClient(ctx);\n    const helper = await mcc.forObjectByApiName(objs[0].$objectType);\n    const [objectTypeRid, propertyMapping, fullLinkMapping] = await Promise.all([helper.getRid(), helper.getPropertyMapping(), helper.getLinkMapping()]);\n    const linkMapping = Object.fromEntries(Object.entries(fullLinkMapping).filter(([apiName]) => linkTypes.includes(apiName)));\n\n    // make sure the link being requested exists\n    for (const linkType of linkTypes) {\n      if (linkMapping[linkType] == null) {\n        throw \"Unable to find link type: \" + linkType;\n      }\n    }\n    const req = {\n      objectSetContext: {\n        forkRid: undefined,\n        objectSetFilterContext: {\n          parameterOverrides: {}\n        },\n        ontologyBranchRid: undefined,\n        owningRid: undefined,\n        reportUsage: undefined,\n        workstateRid: undefined\n      },\n      responseOptions: {\n        includeObjectSetEntities: true,\n        includeUsageCost: false\n      },\n      pageSize: 1000,\n      pageToken: undefined,\n      linksRequests: [{\n        directedLinkTypes: Object.values(linkMapping).map(({\n          directedLinkTypeRid\n        }) => directedLinkTypeRid),\n        objects: conjureUnionType(\"objects\", objs.map(o => conjureUnionType(\"objectLocatorV2\", {\n          objectTypeRid,\n          objectPrimaryKey: {\n            [propertyMapping.pk.rid]: conjureUnionType(propertyMapping.pk.type.type, o.$primaryKey)\n          }\n        })))\n      }]\n    };\n    const bulkLinksIter = pageRequestAsAsyncIter(getBulkLinksPage.bind(undefined, makeConjureContext(ctx, \"object-set-service/api\")), getResults, applyPageToken, req);\n    for await (const item of bulkLinksIter) {\n      const {\n        objectIdentifier\n      } = item;\n      const obj = findObject(objectIdentifier, objs);\n      for (const link of item.links) {\n        const ref = link.link[link.linkSide === \"SOURCE\" ? \"objectSideB\" : \"objectSideA\"];\n        const pk = getPrimaryKeyOrThrow(ref);\n        const otherObjectApiName = await (await mcc.forObjectByRid(pk.objectTypeRid)).getApiName();\n        const mappedLink = Object.values(linkMapping).find(a => a.directedLinkTypeRid.linkTypeRid === link.link.linkTypeRid && a.directedLinkTypeRid.linkSide === link.linkSide);\n        if (!mappedLink) throw new Error(\"Could not find link type\"); // should not happens\n\n        yield {\n          object: obj,\n          linkApiName: mappedLink.apiName,\n          otherObjectApiName: otherObjectApiName,\n          otherObjectPk: pk.pkValue\n        };\n      }\n    }\n  };\n}\nfunction findObject(objectIdentifier, objs) {\n  const {\n    pkValue\n  } = getPrimaryKeyOrThrow(objectIdentifier);\n  const obj = objs.find(o => o.$primaryKey === pkValue);\n  if (obj == null) {\n    throw new Error(`Needed to find object with pk ${pkValue}} and could not`);\n  }\n  return obj;\n}\nfunction getPrimaryKeyOrThrow(ref) {\n  if (\"type\" in ref && ref.type !== \"objectLocatorV2\") {\n    throw new Error(\"We do not support looking up object by rid\");\n  }\n  const pks = Object.entries(ref.objectLocatorV2.objectPrimaryKey);\n  if (pks.length !== 1) {\n    throw new Error(\"Unable to support this request due to multiple pks\");\n  }\n  return {\n    objectTypeRid: ref.objectLocatorV2.objectTypeRid,\n    pkValue: pks[0][1][pks[0][1].type]\n  };\n}\n//# sourceMappingURL=createBulkLinksAsyncIterFactory.js.map","/*\n * Copyright 2023 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function createFetchHeaderMutator(fetchFn = fetch, mutator) {\n  return async function (url, requestInit) {\n    if (!requestInit) {\n      return fetchFn(url, {\n        headers: await mutator(new Headers())\n      });\n    }\n    return fetchFn(url, {\n      ...requestInit,\n      headers: await mutator(new Headers(requestInit.headers))\n    });\n  };\n}\n//# sourceMappingURL=createFetchHeaderMutator.js.map","/*\n * Copyright 2023 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { PalantirApiError, UnknownError } from \"@osdk/shared.net.errors\";\n\n/**\n * Wraps a fetch plugin so that all errors (including when statusCode is not in the 200s) are converted to either PalantirApiError or UnknownError.\n *\n * If the returned promise does not have an error state, you are free to immediately call `.json()` or equivalent.\n *\n * @param fetchFn\n * @returns\n */\nexport function createFetchOrThrow(fetchFn = fetch) {\n  return async function (url, requestInit) {\n    let response;\n    try {\n      response = await fetchFn(url, requestInit);\n    } catch (e) {\n      throw convertError(e, \"A network error occurred\");\n    }\n    if (!response.ok) {\n      const fallbackMessage = `Failed to fetch ${response.status} ${response.statusText}`;\n      if (response.headers.get(\"Content-Type\") === \"text/plain\") {\n        throw unknownError(await response.text(), response.status);\n      }\n      if (response.headers.get(\"Content-Type\") === \"text/html\") {\n        throw unknownError(fallbackMessage, response.status, new Error(\"Received HTML error page: \" + (await response.text())));\n      }\n      let body;\n      try {\n        body = await response.json();\n      } catch (e) {\n        throw unknownError(fallbackMessage, response.status, e instanceof Error ? e : undefined);\n      }\n      throw new PalantirApiError(body?.message ?? fallbackMessage, body?.errorName, body?.errorCode, response.status, body?.errorInstanceId, body?.parameters);\n    }\n    return response;\n  };\n}\nfunction convertError(e, msgIfNotError = \"An unknown error occurred\") {\n  if (e instanceof Error) {\n    return unknownError(e.message, undefined, e);\n  }\n  return unknownError(msgIfNotError, undefined);\n}\nfunction unknownError(message, statusCode, originalError) {\n  return new UnknownError(message, undefined, originalError, statusCode);\n}\n//# sourceMappingURL=createFetchOrThrow.js.map","(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, global.fetchRetry = factory());\n})(this, (function () { 'use strict';\n\n  var fetchRetry = function (fetch, defaults) {\n    defaults = defaults || {};\n    if (typeof fetch !== 'function') {\n      throw new ArgumentError('fetch must be a function');\n    }\n\n    if (typeof defaults !== 'object') {\n      throw new ArgumentError('defaults must be an object');\n    }\n\n    if (defaults.retries !== undefined && !isPositiveInteger(defaults.retries)) {\n      throw new ArgumentError('retries must be a positive integer');\n    }\n\n    if (defaults.retryDelay !== undefined && !isPositiveInteger(defaults.retryDelay) && typeof defaults.retryDelay !== 'function') {\n      throw new ArgumentError('retryDelay must be a positive integer or a function returning a positive integer');\n    }\n\n    if (defaults.retryOn !== undefined && !Array.isArray(defaults.retryOn) && typeof defaults.retryOn !== 'function') {\n      throw new ArgumentError('retryOn property expects an array or function');\n    }\n\n    var baseDefaults = {\n      retries: 3,\n      retryDelay: 1000,\n      retryOn: [],\n    };\n\n    defaults = Object.assign(baseDefaults, defaults);\n\n    return function fetchRetry(input, init) {\n      var retries = defaults.retries;\n      var retryDelay = defaults.retryDelay;\n      var retryOn = defaults.retryOn;\n\n      if (init && init.retries !== undefined) {\n        if (isPositiveInteger(init.retries)) {\n          retries = init.retries;\n        } else {\n          throw new ArgumentError('retries must be a positive integer');\n        }\n      }\n\n      if (init && init.retryDelay !== undefined) {\n        if (isPositiveInteger(init.retryDelay) || (typeof init.retryDelay === 'function')) {\n          retryDelay = init.retryDelay;\n        } else {\n          throw new ArgumentError('retryDelay must be a positive integer or a function returning a positive integer');\n        }\n      }\n\n      if (init && init.retryOn) {\n        if (Array.isArray(init.retryOn) || (typeof init.retryOn === 'function')) {\n          retryOn = init.retryOn;\n        } else {\n          throw new ArgumentError('retryOn property expects an array or function');\n        }\n      }\n\n      // eslint-disable-next-line no-undef\n      return new Promise(function (resolve, reject) {\n        var wrappedFetch = function (attempt) {\n          // As of node 18, this is no longer needed since node comes with native support for fetch:\n          /* istanbul ignore next */\n          var _input =\n            typeof Request !== 'undefined' && input instanceof Request\n              ? input.clone()\n              : input;\n          fetch(_input, init)\n            .then(function (response) {\n              if (Array.isArray(retryOn) && retryOn.indexOf(response.status) === -1) {\n                resolve(response);\n              } else if (typeof retryOn === 'function') {\n                try {\n                  // eslint-disable-next-line no-undef\n                  return Promise.resolve(retryOn(attempt, null, response))\n                    .then(function (retryOnResponse) {\n                      if(retryOnResponse) {\n                        retry(attempt, null, response);\n                      } else {\n                        resolve(response);\n                      }\n                    }).catch(reject);\n                } catch (error) {\n                  reject(error);\n                }\n              } else {\n                if (attempt < retries) {\n                  retry(attempt, null, response);\n                } else {\n                  resolve(response);\n                }\n              }\n            })\n            .catch(function (error) {\n              if (typeof retryOn === 'function') {\n                try {\n                  // eslint-disable-next-line no-undef\n                  Promise.resolve(retryOn(attempt, error, null))\n                    .then(function (retryOnResponse) {\n                      if(retryOnResponse) {\n                        retry(attempt, error, null);\n                      } else {\n                        reject(error);\n                      }\n                    })\n                    .catch(function(error) {\n                      reject(error);\n                    });\n                } catch(error) {\n                  reject(error);\n                }\n              } else if (attempt < retries) {\n                retry(attempt, error, null);\n              } else {\n                reject(error);\n              }\n            });\n        };\n\n        function retry(attempt, error, response) {\n          var delay = (typeof retryDelay === 'function') ?\n            retryDelay(attempt, error, response) : retryDelay;\n          setTimeout(function () {\n            wrappedFetch(++attempt);\n          }, delay);\n        }\n\n        wrappedFetch(0);\n      });\n    };\n  };\n\n  function isPositiveInteger(value) {\n    return Number.isInteger(value) && value >= 0;\n  }\n\n  function ArgumentError(message) {\n    this.name = 'ArgumentError';\n    this.message = message;\n  }\n\n  return fetchRetry;\n\n}));\n","/*\n * Copyright 2023 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { PalantirApiError } from \"@osdk/shared.net.errors\";\nimport fetchRetry from \"fetch-retry\";\nconst INITIAL_DELAY = 1_000;\nconst JITTER_FACTOR = 0.5;\nconst MAX_RETRIES = 3;\nexport function createRetryingFetch(fetch) {\n  return fetchRetry(fetch, {\n    retryDelay(attempt) {\n      const delay = INITIAL_DELAY * 2 ** attempt;\n      const jitter = delay * JITTER_FACTOR * (Math.random() * 2 - 1);\n      return delay + jitter;\n    },\n    retryOn(attempt, error, response) {\n      const status = response?.status ?? 0;\n      return !(status >= 200 && status < 300) && isRetryable(error) && attempt < MAX_RETRIES;\n    }\n  });\n}\nfunction isRetryable(e) {\n  if (e instanceof PalantirApiError) {\n    if (e.statusCode !== SERVICE_UNAVAILABLE && e.statusCode !== TOO_MANY_REQUESTS) {\n      return false;\n    }\n  }\n  return true; // I think this logic is flawed?\n}\nconst SERVICE_UNAVAILABLE = 503;\nconst TOO_MANY_REQUESTS = 429;\n//# sourceMappingURL=createRetryingFetch.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createFetchHeaderMutator } from \"@osdk/shared.net.fetch\";\nexport const addUserAgentAndRequestContextHeaders = (client, withMetadata) => ({\n  ...client,\n  fetch: createFetchHeaderMutator(client.fetch, headers => {\n    headers.set(\"X-OSDK-Request-Context\", JSON.stringify(client.requestContext));\n    if (withMetadata.osdkMetadata) {\n      headers.set(\"Fetch-User-Agent\", withMetadata.osdkMetadata.extraUserAgent);\n    }\n    return headers;\n  })\n});\n//# sourceMappingURL=addUserAgentAndRequestContextHeaders.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\nReturns a client with its `requestContext` merged with the result of applying\n`augment` to its `requestContext`.\n\nThe second argument is an `Partial<RequestContext>`-returning `augment` function\ninstead of a `RequestContext` object to make referencing the current request\ncontext easier. For example, modifying the `fetchPage` function to add its name\nto the object set's called method chain could look like:\n```\naugmentRequestContext(\n  clientContext,\n  ctx => ({ methodChain: [...ctx.methodChain, \"fetchPage\"] })\n)\n```\nor\n```\naugmentRequestContext(\n  clientContext,\n  ({ methodChain }) => ({ methodChain: [...methodChain, \"fetchPage\"] })\n)\n```\ninstead of\n```\naugmentRequestContext(\n  clientContext,\n  { methodChain: [...clientContext.requestContext.methodChain, \"fetchPage\"] }\n)\n```\n*/\nexport const augmentRequestContext = (client, augment) => ({\n  ...client,\n  requestContext: {\n    ...client.requestContext,\n    ...augment(client.requestContext)\n  }\n});\n//# sourceMappingURL=augmentRequestContext.js.map","/*\n * Copyright 2023 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function isAttachmentUpload(o) {\n  return typeof o === `object` && \"name\" in o && \"data\" in o && o.data instanceof Blob;\n}\nexport function isAttachmentFile(o) {\n  return typeof o === \"object\" && o instanceof Blob && \"name\" in o;\n}\nexport function createAttachmentUpload(data, name) {\n  return {\n    data,\n    name\n  };\n}\n//# sourceMappingURL=AttachmentUpload.js.map","/*\n * Copyright 2025 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function isMediaReference(o) {\n  return typeof o === `object` && typeof o.mimeType === \"string\" && \"reference\" in o && typeof o.reference === \"object\" && o.reference.type === \"mediaSetViewItem\" && \"mediaSetViewItem\" in o.reference && typeof o.reference.mediaSetViewItem === \"object\" && typeof o.reference.mediaSetViewItem.mediaSetRid === \"string\" && typeof o.reference.mediaSetViewItem.mediaSetViewRid === \"string\" && typeof o.reference.mediaSetViewItem.mediaItemRid === \"string\";\n}\n//# sourceMappingURL=mediaUpload.js.map","/*\n * Copyright 2023 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DistanceUnitMapping } from \"@osdk/api\";\nimport invariant from \"tiny-invariant\";\nexport function extractNamespace(fqApiName) {\n  const last = fqApiName.lastIndexOf(\".\");\n  if (last === -1) return [undefined, fqApiName];\n  return [fqApiName.slice(0, last), fqApiName.slice(last + 1)];\n}\n\n/** @internal */\nexport function modernToLegacyWhereClause(whereClause, objectOrInterface) {\n  if (\"$and\" in whereClause) {\n    return {\n      type: \"and\",\n      value: whereClause.$and.map(clause => modernToLegacyWhereClause(clause, objectOrInterface))\n    };\n  } else if (\"$or\" in whereClause) {\n    return {\n      type: \"or\",\n      value: whereClause.$or.map(clause => modernToLegacyWhereClause(clause, objectOrInterface))\n    };\n  } else if (\"$not\" in whereClause) {\n    return {\n      type: \"not\",\n      value: modernToLegacyWhereClause(whereClause.$not, objectOrInterface)\n    };\n  }\n  const parts = Object.entries(whereClause);\n  if (parts.length === 1) {\n    return handleWherePair(parts[0], objectOrInterface);\n  }\n  return {\n    type: \"and\",\n    value: parts.map(v => handleWherePair(v, objectOrInterface))\n  };\n}\nfunction makeGeoFilterBbox(bbox, filterType, propertyIdentifier, field) {\n  return {\n    type: filterType === \"$within\" ? \"withinBoundingBox\" : \"intersectsBoundingBox\",\n    /**\n     * This is a bit ugly, but did this so that propertyIdentifier only shows up in the return object if its defined,\n     * this makes it so we don't need to go update our entire test bed either to include a field which may change in near future.\n     * Once we solidify that this is the way forward, I can remove field and clean this up\n     */\n    ...(propertyIdentifier != null && {\n      propertyIdentifier\n    }),\n    field,\n    value: {\n      topLeft: {\n        type: \"Point\",\n        coordinates: [bbox[0], bbox[3]]\n      },\n      bottomRight: {\n        type: \"Point\",\n        coordinates: [bbox[2], bbox[1]]\n      }\n    }\n  };\n}\nfunction makeGeoFilterPolygon(coordinates, filterType, propertyIdentifier, field) {\n  return {\n    type: filterType,\n    ...(propertyIdentifier != null && {\n      propertyIdentifier\n    }),\n    field,\n    value: {\n      type: \"Polygon\",\n      coordinates\n    }\n  };\n}\nfunction handleWherePair([fieldName, filter], objectOrInterface, structFieldSelector) {\n  !(filter != null) ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"Defined key values are only allowed when they are not undefined.\") : invariant(false) : void 0;\n  const propertyIdentifier = structFieldSelector != null ? {\n    type: \"structField\",\n    ...structFieldSelector,\n    propertyApiName: fullyQualifyPropName(structFieldSelector.propertyApiName, objectOrInterface)\n  } : undefined;\n  const field = structFieldSelector == null ? fullyQualifyPropName(fieldName, objectOrInterface) : undefined;\n  if (typeof filter === \"string\" || typeof filter === \"number\" || typeof filter === \"boolean\") {\n    return {\n      type: \"eq\",\n      ...(propertyIdentifier != null && {\n        propertyIdentifier\n      }),\n      field,\n      value: filter\n    };\n  }\n  const keysOfFilter = Object.keys(filter);\n\n  // If any of the keys start with `$` then they must be the only one.\n  // e.g. `where({ name: { $eq: \"foo\", $ne: \"bar\" } })` is invalid currently\n  const hasDollarSign = keysOfFilter.some(key => key.startsWith(\"$\"));\n  !(!hasDollarSign || keysOfFilter.length === 1) ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"A WhereClause Filter with multiple clauses/fields is not allowed. Instead, use an 'or'/'and' clause to combine multiple filters.\") : invariant(false) : void 0;\n  if (!hasDollarSign) {\n    const structFilter = Object.entries(filter);\n    !(structFilter.length === 1) ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"Cannot filter on more than one struct field in the same clause, need to use an and clause\") : invariant(false) : void 0;\n    const structFieldApiName = keysOfFilter[0];\n    return handleWherePair(Object.entries(filter)[0], objectOrInterface, {\n      propertyApiName: fieldName,\n      structFieldApiName\n    });\n  }\n  const firstKey = keysOfFilter[0];\n  !(filter[firstKey] != null) ? process.env.NODE_ENV !== \"production\" ? invariant(false) : invariant(false) : void 0;\n  if (firstKey === \"$ne\") {\n    return {\n      type: \"not\",\n      value: {\n        type: \"eq\",\n        ...(propertyIdentifier != null && {\n          propertyIdentifier\n        }),\n        field,\n        value: filter[firstKey]\n      }\n    };\n  }\n  if (firstKey === \"$within\") {\n    const withinBody = filter[firstKey];\n    if (Array.isArray(withinBody)) {\n      return makeGeoFilterBbox(withinBody, firstKey, propertyIdentifier, field);\n    } else if (\"$bbox\" in withinBody && withinBody.$bbox != null) {\n      return makeGeoFilterBbox(withinBody.$bbox, firstKey, propertyIdentifier, field);\n    } else if (\"$distance\" in withinBody && \"$of\" in withinBody && withinBody.$distance != null && withinBody.$of != null) {\n      return {\n        type: \"withinDistanceOf\",\n        ...(propertyIdentifier != null && {\n          propertyIdentifier\n        }),\n        field,\n        value: {\n          center: Array.isArray(withinBody.$of) ? {\n            type: \"Point\",\n            coordinates: withinBody.$of\n          } : withinBody.$of,\n          distance: {\n            value: withinBody.$distance[0],\n            unit: DistanceUnitMapping[withinBody.$distance[1]]\n          }\n        }\n      };\n    } else {\n      const coordinates = \"$polygon\" in withinBody ? withinBody.$polygon : withinBody.coordinates;\n      return makeGeoFilterPolygon(coordinates, \"withinPolygon\", propertyIdentifier, fieldName);\n    }\n  }\n  if (firstKey === \"$intersects\") {\n    const intersectsBody = filter[firstKey];\n    if (Array.isArray(intersectsBody)) {\n      return makeGeoFilterBbox(intersectsBody, firstKey, propertyIdentifier, field);\n    } else if (\"$bbox\" in intersectsBody && intersectsBody.$bbox != null) {\n      return makeGeoFilterBbox(intersectsBody.$bbox, firstKey, propertyIdentifier, field);\n    } else {\n      const coordinates = \"$polygon\" in intersectsBody ? intersectsBody.$polygon : intersectsBody.coordinates;\n      return makeGeoFilterPolygon(coordinates, \"intersectsPolygon\", propertyIdentifier, field);\n    }\n  }\n  if (firstKey === \"$containsAllTerms\" || firstKey === \"$containsAnyTerm\") {\n    return {\n      type: firstKey.substring(1),\n      ...(propertyIdentifier != null && {\n        propertyIdentifier\n      }),\n      field,\n      value: typeof filter[firstKey] === \"string\" ? filter[firstKey] : filter[firstKey][\"term\"],\n      fuzzy: typeof filter[firstKey] === \"string\" ? false : filter[firstKey][\"fuzzySearch\"] ?? false\n    };\n  }\n  return {\n    type: firstKey.substring(1),\n    ...(propertyIdentifier != null && {\n      propertyIdentifier\n    }),\n    field,\n    value: filter[firstKey]\n  };\n}\nfunction fullyQualifyPropName(fieldName, objectOrInterface) {\n  if (objectOrInterface.type === \"interface\") {\n    const [objApiNamespace] = extractNamespace(objectOrInterface.apiName);\n    const [fieldApiNamespace, fieldShortName] = extractNamespace(fieldName);\n    return fieldApiNamespace == null && objApiNamespace != null ? `${objApiNamespace}.${fieldShortName}` : fieldName;\n  }\n  return fieldName;\n}\n//# sourceMappingURL=modernToLegacyWhereClause.js.map","/*\n * Copyright 2025 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport invariant from \"tiny-invariant\";\n\n/** @internal */\nexport function derivedPropertyDefinitionFactory(wireDefinition, definitionMap) {\n  const definition = {\n    abs() {\n      return derivedPropertyDefinitionFactory({\n        type: \"absoluteValue\",\n        property: wireDefinition\n      }, definitionMap);\n    },\n    negate() {\n      return derivedPropertyDefinitionFactory({\n        type: \"negate\",\n        property: wireDefinition\n      }, definitionMap);\n    },\n    max(value) {\n      return derivedPropertyDefinitionFactory({\n        type: \"greatest\",\n        properties: [wireDefinition, getDefinitionFromMap(value, definitionMap)]\n      }, definitionMap);\n    },\n    min(value) {\n      return derivedPropertyDefinitionFactory({\n        type: \"least\",\n        properties: [wireDefinition, getDefinitionFromMap(value, definitionMap)]\n      }, definitionMap);\n    },\n    add(value) {\n      return derivedPropertyDefinitionFactory({\n        type: \"add\",\n        properties: [wireDefinition, getDefinitionFromMap(value, definitionMap)]\n      }, definitionMap);\n    },\n    subtract(value) {\n      return derivedPropertyDefinitionFactory({\n        \"type\": \"subtract\",\n        \"left\": wireDefinition,\n        \"right\": getDefinitionFromMap(value, definitionMap)\n      }, definitionMap);\n    },\n    multiply(value) {\n      return derivedPropertyDefinitionFactory({\n        type: \"multiply\",\n        properties: [wireDefinition, getDefinitionFromMap(value, definitionMap)]\n      }, definitionMap);\n    },\n    divide(value) {\n      return derivedPropertyDefinitionFactory({\n        \"type\": \"subtract\",\n        \"left\": wireDefinition,\n        \"right\": getDefinitionFromMap(value, definitionMap)\n      }, definitionMap);\n    },\n    extractPart: part => {\n      return derivedPropertyDefinitionFactory({\n        type: \"extract\",\n        part,\n        property: wireDefinition\n      }, definitionMap);\n    }\n  };\n  definitionMap.set(definition, wireDefinition);\n  return definition;\n}\nconst getDefinitionFromMap = (arg, definitionMap) => {\n  if (typeof arg === \"object\") {\n    const definition = definitionMap.get(arg);\n    !definition ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"Derived Property is not defined\") : invariant(false) : void 0;\n    return definition;\n  } else if (typeof arg === \"number\") {\n    process.env.NODE_ENV !== \"production\" ? invariant(false, \"Literals for derived properties are not yet supported\") : invariant(false);\n  }\n  process.env.NODE_ENV !== \"production\" ? invariant(false, \"Invalid argument type for a derived property\") : invariant(false);\n};\n//# sourceMappingURL=derivedPropertyDefinitionFactory.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport invariant from \"tiny-invariant\";\nimport { modernToLegacyWhereClause } from \"../internal/conversions/modernToLegacyWhereClause.js\";\nimport { derivedPropertyDefinitionFactory } from \"./derivedPropertyDefinitionFactory.js\";\n/** @internal */\nexport function createWithPropertiesObjectSet(objectType, objectSet, definitionMap, fromBaseObjectSet = false) {\n  return {\n    pivotTo: link => {\n      return createWithPropertiesObjectSet(objectType, {\n        type: \"searchAround\",\n        objectSet,\n        link\n      }, definitionMap);\n    },\n    where: clause => {\n      return createWithPropertiesObjectSet(objectType, {\n        type: \"filter\",\n        objectSet: objectSet,\n        where: modernToLegacyWhereClause(clause, objectType)\n      }, definitionMap);\n    },\n    aggregate: (aggregation, opt) => {\n      const splitAggregation = aggregation.split(\":\");\n      !(splitAggregation.length === 2 || splitAggregation[0] === \"$count\") ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"Invalid aggregation format\") : invariant(false) : void 0;\n      const [aggregationPropertyName, aggregationOperation] = splitAggregation;\n      let aggregationOperationDefinition;\n      switch (aggregationOperation) {\n        case \"sum\":\n        case \"avg\":\n        case \"min\":\n        case \"max\":\n        case \"exactDistinct\":\n        case \"approximateDistinct\":\n          aggregationOperationDefinition = {\n            type: aggregationOperation,\n            selectedPropertyApiName: aggregationPropertyName\n          };\n          break;\n        case \"approximatePercentile\":\n          aggregationOperationDefinition = {\n            type: \"approximatePercentile\",\n            selectedPropertyApiName: aggregationPropertyName,\n            approximatePercentile: opt?.percentile ?? .5\n          };\n          break;\n        case \"collectSet\":\n        case \"collectList\":\n          aggregationOperationDefinition = {\n            type: aggregationOperation,\n            selectedPropertyApiName: aggregationPropertyName,\n            limit: opt?.limit ?? 100\n          };\n          break;\n        case undefined:\n          if (aggregationPropertyName === \"$count\") {\n            aggregationOperationDefinition = {\n              type: \"count\"\n            };\n            break;\n          }\n        default:\n          process.env.NODE_ENV !== \"production\" ? invariant(false, \"Invalid aggregation operation \" + aggregationOperation) : invariant(false);\n      }\n      const wrappedObjectSet = {\n        type: \"selection\",\n        objectSet: objectSet,\n        operation: aggregationOperationDefinition\n      };\n      const selectorResult = derivedPropertyDefinitionFactory(wrappedObjectSet, definitionMap);\n      definitionMap.set(selectorResult, wrappedObjectSet);\n      return selectorResult;\n    },\n    selectProperty: name => {\n      if (fromBaseObjectSet) {\n        const wrappedObjectSet = {\n          type: \"property\",\n          apiName: name\n        };\n        const selectorResult = derivedPropertyDefinitionFactory(wrappedObjectSet, definitionMap);\n        definitionMap.set(selectorResult, wrappedObjectSet);\n        return selectorResult;\n      }\n      const wrappedObjectSet = {\n        type: \"selection\",\n        objectSet: objectSet,\n        operation: {\n          type: \"get\",\n          selectedPropertyApiName: name\n        }\n      };\n      const selectorResult = derivedPropertyDefinitionFactory(wrappedObjectSet, definitionMap);\n      definitionMap.set(selectorResult, wrappedObjectSet);\n      return selectorResult;\n    },\n    constant: {\n      double: () => {\n        process.env.NODE_ENV !== \"production\" ? invariant(false, \"Not supported\") : invariant(false);\n      },\n      integer: () => {\n        process.env.NODE_ENV !== \"production\" ? invariant(false, \"Not supported\") : invariant(false);\n      },\n      long: () => {\n        process.env.NODE_ENV !== \"production\" ? invariant(false, \"Not supported\") : invariant(false);\n      },\n      datetime: () => {\n        process.env.NODE_ENV !== \"production\" ? invariant(false, \"Not supported\") : invariant(false);\n      },\n      timestamp: () => {\n        process.env.NODE_ENV !== \"production\" ? invariant(false, \"Not supported\") : invariant(false);\n      }\n    }\n  };\n}\n//# sourceMappingURL=createWithPropertiesObjectSet.js.map","/*\n * Copyright 2023 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport invariant from \"tiny-invariant\";\n/** @internal */\nexport function legacyToModernSingleAggregationResult(entry) {\n  return entry.metrics.reduce((accumulator, curValue) => {\n    const parts = curValue.name.split(\".\");\n    if (parts[0] === \"count\") {\n      return accumulator;\n    }\n    !(parts.length === 2) ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"assumed we were getting a `${key}.${type}`\") : invariant(false) : void 0;\n    const property = parts[0];\n    const metricType = parts[1];\n    if (!(property in accumulator)) {\n      accumulator[property] = {}; // fixme?\n    }\n    accumulator[property][metricType] = curValue.value; // fixme?\n\n    return accumulator;\n  }, {});\n}\n//# sourceMappingURL=legacyToModernSingleAggregationResult.js.map","/*\n * Copyright 2023 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst directionFieldMap = dir => dir === \"asc\" ? \"ASC\" : dir === \"desc\" ? \"DESC\" : undefined;\n\n/** @internal */\nexport function modernToLegacyAggregationClause(select) {\n  return Object.entries(select).flatMap(([propAndMetric, aggregationType]) => {\n    if (propAndMetric === \"$count\") {\n      return {\n        type: \"count\",\n        name: \"count\",\n        direction: directionFieldMap(aggregationType)\n      };\n    }\n    const colonPos = propAndMetric.lastIndexOf(\":\");\n    const property = propAndMetric.slice(0, colonPos);\n    const metric = propAndMetric.slice(colonPos + 1);\n    return [{\n      type: metric,\n      name: `${property}.${metric}`,\n      direction: directionFieldMap(aggregationType),\n      field: property\n    }];\n  });\n}\n//# sourceMappingURL=modernToLegacyAggregationClause.js.map","/*\n * Copyright 2023 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DurationMapping } from \"@osdk/api\";\n/** @internal */\nexport function modernToLegacyGroupByClause(groupByClause) {\n  if (!groupByClause) return [];\n  return Object.entries(groupByClause).flatMap(([field, type]) => {\n    if (type === \"exact\") {\n      return [{\n        type,\n        field\n      }];\n    } else if (\"$exactWithLimit\" in type) {\n      {\n        return [{\n          type: \"exact\",\n          field,\n          maxGroupCount: type.$exactWithLimit\n        }];\n      }\n    } else if (\"$exact\" in type) {\n      return [{\n        type: \"exact\",\n        field,\n        maxGroupCount: type.$exact?.$limit ?? undefined,\n        defaultValue: type.$exact.$defaultValue ?? undefined\n      }];\n    } else if (\"$fixedWidth\" in type) {\n      return [{\n        type: \"fixedWidth\",\n        field,\n        fixedWidth: type.$fixedWidth\n      }];\n    } else if (\"$ranges\" in type) {\n      return [{\n        type: \"ranges\",\n        field,\n        ranges: type.$ranges.map(range => convertRange(range))\n      }];\n    } else if (\"$duration\" in type) {\n      return [{\n        type: \"duration\",\n        field,\n        value: type.$duration[0],\n        unit: DurationMapping[type.$duration[1]]\n      }];\n    } else return [];\n  });\n}\nfunction convertRange(range) {\n  return {\n    startValue: range[0],\n    endValue: range[1]\n  };\n}\n//# sourceMappingURL=modernToLegacyGroupByClause.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function resolveBaseObjectSetType(objectType) {\n  return objectType.type === \"interface\" ? {\n    type: \"interfaceBase\",\n    interfaceType: objectType[\"apiName\"]\n  } : {\n    type: \"base\",\n    objectType: objectType[\"apiName\"]\n  };\n}\n//# sourceMappingURL=objectSetUtils.js.map","/*\n * Copyright 2023 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as OntologiesV2 from \"@osdk/foundry.ontologies\";\nimport invariant from \"tiny-invariant\";\nimport { legacyToModernSingleAggregationResult } from \"../internal/conversions/legacyToModernSingleAggregationResult.js\";\nimport { modernToLegacyAggregationClause } from \"../internal/conversions/modernToLegacyAggregationClause.js\";\nimport { modernToLegacyGroupByClause } from \"../internal/conversions/modernToLegacyGroupByClause.js\";\nimport { addUserAgentAndRequestContextHeaders } from \"../util/addUserAgentAndRequestContextHeaders.js\";\nimport { resolveBaseObjectSetType } from \"../util/objectSetUtils.js\";\n\n/** @internal */\nexport async function aggregate(clientCtx, objectType, objectSet = resolveBaseObjectSetType(objectType), req) {\n  resolveBaseObjectSetType(objectType);\n  const body = {\n    aggregation: modernToLegacyAggregationClause(req.$select),\n    groupBy: [],\n    where: undefined\n  };\n  if (req.$groupBy) {\n    body.groupBy = modernToLegacyGroupByClause(req.$groupBy);\n  }\n  const result = await OntologiesV2.OntologyObjectSets.aggregate(addUserAgentAndRequestContextHeaders(clientCtx, objectType), await clientCtx.ontologyRid, {\n    objectSet,\n    groupBy: body.groupBy,\n    aggregation: body.aggregation\n  });\n  if (!req.$groupBy) {\n    !(result.data.length === 1) ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"no group by clause should mean only one data result\") : invariant(false) : void 0;\n    return {\n      ...aggregationToCountResult(result.data[0]),\n      ...legacyToModernSingleAggregationResult(result.data[0])\n    };\n  }\n  const ret = result.data.map(entry => {\n    return {\n      $group: entry.group,\n      ...aggregationToCountResult(entry),\n      ...legacyToModernSingleAggregationResult(entry)\n    };\n  }); // fixme\n\n  return ret; // FIXME\n}\nfunction aggregationToCountResult(entry) {\n  for (const aggregateResult of entry.metrics) {\n    if (aggregateResult.name === \"count\") {\n      return {\n        $count: aggregateResult.value\n      };\n    }\n  }\n}\n//# sourceMappingURL=aggregate.js.map","/*\n * Copyright 2025 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport invariant from \"tiny-invariant\";\nexport async function extractRdpDefinition(clientCtx, objectSet) {\n  return (await extractRdpDefinitionInternal(clientCtx, objectSet, undefined)).definitions;\n}\n\n/* @internal\n* Returns a tuple of the derived property definitions and the object type that the derived property is defined on.\n*/\nasync function extractRdpDefinitionInternal(clientCtx, objectSet, methodInputObjectType) {\n  switch (objectSet.type) {\n    case \"searchAround\":\n      {\n        const {\n          definitions,\n          childObjectType\n        } = await extractRdpDefinitionInternal(clientCtx, objectSet.objectSet, methodInputObjectType);\n        if (childObjectType === undefined || childObjectType === \"\") {\n          return {\n            definitions: {}\n          };\n        }\n        const objDef = await clientCtx.ontologyProvider.getObjectDefinition(childObjectType);\n        const linkDef = objDef.links[objectSet.link];\n        !linkDef ? process.env.NODE_ENV !== \"production\" ? invariant(false, `Missing link definition for '${objectSet.link}'`) : invariant(false) : void 0;\n        return {\n          definitions,\n          childObjectType: objDef.links[objectSet.link].targetType\n        };\n      }\n    case \"withProperties\":\n      {\n        // These are the definitions and current object type for all object set operations prior to the definition (e.g. filter, pivotTo, etc.)\n        const {\n          definitions,\n          childObjectType\n        } = await extractRdpDefinitionInternal(clientCtx, objectSet.objectSet, methodInputObjectType);\n        if (childObjectType === undefined || childObjectType === \"\") {\n          return {\n            definitions: {}\n          };\n        }\n        for (const [name, definition] of Object.entries(objectSet.derivedProperties)) {\n          if (definition.type !== \"selection\") {\n            continue;\n          }\n          switch (definition.operation.type) {\n            case \"collectList\":\n            case \"collectSet\":\n            case \"get\":\n              // This is the object set construction for the derived property definition construction. We pass in childObjectType so that when we reach MethodInputObjectSet, we know where to start looking.\n              const {\n                childObjectType: operationLevelObjectType\n              } = await extractRdpDefinitionInternal(clientCtx, definition.objectSet, childObjectType);\n              if (operationLevelObjectType === undefined || operationLevelObjectType === \"\") {\n                return {\n                  definitions: {}\n                };\n              }\n              const objDef = await clientCtx.ontologyProvider.getObjectDefinition(operationLevelObjectType);\n              definitions[name] = objDef.properties[definition.operation.selectedPropertyApiName];\n            default:\n              continue;\n          }\n        }\n        return {\n          definitions,\n          childObjectType\n        };\n      }\n    case \"methodInput\":\n      return {\n        definitions: {},\n        childObjectType: methodInputObjectType\n      };\n    case \"base\":\n      return {\n        definitions: {},\n        childObjectType: objectSet.objectType\n      };\n    case \"interfaceBase\":\n      return {\n        definitions: {},\n        childObjectType: objectSet.interfaceType\n      };\n    case \"filter\":\n    case \"asBaseObjectTypes\":\n    case \"asType\":\n    case \"nearestNeighbors\":\n      return extractRdpDefinitionInternal(clientCtx, objectSet.objectSet, methodInputObjectType);\n    // These will throw in OSS so we should throw here so no request is made\n    case \"intersect\":\n    case \"subtract\":\n    case \"union\":\n      const objectSets = objectSet.objectSets;\n      const objectSetTypes = await Promise.all(objectSets.map(os => extractRdpDefinitionInternal(clientCtx, os, methodInputObjectType)));\n      const definitions = objectSetTypes.reduce((acc, {\n        definitions\n      }) => ({\n        ...acc,\n        ...definitions\n      }), {});\n      !(Object.keys(definitions).length === 0) ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"Object sets combined using intersect, subtract, or union must not contain any derived property definitions\") : invariant(false) : void 0;\n      const firstValidChildObjectType = objectSetTypes.find(({\n        childObjectType\n      }) => childObjectType != null)?.childObjectType;\n      !objectSetTypes.every(({\n        childObjectType\n      }) => childObjectType === firstValidChildObjectType || childObjectType == null) ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"All object sets in an intersect, subtract, or union must have the same child object type\") : invariant(false) : void 0;\n      return {\n        definitions: {},\n        childObjectType: firstValidChildObjectType\n      };\n    case \"static\":\n    case \"reference\":\n      // Static and reference object sets are always intersected with a base object set, so we can just return no child object type.\n      return {\n        definitions: {}\n      };\n    // We don't have to worry about new object sets being added and doing a runtime break and breaking people since the OSDK is always constructing these.\n    default:\n      process.env.NODE_ENV !== \"production\" ? invariant(false, `Unsupported object set type for Runtime Derived Properties`) : invariant(false);\n  }\n}\n//# sourceMappingURL=extractRdpDefinition.js.map","/*\n * Copyright 2023 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as OntologiesV2 from \"@osdk/foundry.ontologies\";\nimport { addUserAgentAndRequestContextHeaders } from \"../util/addUserAgentAndRequestContextHeaders.js\";\nimport { extractRdpDefinition } from \"../util/extractRdpDefinition.js\";\nimport { resolveBaseObjectSetType } from \"../util/objectSetUtils.js\";\nexport function augment(type, ...properties) {\n  return {\n    [type.apiName]: properties\n  };\n}\n\n/** @internal */\nexport function objectSetToSearchJsonV2(objectSet, expectedApiName, existingWhere = undefined) {\n  if (objectSet.type === \"base\" || objectSet.type === \"interfaceBase\") {\n    if (objectSet.type === \"base\" && objectSet.objectType !== expectedApiName) {\n      throw new Error(`Expected objectSet.objectType to be ${expectedApiName}, but got ${objectSet.objectType}`);\n    }\n    if (objectSet.type === \"interfaceBase\" && objectSet.interfaceType !== expectedApiName) {\n      throw new Error(`Expected objectSet.objectType to be ${expectedApiName}, but got ${objectSet.interfaceType}`);\n    }\n    return existingWhere;\n  }\n  if (objectSet.type === \"filter\") {\n    return objectSetToSearchJsonV2(objectSet.objectSet, expectedApiName, existingWhere == null ? objectSet.where : {\n      type: \"and\",\n      value: [existingWhere, objectSet.where]\n    });\n  }\n  throw new Error(`Unsupported objectSet type: ${objectSet.type}`);\n}\n\n/** @internal */\nexport function resolveInterfaceObjectSet(objectSet, interfaceTypeApiName, args) {\n  return args?.$includeAllBaseObjectProperties ? {\n    type: \"intersect\",\n    objectSets: [objectSet, {\n      type: \"interfaceBase\",\n      interfaceType: interfaceTypeApiName,\n      includeAllBaseObjectProperties: true\n    }]\n  } : objectSet;\n}\nasync function fetchInterfacePage(client, interfaceType, args, objectSet) {\n  if (args.$__UNSTABLE_useOldInterfaceApis) {\n    const result = await OntologiesV2.OntologyInterfaces.search(addUserAgentAndRequestContextHeaders(client, interfaceType), await client.ontologyRid, interfaceType.apiName, applyFetchArgs(args, {\n      augmentedProperties: {},\n      augmentedSharedPropertyTypes: {},\n      otherInterfaceTypes: [],\n      selectedObjectTypes: [],\n      selectedSharedPropertyTypes: args.$select ?? [],\n      where: objectSetToSearchJsonV2(objectSet, interfaceType.apiName)\n    }), {\n      preview: true\n    });\n    result.data = await client.objectFactory(client, result.data,\n    // drop readonly\n    interfaceType.apiName, !args.$includeRid, await extractRdpDefinition(client, objectSet));\n    return result;\n  }\n  const result = await OntologiesV2.OntologyObjectSets.loadMultipleObjectTypes(addUserAgentAndRequestContextHeaders(client, interfaceType), await client.ontologyRid, applyFetchArgs(args, {\n    objectSet: resolveInterfaceObjectSet(objectSet, interfaceType.apiName, args),\n    select: args?.$select ?? [],\n    excludeRid: !args?.$includeRid\n  }), {\n    preview: true\n  });\n  return Promise.resolve({\n    data: await client.objectFactory2(client, result.data, interfaceType.apiName, {}, !args.$includeRid, args.$select, false, result.interfaceToObjectTypeMappings),\n    nextPageToken: result.nextPageToken,\n    totalCount: result.totalCount\n  });\n}\n\n/** @internal */\nexport async function fetchPageInternal(client, objectType, objectSet, args = {}) {\n  if (objectType.type === \"interface\") {\n    return await fetchInterfacePage(client, objectType, args, objectSet); // fixme\n  } else {\n    return await fetchObjectPage(client, objectType, args, objectSet); // fixme\n  }\n}\n\n/** @internal */\nexport async function fetchPageWithErrorsInternal(client, objectType, objectSet, args = {}) {\n  try {\n    const result = await fetchPageInternal(client, objectType, objectSet, args);\n    return {\n      value: result\n    };\n  } catch (e) {\n    if (e instanceof Error) {\n      return {\n        error: e\n      };\n    }\n    return {\n      error: e\n    };\n  }\n}\n\n/**\n * @param client\n * @param objectType\n * @param args\n * @param objectSet\n * @returns\n * @internal\n */\nexport async function fetchPage(client, objectType, args, objectSet = resolveBaseObjectSetType(objectType)) {\n  return fetchPageInternal(client, objectType, objectSet, args);\n}\n\n/** @internal */\nexport async function fetchPageWithErrors(client, objectType, args, objectSet = resolveBaseObjectSetType(objectType)) {\n  return fetchPageWithErrorsInternal(client, objectType, objectSet, args);\n}\nfunction applyFetchArgs(args, body) {\n  if (args?.$nextPageToken) {\n    body.pageToken = args.$nextPageToken;\n  }\n  if (args?.$pageSize != null) {\n    body.pageSize = args.$pageSize;\n  }\n  if (args?.$orderBy != null) {\n    body.orderBy = {\n      fields: Object.entries(args.$orderBy).map(([field, direction]) => ({\n        field,\n        direction\n      }))\n    };\n  }\n  return body;\n}\n\n/** @internal */\nexport async function fetchObjectPage(client, objectType, args, objectSet) {\n  const r = await OntologiesV2.OntologyObjectSets.load(addUserAgentAndRequestContextHeaders(client, objectType), await client.ontologyRid, applyFetchArgs(args, {\n    objectSet,\n    // We have to do the following case because LoadObjectSetRequestV2 isn't readonly\n    select: args?.$select ?? [],\n    // FIXME?\n    excludeRid: !args?.$includeRid\n  }));\n  return Promise.resolve({\n    data: await client.objectFactory(client, r.data, undefined, undefined, await extractRdpDefinition(client, objectSet), args.$select),\n    nextPageToken: r.nextPageToken,\n    totalCount: r.totalCount\n  });\n}\n//# sourceMappingURL=fetchPage.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { PalantirApiError } from \"@osdk/shared.net.errors\";\nimport { fetchPage } from \"./fetchPage.js\";\n\n/** @internal */\nexport async function fetchSingle(client, objectType, args, objectSet) {\n  const result = await fetchPage(client, objectType, {\n    ...args,\n    $pageSize: 1\n  }, objectSet);\n  if (result.data.length !== 1 || result.nextPageToken != null) {\n    throw new PalantirApiError(`Expected a single result but got ${result.data.length} instead${result.nextPageToken != null ? \" with nextPageToken set\" : \"\"}`);\n  }\n  return result.data[0];\n}\n\n/** @internal */\nexport async function fetchSingleWithErrors(client, objectType, args, objectSet) {\n  try {\n    const result = await fetchSingle(client, objectType, args, objectSet);\n    return {\n      value: result\n    };\n  } catch (e) {\n    if (e instanceof Error) {\n      return {\n        error: e\n      };\n    }\n    return {\n      error: e\n    };\n  }\n}\n//# sourceMappingURL=fetchSingle.js.map","/*\n * Copyright 2023 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst WIRE_OBJECT_SET_TYPES = new Set([\"base\", \"filter\", \"intersect\", \"reference\", \"searchAround\", \"static\", \"subtract\", \"union\"]);\n\n/** @internal */\nexport function isWireObjectSet(o) {\n  return o != null && typeof o === \"object\" && WIRE_OBJECT_SET_TYPES.has(o.type);\n}\n//# sourceMappingURL=WireObjectSet.js.map","// https://github.com/maxogden/websocket-stream/blob/48dc3ddf943e5ada668c31ccd94e9186f02fafbd/ws-fallback.js\n\nvar ws = null\n\nif (typeof WebSocket !== 'undefined') {\n  ws = WebSocket\n} else if (typeof MozWebSocket !== 'undefined') {\n  ws = MozWebSocket\n} else if (typeof global !== 'undefined') {\n  ws = global.WebSocket || global.MozWebSocket\n} else if (typeof window !== 'undefined') {\n  ws = window.WebSocket || window.MozWebSocket\n} else if (typeof self !== 'undefined') {\n  ws = self.WebSocket || self.MozWebSocket\n}\n\nexport default ws\n","/*\n * Copyright 2023 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport WebSocket from \"isomorphic-ws\";\nimport invariant from \"tiny-invariant\";\nconst MINIMUM_RECONNECT_DELAY_MS = 5 * 1000;\n\n/** Noop function to reduce conditional checks */\nfunction doNothing() {}\n\n/**\n * Converts an ObjectSetListener to one where all the functions are defined.\n */\nfunction fillOutListener({\n  onChange = doNothing,\n  onError = doNothing,\n  onOutOfDate = doNothing,\n  onSuccessfulSubscription = doNothing\n}) {\n  return {\n    onChange,\n    onError,\n    onOutOfDate,\n    onSuccessfulSubscription\n  };\n}\nfunction isReady(sub) {\n  return sub.isReady != null;\n}\nfunction subscriptionIsDone(sub) {\n  return sub.status === \"done\" || sub.status === \"error\";\n}\n\n/** @internal */\nexport class ObjectSetListenerWebsocket {\n  static #instances = new WeakMap();\n  // FIXME\n  static getInstance(client) {\n    let instance = ObjectSetListenerWebsocket.#instances.get(client.clientCacheKey);\n    if (instance == null) {\n      instance = new ObjectSetListenerWebsocket(client);\n      ObjectSetListenerWebsocket.#instances.set(client.clientCacheKey, instance);\n    }\n    return instance;\n  }\n  #ws;\n  #lastWsConnect = 0;\n  #client;\n  #logger;\n\n  /**\n   * map of requestId to all active subscriptions at the time of the request\n   */\n  #pendingSubscriptions = new Map();\n\n  /**\n   * Map of subscriptionId to Subscription. Note: the subscriptionId may be\n   * temporary and not the actual subscriptionId from the server.\n   */\n  #subscriptions = new Map();\n  #endedSubscriptions = new Set();\n  #maybeDisconnectTimeout;\n\n  // DO NOT CONSTRUCT DIRECTLY. ONLY EXPOSED AS A TESTING SEAM\n  constructor(client, {\n    minimumReconnectDelayMs = MINIMUM_RECONNECT_DELAY_MS\n  } = {}) {\n    this.MINIMUM_RECONNECT_DELAY_MS = minimumReconnectDelayMs;\n    this.#client = client;\n    this.#logger = client.logger?.child({}, {\n      msgPrefix: \"<OSW> \"\n    });\n    !(client.baseUrl.startsWith(\"https://\") || client.baseUrl.startsWith(\"http://\")) ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"Stack must be a URL\") : invariant(false) : void 0;\n  }\n  async subscribe(objectType, objectSet, listener, properties = []) {\n    const objOrInterfaceDef = objectType.type === \"object\" ? await this.#client.ontologyProvider.getObjectDefinition(objectType.apiName) : await this.#client.ontologyProvider.getInterfaceDefinition(objectType.apiName);\n    let objectProperties = [];\n    let referenceProperties = [];\n    if (properties.length === 0) {\n      properties = Object.keys(objOrInterfaceDef.properties);\n    }\n    objectProperties = properties.filter(p => objOrInterfaceDef.properties[p].type !== \"geotimeSeriesReference\");\n    referenceProperties = properties.filter(p => objOrInterfaceDef.properties[p].type === \"geotimeSeriesReference\");\n    const sub = {\n      listener: fillOutListener(listener),\n      objectSet,\n      primaryKeyPropertyName: objOrInterfaceDef.type === \"interface\" ? undefined : objOrInterfaceDef.primaryKeyApiName,\n      requestedProperties: objectProperties,\n      requestedReferenceProperties: referenceProperties,\n      status: \"preparing\",\n      // Since we don't have a real subscription id yet but we need to keep\n      // track of this reference, we can just use a random uuid.\n      subscriptionId: `TMP-${nextUuid()}}`,\n      interfaceApiName: objOrInterfaceDef.type === \"object\" ? undefined : objOrInterfaceDef.apiName\n    };\n    this.#subscriptions.set(sub.subscriptionId, sub);\n\n    // actually prepares the subscription, ensures the ws is ready, and sends\n    // a subscribe message. We don't want to block on this.\n    void this.#initiateSubscribe(sub);\n    return () => {\n      this.#unsubscribe(sub);\n    };\n  }\n\n  /**\n   * Called at least once for every subscription.\n   *\n   * - Resets pending expiry\n   * - Recreates temporary object set\n   * - Triggers a full subscribe message\n   *\n   * @returns\n   */\n  async #initiateSubscribe(sub) {\n    if (process.env.NODE_ENV !== \"production\") {\n      this.#logger?.debug(\"#initiateSubscribe()\");\n    }\n    try {\n      await this.#ensureWebsocket();\n\n      // the consumer may have already unsubscribed before we are ready to request a subscription\n      // so we have to acquire the pendingSubscription after the await.\n      if (subscriptionIsDone(sub)) {\n        return;\n      }\n      sub.isReady = true;\n      // if we aren't open, then this happens after we #onConnect\n      if (this.#ws?.readyState === WebSocket.OPEN) {\n        this.#sendSubscribeMessage();\n      }\n    } catch (error) {\n      this.#logger?.error(error, \"Error in #initiateSubscribe\");\n      this.#tryCatchOnError(sub, true, error);\n    }\n  }\n  #sendSubscribeMessage() {\n    if (process.env.NODE_ENV !== \"production\") {\n      this.#logger?.debug(\"#sendSubscribeMessage()\");\n    }\n    // If two calls to `.subscribe()` happen at once (or if the connection is reset),\n    // we may have multiple subscriptions that don't have a subscriptionId yet,\n    // so we filter those out.\n    const readySubs = [...this.#subscriptions.values()].filter(isReady);\n    const id = nextUuid();\n    // responses come back as an array of subIds, so we need to know the sources\n    this.#pendingSubscriptions.set(id, readySubs);\n\n    // every subscribe message \"overwrites\" the previous ones that are not\n    // re-included, so we have to reconstitute the entire list of subscriptions\n    const subscribe = {\n      id,\n      requests: readySubs.map(({\n        objectSet,\n        requestedProperties,\n        requestedReferenceProperties,\n        interfaceApiName\n      }) => {\n        return {\n          objectSet: objectSet,\n          propertySet: requestedProperties,\n          referenceSet: requestedReferenceProperties\n        };\n      })\n    };\n    if (process.env.NODE_ENV !== \"production\") {\n      this.#logger?.debug({\n        payload: subscribe\n      }, \"sending subscribe message\");\n    }\n    this.#ws?.send(JSON.stringify(subscribe));\n  }\n  #unsubscribe(sub, newStatus = \"done\") {\n    if (subscriptionIsDone(sub)) {\n      // if we are already done, we don't need to do anything\n      return;\n    }\n    sub.status = newStatus;\n\n    // make sure listeners do nothing now\n    sub.listener = fillOutListener({});\n    this.#subscriptions.delete(sub.subscriptionId);\n    this.#endedSubscriptions.add(sub.subscriptionId);\n    this.#sendSubscribeMessage();\n\n    // If we have no more subscriptions, we can disconnect the websocket\n    // however we should wait a bit to see if we get any more subscriptions.\n    // For example, when switching between react views, you may unsubscribe\n    // in the old view and subscribe in the new view. We don't need to re-establish\n    // the websocket connection in that case.\n    if (this.#maybeDisconnectTimeout) {\n      // We reset the timeout on every unsubscribe so its always at least 15s from\n      // the last time we are empty. E.g.:\n      //   - 0s: Subscribe(A)\n      //   - 10s: Unsubscribe(A)\n      //   - 11s: Subscribe(B)\n      //   - 20s: Unsubscribe(B)\n      // If we do not clear out the timeout we would disconnect at 25s but that would only be\n      // 5s after the last subscription was removed instead of at 35s for the desired 15s.\n      clearTimeout(this.#maybeDisconnectTimeout);\n    }\n    this.#maybeDisconnectTimeout = setTimeout(() => {\n      this.#maybeDisconnectTimeout = undefined;\n      if (this.#subscriptions.size === 0) {\n        this.#cycleWebsocket();\n      }\n    }, 15_000 /* ms */);\n  }\n  async #ensureWebsocket() {\n    if (this.#ws == null) {\n      const {\n        baseUrl,\n        tokenProvider\n      } = this.#client;\n      const url = constructWebsocketUrl(baseUrl, await this.#client.ontologyRid);\n      const token = await tokenProvider();\n\n      // tokenProvider is async, there could potentially be a race to create the websocket.\n      // Only the first call to reach here will find a null this.#ws, the rest will bail out\n      if (this.#ws == null) {\n        // TODO this can probably be exponential backoff with jitter\n        // don't reconnect more quickly than MINIMUM_RECONNECT_DELAY\n        const nextConnectTime = (this.#lastWsConnect ?? 0) + this.MINIMUM_RECONNECT_DELAY_MS;\n        if (nextConnectTime > Date.now()) {\n          await new Promise(resolve => {\n            setTimeout(resolve, nextConnectTime - Date.now());\n          });\n        }\n        this.#lastWsConnect = Date.now();\n\n        // we again may have lost the race after our minimum backoff time\n        if (this.#ws == null) {\n          if (process.env.NODE_ENV !== \"production\") {\n            this.#logger?.debug(\"Creating websocket\");\n          }\n          this.#ws = new WebSocket(url, [`Bearer-${token}`]);\n          this.#ws.addEventListener(\"close\", this.#onClose);\n          this.#ws.addEventListener(\"message\", this.#onMessage);\n          this.#ws.addEventListener(\"open\", this.#onOpen);\n        }\n      }\n      // Allow await-ing the websocket open event if it isn't open already.\n      // This needs to happen even for callers that didn't just create this.#ws\n      if (this.#ws.readyState === WebSocket.CONNECTING) {\n        const ws = this.#ws;\n        return new Promise((resolve, reject) => {\n          function cleanup() {\n            ws.removeEventListener(\"open\", open);\n            ws.removeEventListener(\"error\", error);\n            ws.removeEventListener(\"close\", cleanup);\n          }\n          function open() {\n            cleanup();\n            resolve();\n          }\n          function error(evt) {\n            cleanup();\n            reject(evt);\n          }\n          ws.addEventListener(\"open\", open);\n          ws.addEventListener(\"error\", error);\n          ws.addEventListener(\"close\", cleanup);\n        });\n      }\n    }\n  }\n  #onOpen = () => {\n    // resubscribe all of the listeners\n    this.#sendSubscribeMessage();\n  };\n  #onMessage = async message => {\n    const data = JSON.parse(message.data.toString());\n    if (process.env.NODE_ENV !== \"production\") {\n      this.#logger?.debug({\n        payload: data\n      }, \"received message from ws\");\n    }\n    switch (data.type) {\n      case \"objectSetChanged\":\n        await this.#handleMessage_objectSetChanged(data);\n        return;\n      case \"refreshObjectSet\":\n        this.#handleMessage_refreshObjectSet(data);\n        return;\n      case \"subscribeResponses\":\n        this.#handleMessage_subscribeResponses(data);\n        return;\n      case \"subscriptionClosed\":\n        {\n          this.#handleMessage_subscriptionClosed(data);\n          return;\n        }\n      default:\n        process.env.NODE_ENV !== \"production\" ? invariant(false, \"Unexpected message type\") : invariant(false);\n    }\n  };\n  #handleMessage_objectSetChanged = async payload => {\n    const sub = this.#subscriptions.get(payload.id);\n    if (sub == null) return;\n    const objectUpdates = payload.updates.filter(update => update.type === \"object\");\n    const referenceUpdates = payload.updates.filter(update => update.type === \"reference\");\n    const osdkObjectsWithReferenceUpdates = await Promise.all(referenceUpdates.map(async o => {\n      const osdkObjectArray = await this.#client.objectFactory2(this.#client, [{\n        __apiName: o.objectType,\n        __primaryKey: sub.primaryKeyPropertyName != null ? o.primaryKey[sub.primaryKeyPropertyName] : undefined,\n        ...o.primaryKey,\n        [o.property]: o.value\n      }], sub.interfaceApiName, {}, false, undefined, false, await this.#fetchInterfaceMapping(o.objectType, sub.interfaceApiName));\n      const singleOsdkObject = osdkObjectArray[0] ?? undefined;\n      return singleOsdkObject != null ? {\n        object: singleOsdkObject,\n        state: \"ADDED_OR_UPDATED\"\n      } : undefined;\n    }));\n    for (const update of osdkObjectsWithReferenceUpdates) {\n      if (update != null) {\n        try {\n          sub.listener.onChange?.(update);\n        } catch (error) {\n          this.#logger?.error(error, \"Error in onChange callback\");\n          this.#tryCatchOnError(sub, false, error);\n        }\n      }\n    }\n    const osdkObjects = await Promise.all(objectUpdates.map(async o => {\n      const keysToDelete = Object.keys(o.object).filter(key => sub.requestedReferenceProperties.includes(key));\n      for (const key of keysToDelete) {\n        delete o.object[key];\n      }\n      const osdkObjectArray = await this.#client.objectFactory2(this.#client, [o.object], sub.interfaceApiName, {}, false, undefined, false, await this.#fetchInterfaceMapping(o.object.__apiName, sub.interfaceApiName));\n      const singleOsdkObject = osdkObjectArray[0] ?? undefined;\n      return singleOsdkObject != null ? {\n        object: singleOsdkObject,\n        state: o.state\n      } : undefined;\n    }));\n    for (const osdkObject of osdkObjects) {\n      if (osdkObject != null) {\n        try {\n          sub.listener.onChange?.(osdkObject);\n        } catch (error) {\n          this.#logger?.error(error, \"Error in onChange callback\");\n          this.#tryCatchOnError(sub, false, error);\n        }\n      }\n    }\n  };\n  async #fetchInterfaceMapping(objectTypeApiName, interfaceApiName) {\n    if (interfaceApiName == null) return {};\n    const interfaceMap = (await this.#client.ontologyProvider.getObjectDefinition(objectTypeApiName)).interfaceMap;\n    return {\n      [interfaceApiName]: {\n        [objectTypeApiName]: interfaceMap[interfaceApiName]\n      }\n    };\n  }\n  #handleMessage_refreshObjectSet = payload => {\n    const sub = this.#subscriptions.get(payload.id);\n    !sub ? process.env.NODE_ENV !== \"production\" ? invariant(false, `Expected subscription id ${payload.id}`) : invariant(false) : void 0;\n    try {\n      sub.listener.onOutOfDate();\n    } catch (error) {\n      this.#logger?.error(error, \"Error in onOutOfDate callback\");\n      this.#tryCatchOnError(sub, false, error);\n    }\n  };\n  #handleMessage_subscribeResponses = payload => {\n    const {\n      id,\n      responses\n    } = payload;\n    const subs = this.#pendingSubscriptions.get(id);\n    !subs ? process.env.NODE_ENV !== \"production\" ? invariant(false, `should have a pending subscription for ${id}`) : invariant(false) : void 0;\n    this.#pendingSubscriptions.delete(id);\n    for (let i = 0; i < responses.length; i++) {\n      const sub = subs[i];\n      const response = responses[i];\n      switch (response.type) {\n        case \"error\":\n          this.#tryCatchOnError(sub, true, response.errors);\n          this.#unsubscribe(sub, \"error\");\n          break;\n        case \"qos\":\n          // the server has requested that we tear down our websocket and reconnect to help load balance\n          this.#cycleWebsocket();\n          break;\n        case \"success\":\n          // `\"preparing\"` should only be the status on an initial subscribe.\n          const shouldFireOutOfDate = sub.status === \"expired\" || sub.status === \"reconnecting\";\n          if (process.env.NODE_ENV !== \"production\") {\n            this.#logger?.debug({\n              shouldFireOutOfDate\n            }, \"success\");\n          }\n          sub.status = \"subscribed\";\n          if (sub.subscriptionId !== response.id) {\n            // might be the temporary one\n            this.#subscriptions.delete(sub.subscriptionId);\n            sub.subscriptionId = response.id;\n            this.#subscriptions.set(sub.subscriptionId, sub); // future messages come by this subId\n          }\n          try {\n            if (shouldFireOutOfDate) sub.listener.onOutOfDate();else sub.listener.onSuccessfulSubscription();\n          } catch (error) {\n            this.#logger?.error(error, \"Error in onOutOfDate or onSuccessfulSubscription callback\");\n            this.#tryCatchOnError(sub, false, error);\n          }\n          break;\n        default:\n          this.#tryCatchOnError(sub, true, response);\n      }\n    }\n  };\n  #handleMessage_subscriptionClosed(payload) {\n    const sub = this.#subscriptions.get(payload.id);\n    if (sub == null && this.#endedSubscriptions.has(payload.id)) return;\n    !sub ? process.env.NODE_ENV !== \"production\" ? invariant(false, `Expected subscription id ${payload.id}`) : invariant(false) : void 0;\n    this.#tryCatchOnError(sub, true, payload.cause);\n    this.#unsubscribe(sub, \"error\");\n  }\n  #onClose = event => {\n    if (process.env.NODE_ENV !== \"production\") {\n      this.#logger?.debug({\n        event\n      }, \"Received close event from ws\", event);\n    }\n    // TODO we should probably throttle this so we don't abuse the backend\n    this.#cycleWebsocket();\n  };\n  #cycleWebsocket = () => {\n    if (this.#ws) {\n      this.#ws.removeEventListener(\"open\", this.#onOpen);\n      this.#ws.removeEventListener(\"message\", this.#onMessage);\n      this.#ws.removeEventListener(\"close\", this.#onClose);\n      if (this.#ws.readyState !== WebSocket.CLOSING && this.#ws.readyState !== WebSocket.CLOSED) {\n        this.#ws.close();\n      }\n      this.#ws = undefined;\n    }\n\n    // if we have any listeners that are still depending on us, go ahead and reopen the websocket\n    if (this.#subscriptions.size > 0) {\n      if (process.env.NODE_ENV !== \"production\") {\n        for (const s of this.#subscriptions.values()) {\n          !(s.status !== \"done\" && s.status !== \"error\") ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"should not have done/error subscriptions still\") : invariant(false) : void 0;\n        }\n      }\n      for (const s of this.#subscriptions.values()) {\n        if (s.status === \"subscribed\") s.status = \"reconnecting\";\n      }\n\n      // we don't care about the result of this (we want cycleWebsocket to be fire and forget)\n      // just that it happens\n      void this.#ensureWebsocket();\n    }\n  };\n  #tryCatchOnError = (sub, subscriptionClosed, error) => {\n    try {\n      sub.listener.onError({\n        subscriptionClosed: subscriptionClosed,\n        error\n      });\n    } catch (onErrorError) {\n      // eslint-disable-next-line no-console\n      console.error(`Error encountered in an onError callback for an OSDK subscription`, onErrorError);\n      // eslint-disable-next-line no-console\n      console.error(`This onError call was triggered by an error in another callback`, error);\n      // eslint-disable-next-line no-console\n      console.error(`The subscription has been closed.`, error);\n      if (!subscriptionClosed) {\n        this.#logger?.error(error, \"Error in onError callback\");\n        this.#unsubscribe(sub, \"error\");\n        this.#tryCatchOnError(sub, true, onErrorError);\n      }\n    }\n  };\n}\n\n/** @internal */\nexport function constructWebsocketUrl(baseUrl, ontologyRid) {\n  const base = new URL(baseUrl);\n  const url = new URL(`api/v2/ontologySubscriptions/ontologies/${ontologyRid}/streamSubscriptions`, base);\n  url.protocol = url.protocol.replace(\"https\", \"wss\");\n  return url;\n}\nlet uuidCounter = 0;\nfunction nextUuid() {\n  return `00000000-0000-0000-0000-${(uuidCounter++).toString().padStart(12, \"0\")}`;\n}\n//# sourceMappingURL=ObjectSetListenerWebsocket.js.map","/*\n * Copyright 2023 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createWithPropertiesObjectSet } from \"../derivedProperties/createWithPropertiesObjectSet.js\";\nimport { modernToLegacyWhereClause } from \"../internal/conversions/modernToLegacyWhereClause.js\";\nimport { aggregate } from \"../object/aggregate.js\";\nimport { fetchPageInternal, fetchPageWithErrorsInternal } from \"../object/fetchPage.js\";\nimport { fetchSingle, fetchSingleWithErrors } from \"../object/fetchSingle.js\";\nimport { augmentRequestContext } from \"../util/augmentRequestContext.js\";\nimport { resolveBaseObjectSetType } from \"../util/objectSetUtils.js\";\nimport { isWireObjectSet } from \"../util/WireObjectSet.js\";\nimport { ObjectSetListenerWebsocket } from \"./ObjectSetListenerWebsocket.js\";\nfunction isObjectTypeDefinition(def) {\n  return def.type === \"object\";\n}\n\n/* @internal */\nexport function isObjectSet(o) {\n  return o != null && typeof o === \"object\" && isWireObjectSet(objectSetDefinitions.get(o));\n}\n\n/** @internal */\nexport function getWireObjectSet(objectSet) {\n  return objectSetDefinitions.get(objectSet);\n}\nconst objectSetDefinitions = new WeakMap();\n\n/** @internal */\nexport function createObjectSet(objectType, clientCtx, objectSet = resolveBaseObjectSetType(objectType)) {\n  const base = {\n    aggregate: aggregate.bind(globalThis, augmentRequestContext(clientCtx, () => ({\n      finalMethodCall: \"aggregate\"\n    })), objectType, objectSet),\n    fetchPage: fetchPageInternal.bind(globalThis, augmentRequestContext(clientCtx, () => ({\n      finalMethodCall: \"fetchPage\"\n    })), objectType, objectSet),\n    fetchPageWithErrors: fetchPageWithErrorsInternal.bind(globalThis, augmentRequestContext(clientCtx, () => ({\n      finalMethodCall: \"fetchPageWithErrors\"\n    })), objectType, objectSet),\n    where: clause => {\n      return clientCtx.objectSetFactory(objectType, clientCtx, {\n        type: \"filter\",\n        objectSet: objectSet,\n        where: modernToLegacyWhereClause(clause, objectType)\n      });\n    },\n    pivotTo: function (type) {\n      return createSearchAround(type)();\n    },\n    union: (...objectSets) => {\n      return clientCtx.objectSetFactory(objectType, clientCtx, {\n        type: \"union\",\n        objectSets: [objectSet, ...objectSets.map(os => objectSetDefinitions.get(os))]\n      });\n    },\n    intersect: (...objectSets) => {\n      return clientCtx.objectSetFactory(objectType, clientCtx, {\n        type: \"intersect\",\n        objectSets: [objectSet, ...objectSets.map(os => objectSetDefinitions.get(os))]\n      });\n    },\n    subtract: (...objectSets) => {\n      return clientCtx.objectSetFactory(objectType, clientCtx, {\n        type: \"subtract\",\n        objectSets: [objectSet, ...objectSets.map(os => objectSetDefinitions.get(os))]\n      });\n    },\n    asyncIter: async function* (args) {\n      let $nextPageToken = undefined;\n      do {\n        const result = await fetchPageInternal(augmentRequestContext(clientCtx, () => ({\n          finalMethodCall: \"asyncIter\"\n        })), objectType, objectSet, {\n          ...args,\n          $pageSize: 10000,\n          $nextPageToken\n        });\n        $nextPageToken = result.nextPageToken;\n        for (const obj of result.data) {\n          yield obj;\n        }\n      } while ($nextPageToken != null);\n    },\n    fetchOne: isObjectTypeDefinition(objectType) ? async (primaryKey, options) => {\n      return await fetchSingle(augmentRequestContext(clientCtx, () => ({\n        finalMethodCall: \"fetchOne\"\n      })), objectType, options, await createWithPk(clientCtx, objectType, objectSet, primaryKey));\n    } : undefined,\n    fetchOneWithErrors: isObjectTypeDefinition(objectType) ? async (primaryKey, options) => {\n      return await fetchSingleWithErrors(augmentRequestContext(clientCtx, () => ({\n        finalMethodCall: \"fetchOneWithErrors\"\n      })), objectType, options, await createWithPk(clientCtx, objectType, objectSet, primaryKey));\n    } : undefined,\n    subscribe: (listener, opts) => {\n      const pendingSubscribe = ObjectSetListenerWebsocket.getInstance(clientCtx).subscribe(objectType, objectSet, listener, opts?.properties);\n      return {\n        unsubscribe: async () => (await pendingSubscribe)()\n      };\n    },\n    withProperties: clause => {\n      const definitionMap = new Map();\n      const derivedProperties = {};\n      for (const key of Object.keys(clause)) {\n        const derivedPropertyDefinition = clause[key](createWithPropertiesObjectSet(objectType, {\n          type: \"methodInput\"\n        }, definitionMap, true));\n        derivedProperties[key] = definitionMap.get(derivedPropertyDefinition);\n      }\n      return clientCtx.objectSetFactory(objectType, clientCtx, {\n        type: \"withProperties\",\n        derivedProperties: derivedProperties,\n        objectSet: objectSet\n      });\n    },\n    $objectSetInternals: {\n      def: objectType\n    }\n  };\n  function createSearchAround(link) {\n    return () => {\n      return clientCtx.objectSetFactory(objectType, clientCtx, {\n        type: \"searchAround\",\n        objectSet,\n        link\n      });\n    };\n  }\n  objectSetDefinitions.set(base, objectSet);\n\n  // we are using a type assertion because the marker symbol defined in BaseObjectSet isn't actually used\n  // at runtime.\n  return base;\n}\nasync function createWithPk(clientCtx, objectType, objectSet, primaryKey) {\n  const objDef = await clientCtx.ontologyProvider.getObjectDefinition(objectType.apiName);\n  const withPk = {\n    type: \"filter\",\n    objectSet: objectSet,\n    where: {\n      type: \"eq\",\n      field: objDef.primaryKeyApiName,\n      value: primaryKey\n    }\n  };\n  return withPk;\n}\n//# sourceMappingURL=createObjectSet.js.map","/*\n * Copyright 2025 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** @internal */\nexport function isInterfaceActionParam(o) {\n  return o != null && typeof o === \"object\" && \"$objectType\" in o && \"$primaryKey\" in o;\n}\n//# sourceMappingURL=interfaceUtils.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function isObjectSpecifiersObject(o) {\n  return o && typeof o === \"object\" && typeof o.$apiName === \"string\" && o.$primaryKey != null;\n}\n//# sourceMappingURL=isObjectSpecifiersObject.js.map","/*\n * Copyright 2023 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** @internal */\nexport function isOntologyObjectV2(o) {\n  return o && typeof o === \"object\" && typeof o.__apiName === \"string\" && o.__primaryKey != null;\n}\n//# sourceMappingURL=isOntologyObjectV2.js.map","/*\n * Copyright 2025 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function isPoint(o) {\n  return o && typeof o === \"object\" && \"type\" in o && o.type === \"Point\" && \"coordinates\" in o && o.coordinates.length === 2;\n}\n//# sourceMappingURL=isPoint.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as OntologiesV2 from \"@osdk/foundry.ontologies\";\nimport { isAttachmentFile, isAttachmentUpload } from \"../object/AttachmentUpload.js\";\nimport { isMediaReference } from \"../object/mediaUpload.js\";\nimport { getWireObjectSet, isObjectSet } from \"../objectSet/createObjectSet.js\";\nimport { isInterfaceActionParam } from \"./interfaceUtils.js\";\nimport { isObjectSpecifiersObject } from \"./isObjectSpecifiersObject.js\";\nimport { isOntologyObjectV2 } from \"./isOntologyObjectV2.js\";\nimport { isPoint } from \"./isPoint.js\";\nimport { isWireObjectSet } from \"./WireObjectSet.js\";\n\n/**\n * Marshall user-facing data into the wire DataValue type\n *\n * @see DataValue for the expected payloads\n * @internal\n */\nexport async function toDataValue(value, client) {\n  if (value == null) {\n    // typeof null is 'object' so do this first\n    return value;\n  }\n\n  // arrays and sets are both sent over the wire as arrays\n  if (Array.isArray(value) || value instanceof Set) {\n    const values = Array.from(value);\n    if (values.some(dataValue => isAttachmentUpload(dataValue) || isAttachmentFile(dataValue))) {\n      const converted = [];\n      for (const value of values) {\n        converted.push(await toDataValue(value, client));\n      }\n      return converted;\n    }\n    const promiseArray = Array.from(value, async innerValue => await toDataValue(innerValue, client));\n    return Promise.all(promiseArray);\n  }\n\n  // For uploads, we need to upload ourselves first to get the RID of the attachment\n  if (isAttachmentUpload(value)) {\n    const attachment = await OntologiesV2.Attachments.upload(client, value.data, {\n      filename: value.name\n    });\n    return await toDataValue(attachment.rid, client);\n  }\n  if (isAttachmentFile(value)) {\n    const attachment = await OntologiesV2.Attachments.upload(client, value, {\n      filename: value.name\n    });\n    return await toDataValue(attachment.rid, client);\n  }\n\n  // objects just send the JSON'd primaryKey\n  if (isOntologyObjectV2(value)) {\n    return await toDataValue(value.__primaryKey, client);\n  }\n  if (isObjectSpecifiersObject(value)) {\n    return await toDataValue(value.$primaryKey, client);\n  }\n  if (isPoint(value)) {\n    return await toDataValue(value.coordinates.join(), client);\n  }\n\n  // object set (the rid as a string (passes through the last return), or the ObjectSet definition directly)\n  if (isWireObjectSet(value)) {\n    return value;\n  }\n  if (isObjectSet(value)) {\n    return getWireObjectSet(value);\n  }\n  if (isMediaReference(value)) {\n    return value;\n  }\n  if (isInterfaceActionParam(value)) {\n    return {\n      objectTypeApiName: value.$objectType,\n      primaryKeyValue: value.$primaryKey\n    };\n  }\n\n  // TODO (during queries implementation)\n  // two dimensional aggregation\n  // three dimensional aggregation\n\n  // struct\n  if (typeof value === \"object\") {\n    return Object.entries(value).reduce(async (promisedAcc, [key, structValue]) => {\n      const acc = await promisedAcc;\n      acc[key] = await toDataValue(structValue, client);\n      return acc;\n    }, Promise.resolve({}));\n  }\n\n  // expected to pass through - boolean, byte, date, decimal, float, double, integer, long, short, string, timestamp, object type reference\n  return value;\n}\n//# sourceMappingURL=toDataValue.js.map","/*\n * Copyright 2023 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as OntologiesV2 from \"@osdk/foundry.ontologies\";\nimport { addUserAgentAndRequestContextHeaders } from \"../util/addUserAgentAndRequestContextHeaders.js\";\nimport { augmentRequestContext } from \"../util/augmentRequestContext.js\";\nimport { toDataValue } from \"../util/toDataValue.js\";\nimport { ActionValidationError } from \"./ActionValidationError.js\";\nexport async function applyAction(client, action, parameters, options = {}) {\n  const clientWithHeaders = addUserAgentAndRequestContextHeaders(augmentRequestContext(client, () => ({\n    finalMethodCall: \"applyAction\"\n  })), action);\n  if (Array.isArray(parameters)) {\n    const response = await OntologiesV2.Actions.applyBatch(clientWithHeaders, await client.ontologyRid, action.apiName, {\n      requests: parameters ? await remapBatchActionParams(parameters, client) : [],\n      options: {\n        returnEdits: options?.$returnEdits ? \"ALL\" : \"NONE\"\n      }\n    });\n    const edits = response.edits;\n    return options?.$returnEdits ? edits?.type === \"edits\" ? remapActionResponse(response) : edits : undefined;\n  } else {\n    const response = await OntologiesV2.Actions.apply(clientWithHeaders, await client.ontologyRid, action.apiName, {\n      parameters: await remapActionParams(parameters, client),\n      options: {\n        mode: options?.$validateOnly ? \"VALIDATE_ONLY\" : \"VALIDATE_AND_EXECUTE\",\n        returnEdits: options?.$returnEdits ? \"ALL_V2_WITH_DELETIONS\" : \"NONE\"\n      }\n    });\n    if (options?.$validateOnly) {\n      return response.validation;\n    }\n    if (response.validation?.result === \"INVALID\") {\n      throw new ActionValidationError(response.validation);\n    }\n    const edits = response.edits;\n    return options?.$returnEdits ? edits?.type === \"edits\" ? remapActionResponse(response) : edits : undefined;\n  }\n}\nasync function remapActionParams(params, client) {\n  if (params == null) {\n    return {};\n  }\n  const parameterMap = {};\n  for (const [key, value] of Object.entries(params)) {\n    parameterMap[key] = await toDataValue(value, client);\n  }\n  return parameterMap;\n}\nasync function remapBatchActionParams(params, client) {\n  const remappedParams = await Promise.all(params.map(async param => {\n    return {\n      parameters: await remapActionParams(param, client)\n    };\n  }));\n  return remappedParams;\n}\nexport function remapActionResponse(response) {\n  const editResponses = response?.edits;\n  if (editResponses?.type === \"edits\") {\n    const remappedActionResponse = {\n      type: editResponses.type,\n      deletedLinksCount: editResponses.deletedLinksCount,\n      deletedObjectsCount: editResponses.deletedObjectsCount,\n      addedLinks: [],\n      deletedLinks: [],\n      addedObjects: [],\n      deletedObjects: [],\n      modifiedObjects: [],\n      editedObjectTypes: []\n    };\n    const editedObjectTypesSet = new Set();\n    for (const edit of editResponses.edits) {\n      if (edit.type === \"addLink\" || edit.type === \"deleteLink\") {\n        const osdkEdit = {\n          linkTypeApiNameAtoB: edit.linkTypeApiNameAtoB,\n          linkTypeApiNameBtoA: edit.linkTypeApiNameBtoA,\n          aSideObject: edit.aSideObject,\n          bSideObject: edit.bSideObject\n        };\n        edit.type === \"addLink\" ? remappedActionResponse.addedLinks.push(osdkEdit) : remappedActionResponse.deletedLinks?.push(osdkEdit);\n        editedObjectTypesSet.add(edit.aSideObject.objectType);\n        editedObjectTypesSet.add(edit.bSideObject.objectType);\n      } else if (edit.type === \"addObject\" || edit.type === \"deleteObject\" || edit.type === \"modifyObject\") {\n        const osdkEdit = {\n          objectType: edit.objectType,\n          primaryKey: edit.primaryKey\n        };\n        if (edit.type === \"addObject\") {\n          remappedActionResponse.addedObjects.push(osdkEdit);\n        } else if (edit.type === \"deleteObject\") {\n          remappedActionResponse.deletedObjects?.push(osdkEdit);\n        } else if (edit.type === \"modifyObject\") {\n          remappedActionResponse.modifiedObjects.push(osdkEdit);\n        }\n        editedObjectTypesSet.add(edit.objectType);\n      } else {\n        if (process.env.NODE_ENV !== \"production\") {\n          // eslint-disable-next-line no-console\n          console.warn(`Unexpected edit type: ${JSON.stringify(edit)}`);\n        }\n      }\n    }\n    remappedActionResponse.editedObjectTypes = [...editedObjectTypesSet];\n    return remappedActionResponse;\n  }\n}\n//# sourceMappingURL=applyAction.js.map","/*\n * Copyright 2023 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// eslint-disable-next-line @typescript-eslint/consistent-type-imports\n\n// DO NOT EXPORT FROM PACKAGE\n/** @internal */\nexport const additionalContext = Symbol(\"additionalContext\");\n\n// BEGIN: THIS IS GENERATED CODE. DO NOT EDIT.\nconst MaxOsdkVersion = \"2.3.0\";\n// END: THIS IS GENERATED CODE. DO NOT EDIT.\n\nconst ErrorMessage = Symbol(\"ErrorMessage\");\n//# sourceMappingURL=Client.js.map","/*\n * Copyright 2023 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { PalantirApiError } from \"@osdk/shared.net.errors\";\nimport { createFetchHeaderMutator, createFetchOrThrow, createRetryingFetch } from \"@osdk/shared.net.fetch\";\n\n// eslint-disable-next-line @typescript-eslint/consistent-type-imports\n\nexport function createSharedClientContext(baseUrl, tokenProvider, userAgent, fetchFn = fetch) {\n  if (baseUrl.length === 0) {\n    throw new Error(\"baseUrl cannot be empty\");\n  }\n  const retryingFetchWithAuthOrThrow = createFetchHeaderMutator(createRetryingFetch(createFetchOrThrow(fetchFn)), async headers => {\n    const token = await tokenProvider();\n    headers.set(\"Authorization\", `Bearer ${token}`);\n    headers.set(\"Fetch-User-Agent\", [headers.get(\"Fetch-User-Agent\"), userAgent].filter(x => x && x?.length > 0).join(\" \"));\n    return headers;\n  });\n\n  // because this is async await it preserves stack traces, which the retrying fetch does not\n\n  return {\n    baseUrl,\n    fetch: async (input, init) => {\n      try {\n        return await retryingFetchWithAuthOrThrow(input, init);\n      } catch (e) {\n        const betterError = e instanceof PalantirApiError ? new PalantirApiError(e.message, e.errorName, e.errorCode, e.statusCode, e.errorInstanceId, e.parameters) : new Error(\"Captured stack trace for error: \" + (e.message ?? e));\n        betterError.cause = e;\n        throw betterError;\n      }\n    },\n    tokenProvider\n  };\n}\n//# sourceMappingURL=createSharedClientContext.js.map","/*\n * Copyright 2023 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst START_TOKEN = new Uint8Array([123, 34, 100, 97, 116, 97, 34, 58, 91]); // `{\"data\":[`\nconst OBJECT_OPEN_CHAR_CODE = 123; // '{'\nconst OBJECT_CLOSE_CHAR_CODE = 125; // '}'\n\nexport async function* parseStreamedResponse(asyncIterable) {\n  const utf8decoder = new TextDecoder(\"utf-8\");\n  let parsedStart = false;\n  let prevChunks = [];\n  let openBracesCount = 0;\n  for await (let chunk of asyncIterable) {\n    // on the first chunk, skip the expected START_TOKEN if we see it\n    let i = 0;\n    if (!parsedStart) {\n      parsedStart = true;\n      if (startsWith(chunk, START_TOKEN)) {\n        i = START_TOKEN.length;\n      }\n    }\n    for (; i < chunk.length; i++) {\n      // if we aren't currently parsing an object, skip until we find the next object start\n      while (openBracesCount === 0 && chunk[i] !== OBJECT_OPEN_CHAR_CODE && i < chunk.length) {\n        i++;\n      }\n\n      // iterate through the chunk looking for the end of the current top level object\n      let j = i;\n      for (; j < chunk.length; j++) {\n        const c = chunk[j];\n        if (c === OBJECT_OPEN_CHAR_CODE) {\n          openBracesCount++;\n        } else if (c === OBJECT_CLOSE_CHAR_CODE) {\n          openBracesCount--;\n\n          // found a complete top level object, emit it\n          if (0 === openBracesCount) {\n            yield combineAndParse(utf8decoder, prevChunks, chunk.subarray(i, j + 1));\n\n            // if there was a prevChunk, we've consumed it now\n            prevChunks = [];\n\n            // advance the start index to the final '}' of the current object,\n            // which lets us start seeking the beginning of the next object\n            i = j;\n            break;\n          }\n        }\n      }\n\n      // if we reached the end of our chunk before finding the end of the object\n      // store off the relevant remainder of our current chunk and go grab the next one\n      if (j === chunk.length) {\n        prevChunks.push(chunk.subarray(i));\n        break;\n      }\n    }\n  }\n}\nfunction startsWith(a, b) {\n  if (a.length < b.length) {\n    return false;\n  }\n  for (let i = 0; i < b.length; i++) {\n    if (a[i] !== b[i]) {\n      return false;\n    }\n  }\n  return true;\n}\nfunction combineAndParse(utf8decoder, prev, curr) {\n  let str = \"\";\n  for (const chunk of prev) {\n    str += utf8decoder.decode(chunk, {\n      stream: true\n    });\n  }\n  str += utf8decoder.decode(curr);\n  return JSON.parse(str);\n}\nexport async function* iterateReadableStream(readableStream) {\n  let res = await readableStream.read();\n  while (!res.done) {\n    yield res.value;\n    res = await readableStream.read();\n  }\n}\n//# sourceMappingURL=streamutils.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { TimeseriesDurationMapping } from \"@osdk/api\";\nimport { iterateReadableStream, parseStreamedResponse } from \"./streamutils.js\";\nexport function getTimeRange(body) {\n  if (\"$startTime\" in body || \"$endTime\" in body) {\n    return {\n      type: \"absolute\",\n      startTime: body.$startTime,\n      endTime: body.$endTime\n    };\n  }\n  return body.$before ? {\n    type: \"relative\",\n    startTime: {\n      when: \"BEFORE\",\n      value: body.$before,\n      unit: TimeseriesDurationMapping[body.$unit]\n    }\n  } : {\n    type: \"relative\",\n    endTime: {\n      when: \"AFTER\",\n      value: body.$after,\n      unit: TimeseriesDurationMapping[body.$unit]\n    }\n  };\n}\nexport async function* asyncIterPointsHelper(iterator) {\n  const reader = iterator.body?.getReader();\n  for await (const point of parseStreamedResponse(iterateReadableStream(reader))) {\n    yield {\n      time: point.time,\n      value: point.value\n    };\n  }\n}\n//# sourceMappingURL=timeseriesUtils.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as OntologiesV2 from \"@osdk/foundry.ontologies\";\nimport { asyncIterPointsHelper, getTimeRange } from \"./util/timeseriesUtils.js\";\nexport class GeotimeSeriesPropertyImpl {\n  #triplet;\n  #client;\n  constructor(client, objectApiName, primaryKey, propertyName, initialValue) {\n    this.#client = client;\n    this.#triplet = [objectApiName, primaryKey, propertyName];\n    if (initialValue != null) {\n      this.lastFetchedValue = initialValue;\n    }\n  }\n  async getLatestValue() {\n    const latestPointPromise = OntologiesV2.TimeSeriesValueBankProperties.getLatestValue(this.#client, await this.#client.ontologyRid, ...this.#triplet);\n    latestPointPromise.then(latestPoint => this.lastFetchedValue = latestPoint,\n    // eslint-disable-next-line no-console\n    err => void console.error(err));\n    return latestPointPromise;\n  }\n  async getAllValues(query) {\n    const allPoints = [];\n    for await (const point of this.asyncIterValues(query)) {\n      allPoints.push(point);\n    }\n    return allPoints;\n  }\n  async *asyncIterValues(query) {\n    const streamPointsIterator = await OntologiesV2.TimeSeriesValueBankProperties.streamValues(this.#client, await this.#client.ontologyRid, ...this.#triplet, query ? {\n      range: getTimeRange(query)\n    } : {});\n    for await (const timeseriesPoint of asyncIterPointsHelper(streamPointsIterator)) {\n      yield timeseriesPoint;\n    }\n  }\n}\n//# sourceMappingURL=createGeotimeSeriesProperty.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as OntologiesV2 from \"@osdk/foundry.ontologies\";\nexport class MediaReferencePropertyImpl {\n  #triplet;\n  #client;\n  constructor(args) {\n    const {\n      client,\n      objectApiName,\n      primaryKey,\n      propertyName\n    } = args;\n    this.#client = client;\n    this.#triplet = [objectApiName, primaryKey, propertyName];\n  }\n  async fetchContents() {\n    return OntologiesV2.MediaReferenceProperties.getMediaContent(this.#client, await this.#client.ontologyRid, ...this.#triplet, {\n      preview: true // TODO: Can turn this back off when backend is no longer in beta.\n    });\n  }\n  async fetchMetadata() {\n    const r = await OntologiesV2.MediaReferenceProperties.getMediaMetadata(this.#client, await this.#client.ontologyRid, ...this.#triplet, {\n      preview: true // TODO: Can turn this back off when backend is no longer in beta.\n    });\n    return {\n      path: r.path,\n      sizeBytes: Number(r.sizeBytes),\n      mediaType: r.mediaType\n    };\n  }\n}\n//# sourceMappingURL=createMediaReferenceProperty.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as OntologiesV2 from \"@osdk/foundry.ontologies\";\nimport { asyncIterPointsHelper, getTimeRange } from \"./util/timeseriesUtils.js\";\nexport class TimeSeriesPropertyImpl {\n  #triplet;\n  #client;\n  constructor(client, objectApiName, primaryKey, propertyName) {\n    this.#client = client;\n    this.#triplet = [objectApiName, primaryKey, propertyName];\n  }\n  async getFirstPoint() {\n    return OntologiesV2.TimeSeriesPropertiesV2.getFirstPoint(this.#client, await this.#client.ontologyRid, ...this.#triplet);\n  }\n  async getLastPoint() {\n    return OntologiesV2.TimeSeriesPropertiesV2.getLastPoint(this.#client, await this.#client.ontologyRid, ...this.#triplet);\n  }\n  async getAllPoints(query) {\n    const allPoints = [];\n    for await (const point of this.asyncIterPoints(query)) {\n      allPoints.push(point);\n    }\n    return allPoints;\n  }\n  async *asyncIterPoints(query) {\n    const streamPointsIterator = await OntologiesV2.TimeSeriesPropertiesV2.streamPoints(this.#client, await this.#client.ontologyRid, ...this.#triplet, query ? {\n      range: getTimeRange(query)\n    } : {});\n    for await (const timeseriesPoint of asyncIterPointsHelper(streamPointsIterator)) {\n      yield timeseriesPoint;\n    }\n  }\n}\n//# sourceMappingURL=createTimeseriesProperty.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as OntologiesV2 from \"@osdk/foundry.ontologies\";\nimport { additionalContext } from \"../Client.js\";\n/**\n * Helper function to create an attachment type from a rid\n * @param client -  An OSDK client.\n * @param rid - The rid of attachment in Foundry.\n * @returns An OSDK attachment object\n */\nexport function hydrateAttachmentFromRid(client, rid) {\n  return hydrateAttachmentFromRidInternal(client[additionalContext], rid);\n}\n\n/** @internal */\nexport function hydrateAttachmentFromRidInternal(client, rid) {\n  return {\n    rid,\n    async fetchContents() {\n      return OntologiesV2.Attachments.read(client, rid);\n    },\n    async fetchMetadata() {\n      const r = await OntologiesV2.Attachments.get(client, rid);\n      return {\n        ...r,\n        sizeBytes: Number(r.sizeBytes)\n      };\n    }\n  };\n}\n//# sourceMappingURL=hydrateAttachmentFromRid.js.map","/*\n * Copyright 2025 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Creates an Object Specifier. An ObjectSpecifier is a string that uniquely identifies an object in the system,\n * even when loading an interface object where primary key uniqueness is not guaranteed.\n *\n * @param objectDef - An Object Type Definition\n * @param primaryKey - The value you want to use as the primary key\n * @returns An Object Specifier\n */\nexport function createObjectSpecifierFromPrimaryKey(objectDef, primaryKey) {\n  return `${objectDef.apiName}:${primaryKey}`;\n}\n\n/**\n * Extracts the primary key from an ObjectSpecifier on an OSDK object.\n *\n * @param ObjectSpecifier\n * @returns A string representing the primary key\n */\nexport function extractPrimaryKeyFromObjectSpecifier(ObjectSpecifier) {\n  return ObjectSpecifier.split(\":\")[1];\n}\n\n/**\n * Extracts the object type from an ObjectSpecifier on an OSDK object.\n *\n * @param ObjectSpecifier\n * @returns The object type extracted from the ObjectSpecifier\n */\nexport function extractObjectTypeFromObjectSpecifier(ObjectSpecifier) {\n  return ObjectSpecifier.split(\":\")[0];\n}\n//# sourceMappingURL=objectSpecifierUtils.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const InterfaceDefinitions = Symbol(\"InterfaceDefinitions\");\n//# sourceMappingURL=OntologyProvider.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** @internal */\nexport const UnderlyingOsdkObject = Symbol(\"Underlying Object\");\n\n/** @internal */\nexport const ObjectDefRef = Symbol(\"ObjectDefinition\");\n\n/** @internal */\nexport const InterfaceDefRef = Symbol(\"InterfaceDefinition\");\n\n/** @internal */\nexport const ClientRef = Symbol(\"ClientRef\");\n//# sourceMappingURL=InternalSymbols.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { extractNamespace } from \"../../internal/conversions/modernToLegacyWhereClause.js\";\nimport { InterfaceDefRef, ObjectDefRef, UnderlyingOsdkObject } from \"./InternalSymbols.js\";\n/** @internal */\nexport function createOsdkInterface(underlying, interfaceDef) {\n  const [objApiNamespace] = extractNamespace(interfaceDef.apiName);\n  return Object.freeze(Object.defineProperties({}, {\n    // first to minimize hidden classes\n    [UnderlyingOsdkObject]: {\n      value: underlying\n    },\n    \"$apiName\": {\n      value: interfaceDef.apiName,\n      enumerable: true\n    },\n    \"$as\": {\n      value: underlying.$as,\n      enumerable: false\n    },\n    \"$objectType\": {\n      value: underlying.$objectType,\n      enumerable: \"$objectType\" in underlying\n    },\n    \"$primaryKey\": {\n      value: underlying.$primaryKey,\n      enumerable: \"$primaryKey\" in underlying\n    },\n    \"$objectSpecifier\": {\n      value: underlying.$objectSpecifier,\n      enumerable: \"$objectSpecifier\" in underlying\n    },\n    \"$title\": {\n      value: underlying.$title,\n      enumerable: \"$title\" in underlying\n    },\n    \"$rid\": {\n      value: underlying.$rid,\n      enumerable: \"$rid\" in underlying\n    },\n    \"$clone\": {\n      value: clone,\n      enumerable: false\n    },\n    [InterfaceDefRef]: {\n      value: interfaceDef\n    },\n    ...Object.fromEntries(Object.keys(interfaceDef.properties).map(p => {\n      const objDef = underlying[ObjectDefRef];\n      const [apiNamespace, apiName] = extractNamespace(p);\n      const targetPropName = objDef.interfaceMap[interfaceDef.apiName][p];\n      return [apiNamespace === objApiNamespace ? apiName : p, {\n        enumerable: targetPropName in underlying,\n        value: underlying[targetPropName]\n      }];\n    }))\n  }));\n  function clone(update) {\n    if (update == null) {\n      return underlying.$clone().$as(interfaceDef);\n    }\n    for (const key of Object.keys(update)) {\n      if (!(key in interfaceDef.properties)) {\n        throw new Error(`Invalid property ${key} for interface ${interfaceDef.apiName}`);\n      }\n    }\n    const remappedProps = Object.fromEntries(Object.keys(update).map(p => mapProperty(p, update[p])).filter(x => x != null));\n    return underlying.$clone(remappedProps).$as(interfaceDef);\n  }\n  function mapProperty(propertyName, value) {\n    const objDef = underlying[ObjectDefRef];\n    const targetPropName = objDef.interfaceMap[interfaceDef.apiName][propertyName];\n    // If the underlying object does not implement the SPT, throw errors\n    if (targetPropName == null) {\n      throw new Error(`Cannot clone interface with ${propertyName} as property is not implemented by the underlying object type ${objDef.apiName}`);\n    }\n    return [targetPropName, value];\n  }\n}\n//# sourceMappingURL=createOsdkInterface.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { InterfaceDefinitions } from \"../../ontology/OntologyProvider.js\";\nimport { createSimpleCache } from \"../SimpleCache.js\";\nimport { createOsdkInterface } from \"./createOsdkInterface.js\";\nimport { UnderlyingOsdkObject } from \"./InternalSymbols.js\";\n\n/** @internal */\n\nexport const get$as = createSimpleCache(new WeakMap(), $asFactory).get;\nconst osdkObjectToInterfaceView = createSimpleCache(new WeakMap(), () => new Map());\nfunction $asFactory(objDef) {\n  // We use the exact same logic for both the interface rep and the underlying rep\n\n  return function (targetMinDef) {\n    let targetInterfaceApiName;\n    if (typeof targetMinDef === \"string\") {\n      if (targetMinDef === objDef.apiName) {\n        return this[UnderlyingOsdkObject];\n      }\n\n      // this is sufficient to determine if we implement the interface\n      if (objDef.interfaceMap?.[targetMinDef] == null) {\n        throw new Error(`Object does not implement interface '${targetMinDef}'.`);\n      }\n      targetInterfaceApiName = targetMinDef;\n    } else if (targetMinDef.apiName === objDef.apiName) {\n      return this[UnderlyingOsdkObject];\n    } else {\n      if (targetMinDef.type === \"object\") {\n        throw new Error(`'${targetMinDef.apiName}' is not an interface nor is it '${objDef.apiName}', which is the object type.`);\n      }\n      targetInterfaceApiName = targetMinDef.apiName;\n    }\n    const def = objDef[InterfaceDefinitions][targetInterfaceApiName];\n    if (!def) {\n      throw new Error(`Object does not implement interface '${targetInterfaceApiName}'.`);\n    }\n    const underlying = this[UnderlyingOsdkObject];\n    const existing = osdkObjectToInterfaceView.get(underlying).get(targetInterfaceApiName)?.deref();\n    if (existing) return existing;\n    const osdkInterface = createOsdkInterface(underlying, def.def);\n    osdkObjectToInterfaceView.get(underlying).set(targetInterfaceApiName, new WeakRef(osdkInterface));\n    return osdkInterface;\n  };\n}\n//# sourceMappingURL=getDollarAs.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getWireObjectSet } from \"../../objectSet/createObjectSet.js\";\nimport { fetchSingle, fetchSingleWithErrors } from \"../fetchSingle.js\";\nimport { ClientRef, ObjectDefRef, UnderlyingOsdkObject } from \"./InternalSymbols.js\";\n/** @internal */\nexport function get$link(holder) {\n  const client = holder[ClientRef];\n  const objDef = holder[ObjectDefRef];\n  const rawObj = holder[UnderlyingOsdkObject];\n  return Object.freeze(Object.fromEntries(Object.keys(objDef.links).map(linkName => {\n    const linkDef = objDef.links[linkName];\n    const objectSet = client.objectSetFactory(objDef, client).where({\n      [objDef.primaryKeyApiName]: rawObj.$primaryKey\n    }).pivotTo(linkName);\n    const value = !linkDef.multiplicity ? {\n      fetchOne: options => fetchSingle(client, objDef, options ?? {}, getWireObjectSet(objectSet)),\n      fetchOneWithErrors: options => fetchSingleWithErrors(client, objDef, options ?? {}, getWireObjectSet(objectSet))\n    } : objectSet;\n    return [linkName, value];\n  })));\n}\n//# sourceMappingURL=getDollarLink.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport invariant from \"tiny-invariant\";\nimport { GeotimeSeriesPropertyImpl } from \"../../createGeotimeSeriesProperty.js\";\nimport { MediaReferencePropertyImpl } from \"../../createMediaReferenceProperty.js\";\nimport { TimeSeriesPropertyImpl } from \"../../createTimeseriesProperty.js\";\nimport { hydrateAttachmentFromRidInternal } from \"../../public-utils/hydrateAttachmentFromRid.js\";\nimport { createObjectSpecifierFromPrimaryKey } from \"../../util/objectSpecifierUtils.js\";\nimport { get$as } from \"./getDollarAs.js\";\nimport { get$link } from \"./getDollarLink.js\";\nimport { ClientRef, ObjectDefRef, UnderlyingOsdkObject } from \"./InternalSymbols.js\";\nconst specialPropertyTypes = new Set([\"attachment\", \"geotimeSeriesReference\", \"mediaReference\", \"numericTimeseries\", \"stringTimeseries\", \"sensorTimeseries\"]);\n\n// kept separate so we are not redefining these functions\n// every time an object is created.\nconst basePropDefs = {\n  \"$as\": {\n    get: function () {\n      return get$as(this[ObjectDefRef]);\n    }\n  },\n  \"$link\": {\n    get: function () {\n      return get$link(this);\n    }\n  },\n  \"$clone\": {\n    value: function (update) {\n      // I think `rawObj` is the same thing as `this` and can be removed?\n      const rawObj = this[UnderlyingOsdkObject];\n      const def = this[ObjectDefRef];\n      if (update == null) {\n        return createOsdkObject(this[ClientRef], def, {\n          ...rawObj\n        });\n      }\n      if (def.primaryKeyApiName in update && rawObj[def.primaryKeyApiName] !== update[def.primaryKeyApiName]) {\n        throw new Error(`Cannot update ${def.apiName} object with differing primary key values `);\n      }\n      if (def.titleProperty in update && !(\"$title\" in update)) {\n        update.$title = update[def.titleProperty];\n      }\n      const newObject = {\n        ...this[UnderlyingOsdkObject],\n        ...update\n      };\n      return createOsdkObject(this[ClientRef], this[ObjectDefRef], newObject);\n    }\n  },\n  \"$objectSpecifier\": {\n    get: function () {\n      const rawObj = this[UnderlyingOsdkObject];\n      return createObjectSpecifierFromPrimaryKey(this[ObjectDefRef], rawObj.$primaryKey);\n    },\n    enumerable: true\n  }\n};\n\n/**\n * @internal\n * @param client\n * @param objectDef\n * @param simpleOsdkProperties\n */\nexport function createOsdkObject(client, objectDef, simpleOsdkProperties, derivedPropertyTypeByName = {}) {\n  // updates the object's \"hidden class/map\".\n  const rawObj = simpleOsdkProperties;\n  Object.defineProperties(rawObj, {\n    [UnderlyingOsdkObject]: {\n      enumerable: false,\n      value: simpleOsdkProperties\n    },\n    [ObjectDefRef]: {\n      value: objectDef,\n      enumerable: false\n    },\n    [ClientRef]: {\n      value: client,\n      enumerable: false\n    },\n    ...basePropDefs\n  });\n\n  // Assign the special values\n  for (const propKey of Object.keys(rawObj)) {\n    if (propKey in objectDef.properties && typeof objectDef.properties[propKey].type === \"string\" && specialPropertyTypes.has(objectDef.properties[propKey].type)) {\n      rawObj[propKey] = createSpecialProperty(client, objectDef, rawObj, propKey);\n    } else if (propKey in derivedPropertyTypeByName && typeof derivedPropertyTypeByName[propKey].type === \"string\" && specialPropertyTypes.has(derivedPropertyTypeByName[propKey].type)) {\n      const rawValue = rawObj[propKey];\n      if (derivedPropertyTypeByName[propKey].type === \"attachment\") {\n        if (Array.isArray(rawValue)) {\n          rawObj[propKey] = rawValue.map(a => hydrateAttachmentFromRidInternal(client, a.rid));\n        } else {\n          rawObj[propKey] = hydrateAttachmentFromRidInternal(client, rawValue.rid);\n        }\n      } else {\n        process.env.NODE_ENV !== \"production\" ? invariant(false, \"Derived property aggregations for Timeseries and Media are not supported\") : invariant(false);\n      }\n    }\n  }\n  return Object.freeze(rawObj);\n}\nfunction createSpecialProperty(client, objectDef, rawObject, p) {\n  const rawValue = rawObject[p];\n  const propDef = objectDef.properties[p];\n  if (process.env.NODE_ENV !== \"production\") {\n    !(propDef != null && typeof propDef.type === \"string\" && specialPropertyTypes.has(propDef.type)) ? process.env.NODE_ENV !== \"production\" ? invariant(false) : invariant(false) : void 0;\n  }\n  if (propDef.type === \"attachment\") {\n    if (Array.isArray(rawValue)) {\n      return rawValue.map(a => hydrateAttachmentFromRidInternal(client, a.rid));\n    }\n    return hydrateAttachmentFromRidInternal(client, rawValue.rid);\n  }\n  if (propDef.type === \"numericTimeseries\" || propDef.type === \"stringTimeseries\" || propDef.type === \"sensorTimeseries\") {\n    return new TimeSeriesPropertyImpl(client, objectDef.apiName, rawObject[objectDef.primaryKeyApiName], p);\n  }\n  if (propDef.type === \"geotimeSeriesReference\") {\n    return new GeotimeSeriesPropertyImpl(client, objectDef.apiName, rawObject[objectDef.primaryKeyApiName], p, rawValue.type === \"geotimeSeriesValue\" ? {\n      time: rawValue.timestamp,\n      value: {\n        type: \"Point\",\n        coordinates: rawValue.position\n      }\n    } : undefined);\n  }\n  if (propDef.type === \"mediaReference\") {\n    return new MediaReferencePropertyImpl({\n      client,\n      objectApiName: objectDef.apiName,\n      primaryKey: rawObject[objectDef.primaryKeyApiName],\n      propertyName: p\n    });\n  }\n}\n//# sourceMappingURL=createOsdkObject.js.map","/*\n * Copyright 2023 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport invariant from \"tiny-invariant\";\nimport { createOsdkObject } from \"./convertWireToOsdkObjects/createOsdkObject.js\";\n/**\n * If interfaceApiName is not undefined, converts the instances of the\n * interface into their respective\n * underlying concrete types and then returns the $as() representation\n * for the consumers.\n *\n * Otherwise just does the conversion\n *\n * May mutate in place for performance reasons. If you need a clean copy,\n * keep it first.\n *\n * However, you must use the returned value, which will be whatever is correct.\n *\n * @internal\n * @param interfaceApiName - if undefined\n */\nexport async function convertWireToOsdkObjects(client, objects, interfaceApiName, forceRemoveRid = false, derivedPropertyTypesByName, selectedProps, strictNonNull = false) {\n  // remove the __ prefixed properties and convert them to $ prefixed.\n  // updates in place\n  fixObjectPropertiesInPlace(objects, forceRemoveRid);\n  const ifaceDef = interfaceApiName ? await client.ontologyProvider.getInterfaceDefinition(interfaceApiName) : undefined;\n  const ifaceSelected = ifaceDef ? selectedProps ?? Object.keys(ifaceDef.properties) : undefined;\n  const ret = [];\n  for (const rawObj of objects) {\n    const objectDef = await client.ontologyProvider.getObjectDefinition(rawObj.$apiName);\n    !objectDef ? process.env.NODE_ENV !== \"production\" ? invariant(false, `Missing definition for '${rawObj.$apiName}'`) : invariant(false) : void 0;\n\n    // default value for when we are checking an object\n    let objProps;\n    let conforming = true;\n    if (ifaceDef && ifaceSelected) {\n      // API returns interface spt names but we cache by real values\n      invariantInterfacesAsViews(objectDef, ifaceDef.apiName, client);\n      conforming &&= isConforming(client, ifaceDef, rawObj, ifaceSelected);\n      reframeAsObjectInPlace(objectDef, ifaceDef.apiName, rawObj);\n      objProps = convertInterfacePropNamesToObjectPropNames(objectDef, ifaceDef.apiName, ifaceSelected);\n    } else {\n      objProps = selectedProps ?? Object.keys(objectDef.properties);\n    }\n    conforming &&= isConforming(client, objectDef, rawObj, objProps);\n    if (strictNonNull === \"throw\" && !conforming) {\n      throw new Error(\"Unable to safely convert objects as some non nullable properties are null\");\n    } else if (strictNonNull === \"drop\" && !conforming) {\n      continue;\n    }\n    let osdkObject = createOsdkObject(client, objectDef, rawObj, derivedPropertyTypesByName);\n    if (interfaceApiName) osdkObject = osdkObject.$as(interfaceApiName);\n    ret.push(osdkObject);\n  }\n  return ret;\n}\n/**\n * @internal\n */\nexport async function convertWireToOsdkObjects2(client, objects, interfaceApiName, derivedPropertyTypeByName, forceRemoveRid = false, selectedProps, strictNonNull = false, interfaceToObjectTypeMappings = {}) {\n  fixObjectPropertiesInPlace(objects, forceRemoveRid);\n  const ret = [];\n  for (const rawObj of objects) {\n    const objectDef = await client.ontologyProvider.getObjectDefinition(rawObj.$apiName);\n    !objectDef ? process.env.NODE_ENV !== \"production\" ? invariant(false, `Missing definition for '${rawObj.$apiName}'`) : invariant(false) : void 0;\n    const interfaceToObjMapping = interfaceApiName ? interfaceToObjectTypeMappings[interfaceApiName][rawObj.$apiName] : undefined;\n    const ifaceSelected = interfaceApiName && interfaceToObjMapping ? selectedProps ? Object.keys(interfaceToObjMapping).filter(val => {\n      selectedProps?.includes(interfaceToObjMapping[val]);\n    }) : [...Object.values(interfaceToObjMapping), objectDef.primaryKeyApiName] : undefined;\n\n    // default value for when we are checking an object\n    let objProps;\n    let conforming = true;\n    if (interfaceApiName && ifaceSelected) {\n      invariantInterfacesAsViews(objectDef, interfaceApiName, client);\n      objProps = ifaceSelected;\n    } else {\n      objProps = selectedProps ?? Object.keys(objectDef.properties);\n    }\n    conforming &&= isConforming(client, objectDef, rawObj, objProps);\n    if (strictNonNull === \"throw\" && !conforming) {\n      throw new Error(\"Unable to safely convert objects as some non nullable properties are null\");\n    } else if (strictNonNull === \"drop\" && !conforming) {\n      continue;\n    }\n    let osdkObject = createOsdkObject(client, objectDef, rawObj, derivedPropertyTypeByName);\n    if (interfaceApiName) osdkObject = osdkObject.$as(interfaceApiName);\n    ret.push(osdkObject);\n  }\n  return ret;\n}\n\n/**\n * @internal\n *\n * Utility function that lets us take down selected property names from an interface\n * and convert them to an array of property names on an object.\n */\nexport function convertInterfacePropNamesToObjectPropNames(objectDef, interfaceApiName, ifacePropsToMap) {\n  return ifacePropsToMap.map(ifaceProp => objectDef.interfaceMap[interfaceApiName][ifaceProp]);\n}\n\n/**\n * Takes a raw object from the wire (contextually as an interface) and\n * updates the fields to reflect the underlying objectDef instead\n * @param objectDef\n * @param interfaceApiName\n * @param client\n * @param rawObj\n */\nfunction reframeAsObjectInPlace(objectDef, interfaceApiName, rawObj) {\n  const newProps = {};\n  for (const [sptProp, regularProp] of Object.entries(objectDef.interfaceMap[interfaceApiName])) {\n    if (sptProp in rawObj) {\n      const value = rawObj[sptProp];\n      delete rawObj[sptProp];\n      if (value !== undefined) {\n        newProps[regularProp] = value;\n      }\n    }\n  }\n  Object.assign(rawObj, newProps);\n  if (!(objectDef.primaryKeyApiName in rawObj)) {\n    rawObj[objectDef.primaryKeyApiName] = rawObj.$primaryKey;\n  }\n}\nfunction isConforming(client, def, obj, propsToCheck) {\n  for (const propName of propsToCheck) {\n    if (propName in def.properties && def.properties[propName].nullable === false && obj[propName] == null) {\n      if (process.env.NODE_ENV !== \"production\") {\n        client.logger?.debug({\n          obj: {\n            $apiName: obj[\"$apiName\"],\n            $objectType: obj[\"$objectType\"],\n            $primaryKey: obj[\"$primaryKey\"]\n          }\n        }, `Found object that does not conform to its definition. Expected ${def.apiName}'s ${propName} to not be null.`);\n      }\n      return false;\n    }\n  }\n  return true;\n}\nfunction invariantInterfacesAsViews(objectDef, interfaceApiName, client) {\n  if (objectDef.interfaceMap?.[interfaceApiName] == null) {\n    const warning = \"Interfaces are only supported 'as views' but your metadata object is missing the correct information. This suggests your interfaces have not been migrated to the newer version yet and you cannot use this version of the SDK.\";\n    if (client.logger) {\n      client.logger.warn(warning);\n    } else {\n      // eslint-disable-next-line no-console\n      console.error(`WARNING! ${warning}`);\n    }\n    throw new Error(warning);\n  }\n}\nfunction fixObjectPropertiesInPlace(objs, forceRemoveRid) {\n  for (const obj of objs) {\n    if (forceRemoveRid) {\n      delete obj.__rid;\n    }\n    if (obj.__rid) {\n      obj.$rid = obj.__rid;\n      delete obj.__rid;\n    }\n\n    // Backend returns as __apiName but we want to stick to $ structure\n    obj.$apiName ??= obj.__apiName;\n\n    // for now these are the same but when we start doing interface projections the $objectType will always be underlying and\n    // the $apiName will be for the current view (in current designs)\n    obj.$objectType = obj.$apiName;\n\n    // copying over for now as its always returned. In the future, this should just be inferred from underlying\n    obj.$primaryKey ??= obj.__primaryKey;\n    obj.$title ??= obj.__title;\n\n    // we don't want people to use these\n    delete obj.__apiName;\n    delete obj.__primaryKey;\n    delete obj.__title;\n  }\n}\n//# sourceMappingURL=convertWireToOsdkObjects.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * A simple cache that can be used to store values for a given client.\n */\n\n/**\n * @internal\n * A simple async cache that can be used to store values for a given client.\n */\n\n/** @internal */\n\n/**\n * @internal\n * Create a new cache without a factory function.\n */\n\n/**\n * @internal\n * Create a new cache with a factory function.\n * @param fn A factory function that will be used to create the value if it does not exist in the cache.\n */\n\nexport function createClientCache(fn) {\n  const cache = new WeakMap();\n  function set(client, key, value) {\n    if (cache.get(client.clientCacheKey) == null) {\n      cache.set(client.clientCacheKey, new Map());\n    }\n    cache.get(client.clientCacheKey).set(key, value);\n    return value;\n  }\n  return {\n    get: function (client, key) {\n      if (cache.get(client.clientCacheKey) == null) {\n        cache.set(client.clientCacheKey, new Map());\n      }\n      let r = cache.get(client.clientCacheKey).get(key);\n      if (r === undefined && fn !== undefined) {\n        return set(client, key, fn(client, key));\n      } else {\n        return r;\n      }\n    },\n    set,\n    remove: function (client, key) {\n      if (cache.get(client.clientCacheKey) == null) return false;\n      return cache.get(client.clientCacheKey).delete(key);\n    }\n  };\n}\n\n/** @internal */\n\n/**\n * @internal\n * Create a new cache with an async factory function.\n * @param fn A factory function that will be used to create the value if it does not exist in the cache.\n * @returns\n */\nexport function createAsyncClientCache(fn, createCacheLocal = createClientCache) {\n  const cache = createCacheLocal();\n  const inProgress = createCacheLocal();\n  const ret = {\n    getOrUndefined: function (client, key) {\n      return cache.get(client, key);\n    },\n    get: async function (client, key) {\n      return cache.get(client, key) ?? inProgress.get(client, key) ?? ret.set(client, key, fn(client, key));\n    },\n    set: async function (client, k, v) {\n      // the `.set` happens first to prevent races.\n      try {\n        const r = await inProgress.set(client, k, v); // returns v\n\n        cache.set(client, k, r);\n        inProgress.remove(client, k);\n        return r;\n      } catch (e) {\n        // we don't want to cache failures\n        inProgress.remove(client, k);\n        throw e;\n      }\n    }\n  };\n  return ret;\n}\n//# sourceMappingURL=Cache.js.map","/*\n * Copyright 2023 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function wirePropertyV2ToSdkPropertyDefinition(input, isNullable = true, log) {\n  const sdkPropDefinition = objectPropertyTypeToSdkPropertyDefinition(input.dataType, log);\n  if (sdkPropDefinition == null) {\n    return undefined;\n  }\n  switch (input.dataType.type) {\n    case \"integer\":\n    case \"string\":\n    case \"byte\":\n    case \"decimal\":\n    case \"double\":\n    case \"float\":\n    case \"long\":\n    case \"short\":\n    case \"boolean\":\n    case \"date\":\n    case \"attachment\":\n    case \"mediaReference\":\n    case \"geopoint\":\n    case \"geoshape\":\n    case \"timestamp\":\n    case \"timeseries\":\n    case \"marking\":\n    case \"geotimeSeriesReference\":\n    case \"struct\":\n      return {\n        displayName: input.displayName,\n        multiplicity: false,\n        description: input.description,\n        type: sdkPropDefinition,\n        nullable: input.nullable == null ? isNullable : input.nullable\n      };\n    case \"array\":\n      {\n        return {\n          displayName: input.displayName,\n          multiplicity: true,\n          description: input.description,\n          type: sdkPropDefinition,\n          nullable: true\n        };\n      }\n    case \"cipherText\":\n    case \"vector\":\n      {\n        log?.info(`${JSON.stringify(input.dataType.type)} is not a supported dataType`);\n        return undefined;\n      }\n    default:\n      input.dataType;\n      log?.info(`${JSON.stringify(input.dataType)} is not a supported dataType`);\n      return undefined;\n  }\n}\nfunction objectPropertyTypeToSdkPropertyDefinition(propertyType, log) {\n  switch (propertyType.type) {\n    case \"integer\":\n    case \"string\":\n    case \"byte\":\n    case \"decimal\":\n    case \"double\":\n    case \"float\":\n    case \"long\":\n    case \"short\":\n    case \"boolean\":\n    case \"attachment\":\n    case \"geopoint\":\n    case \"geoshape\":\n    case \"timestamp\":\n    case \"marking\":\n    case \"geotimeSeriesReference\":\n    case \"mediaReference\":\n      return propertyType.type;\n    case \"date\":\n      return \"datetime\";\n    case \"array\":\n      return objectPropertyTypeToSdkPropertyDefinition(propertyType.subType);\n    case \"timeseries\":\n      if (propertyType.itemType?.type === \"string\") {\n        return \"stringTimeseries\";\n      } else if (propertyType.itemType?.type === \"double\") {\n        return \"numericTimeseries\";\n      } else return \"sensorTimeseries\";\n    case \"struct\":\n      {\n        return propertyType.structFieldTypes.reduce((structMap, structField) => {\n          structMap[structField.apiName] = objectPropertyTypeToSdkPropertyDefinition(structField.dataType);\n          return structMap;\n        }, {});\n      }\n    case \"cipherText\":\n    case \"vector\":\n      {\n        log?.info(`${JSON.stringify(propertyType.type)} is not a supported propertyType`);\n        return undefined;\n      }\n    default:\n      {\n        log?.info(`${JSON.stringify(propertyType)} is not a supported propertyType`);\n        return undefined;\n      }\n  }\n}\n//# sourceMappingURL=wirePropertyV2ToSdkPropertyDefinition.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { wirePropertyV2ToSdkPropertyDefinition } from \"./wirePropertyV2ToSdkPropertyDefinition.js\";\nexport function __UNSTABLE_wireInterfaceTypeV2ToSdkObjectDefinition(interfaceType, v2, log) {\n  return {\n    type: \"interface\",\n    rid: interfaceType.rid,\n    apiName: interfaceType.apiName,\n    displayName: interfaceType.displayName,\n    description: interfaceType.description,\n    implements: interfaceType.allExtendsInterfaces ?? interfaceType.extendsInterfaces,\n    properties: Object.fromEntries(Object.entries(interfaceType.allProperties ?? interfaceType.properties).map(([key, value]) => {\n      return [key, wirePropertyV2ToSdkPropertyDefinition(value, true, log)];\n    }).filter(([key, value]) => value != null)),\n    links: {},\n    implementedBy: interfaceType.implementedByObjectTypes\n  };\n}\n//# sourceMappingURL=__UNSTABLE_wireInterfaceTypeV2ToSdkObjectDefinition.js.map","/*\n * Copyright 2023 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function getModifiedEntityTypes(action) {\n  const addedObjects = new Set();\n  const modifiedObjects = new Set();\n  for (const operation of action.operations) {\n    switch (operation.type) {\n      case \"createObject\":\n        addedObjects.add(operation.objectTypeApiName);\n        break;\n      case \"modifyObject\":\n        modifiedObjects.add(operation.objectTypeApiName);\n        break;\n      case \"deleteObject\":\n      case \"createLink\":\n      case \"deleteLink\":\n      case \"createInterfaceObject\":\n      case \"modifyInterfaceObject\":\n      case \"deleteInterfaceObject\":\n        break;\n      default:\n    }\n  }\n  return {\n    addedObjects,\n    modifiedObjects\n  };\n}\n//# sourceMappingURL=getEditedEntities.js.map","/*\n * Copyright 2023 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getModifiedEntityTypes } from \"./getEditedEntities.js\";\nexport function wireActionTypeV2ToSdkActionMetadata(input) {\n  const modifiedEntityTypes = getModifiedEntityTypes(input);\n  return {\n    type: \"action\",\n    apiName: input.apiName,\n    parameters: Object.fromEntries(Object.entries(input.parameters).map(([key, value]) => [key, wireActionParameterV2ToSdkParameterDefinition(value)])),\n    displayName: input.displayName,\n    description: input.description,\n    modifiedEntities: createModifiedEntities(modifiedEntityTypes.addedObjects, modifiedEntityTypes.modifiedObjects),\n    rid: input.rid,\n    status: input.status\n  };\n}\nfunction wireActionParameterV2ToSdkParameterDefinition(value) {\n  return {\n    multiplicity: value.dataType.type === \"array\",\n    type: actionPropertyToSdkPropertyDefinition(value.dataType.type === \"array\" ? value.dataType.subType : value.dataType),\n    nullable: !value.required,\n    description: value.description\n  };\n}\nfunction actionPropertyToSdkPropertyDefinition(parameterType) {\n  switch (parameterType.type) {\n    case \"string\":\n    case \"boolean\":\n    case \"attachment\":\n    case \"double\":\n    case \"integer\":\n    case \"long\":\n    case \"timestamp\":\n    case \"mediaReference\":\n    case \"marking\":\n    case \"objectType\":\n    case \"geohash\":\n    case \"geoshape\":\n      return parameterType.type;\n    case \"date\":\n      return \"datetime\";\n    case \"objectSet\":\n      return {\n        type: \"objectSet\",\n        objectSet: parameterType.objectTypeApiName\n      };\n    case \"object\":\n      return {\n        type: \"object\",\n        object: parameterType.objectTypeApiName\n      };\n    case \"array\":\n      return actionPropertyToSdkPropertyDefinition(parameterType.subType);\n    case \"interfaceObject\":\n      return {\n        type: \"interface\",\n        interface: parameterType.interfaceTypeApiName\n      };\n    case \"struct\":\n      return {\n        type: \"struct\",\n        struct: parameterType.fields.reduce((structMap, structField) => {\n          structMap[structField.name] = actionPropertyToSdkPropertyDefinition(structField.fieldType);\n          return structMap;\n        }, {})\n      };\n    default:\n      throw new Error(`Unsupported action parameter type: ${JSON.stringify(parameterType)}`);\n  }\n}\nfunction createModifiedEntities(addedObjects, modifiedObjects) {\n  const entities = {};\n  for (const key of addedObjects) {\n    entities[key] = {\n      created: true,\n      modified: false\n    };\n  }\n  for (const key of modifiedObjects) {\n    if (entities[key]) {\n      entities[key].modified = true;\n    } else {\n      entities[key] = {\n        created: false,\n        modified: true\n      };\n    }\n  }\n  return entities;\n}\n//# sourceMappingURL=wireActionTypeV2ToSdkActionMetadata.js.map","/*\n * Copyright 2023 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function wirePropertyV2ToSdkPrimaryKeyTypeDefinition(input) {\n  switch (input.dataType.type) {\n    case \"integer\":\n    case \"double\":\n    case \"string\":\n    case \"byte\":\n    case \"long\":\n    case \"short\":\n    case \"timestamp\":\n      {\n        return input.dataType.type;\n      }\n    case \"date\":\n      {\n        return \"datetime\";\n      }\n    case \"boolean\":\n    case \"geopoint\":\n    case \"geoshape\":\n    case \"decimal\":\n    case \"attachment\":\n    case \"timeseries\":\n    case \"array\":\n    case \"marking\":\n    case \"float\":\n    case \"geotimeSeriesReference\":\n    case \"mediaReference\":\n    case \"struct\":\n    case \"cipherText\":\n    case \"vector\":\n      throw new Error(`Primary key of type ${input.dataType.type} is not supported`);\n    default:\n      input.dataType;\n      throw new Error(`Unknown type encountered for primaryKey: ${input.dataType}`);\n  }\n}\n//# sourceMappingURL=wirePropertyV2ToSdkPrimaryKeyTypeDefinition.js.map","/*\n * Copyright 2023 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { wirePropertyV2ToSdkPrimaryKeyTypeDefinition } from \"./wirePropertyV2ToSdkPrimaryKeyTypeDefinition.js\";\nimport { wirePropertyV2ToSdkPropertyDefinition } from \"./wirePropertyV2ToSdkPropertyDefinition.js\";\nexport function wireObjectTypeFullMetadataToSdkObjectMetadata(objectTypeWithLink, v2, log) {\n  if (objectTypeWithLink.objectType.properties[objectTypeWithLink.objectType.primaryKey] === undefined) {\n    throw new Error(`Primary key ${objectTypeWithLink.objectType.primaryKey} not found in ${objectTypeWithLink.objectType.apiName}`);\n  }\n\n  // saved ontology.json files may not have this implementsInterfaces2 so we need to handle\n  if (objectTypeWithLink.implementsInterfaces2 == null && objectTypeWithLink.implementsInterfaces != null) {\n    throw new Error(\"Your ontology.json file is missing the implementsInterfaces2 field. Please regenerate it.\");\n  }\n  const interfaceMap = objectTypeWithLink.implementsInterfaces2 ? Object.fromEntries(Object.entries(objectTypeWithLink.implementsInterfaces2).map(([interfaceApiName, impl]) => [interfaceApiName, impl.properties])) : {};\n  return {\n    type: \"object\",\n    apiName: objectTypeWithLink.objectType.apiName,\n    description: objectTypeWithLink.objectType.description,\n    primaryKeyApiName: objectTypeWithLink.objectType.primaryKey,\n    primaryKeyType: wirePropertyV2ToSdkPrimaryKeyTypeDefinition(objectTypeWithLink.objectType.properties[objectTypeWithLink.objectType.primaryKey]),\n    links: Object.fromEntries(objectTypeWithLink.linkTypes.map(linkType => {\n      return [linkType.apiName, {\n        multiplicity: linkType.cardinality === \"MANY\",\n        targetType: linkType.objectTypeApiName\n      }];\n    })),\n    properties: Object.fromEntries(Object.entries(objectTypeWithLink.objectType.properties).map(([key, value]) => [key, wirePropertyV2ToSdkPropertyDefinition(value, !(v2 && objectTypeWithLink.objectType.primaryKey === key), log)]).filter(([key, value]) => value != null)),\n    implements: objectTypeWithLink.implementsInterfaces,\n    interfaceMap,\n    inverseInterfaceMap: Object.fromEntries(Object.entries(interfaceMap).map(([interfaceApiName, props]) => [interfaceApiName, invertProps(props)])),\n    icon: supportedIconTypes.includes(objectTypeWithLink.objectType.icon.type) ? objectTypeWithLink.objectType.icon : undefined,\n    titleProperty: objectTypeWithLink.objectType.titleProperty,\n    displayName: objectTypeWithLink.objectType.displayName,\n    pluralDisplayName: objectTypeWithLink.objectType.pluralDisplayName,\n    status: objectTypeWithLink.objectType.status,\n    rid: objectTypeWithLink.objectType.rid,\n    visibility: objectTypeWithLink.objectType.visibility\n  };\n}\nfunction invertProps(a) {\n  return a ? Object.fromEntries(Object.entries(a).map(([k, v]) => [v, k])) : undefined;\n}\nconst supportedIconTypes = [\"blueprint\"];\n//# sourceMappingURL=wireObjectTypeFullMetadataToSdkObjectMetadata.js.map","/*\n * Copyright 2023 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function isNullableQueryDataType(input) {\n  if (input.type === \"null\") {\n    return true;\n  }\n  if (input.type === \"union\") {\n    return input.unionTypes.some(t => isNullableQueryDataType(t));\n  }\n  return false;\n}\n//# sourceMappingURL=isNullableQueryDataType.js.map","/*\n * Copyright 2023 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isNullableQueryDataType } from \"./isNullableQueryDataType.js\";\nexport function wireQueryDataTypeToQueryDataTypeDefinition(input) {\n  switch (input.type) {\n    case \"double\":\n    case \"float\":\n    case \"integer\":\n    case \"long\":\n    case \"attachment\":\n    case \"boolean\":\n    case \"date\":\n    case \"string\":\n    case \"timestamp\":\n      return {\n        type: input.type,\n        nullable: false\n      };\n    case \"object\":\n      return {\n        type: \"object\",\n        object: input.objectTypeApiName,\n        nullable: false\n      };\n    case \"objectSet\":\n      return {\n        type: \"objectSet\",\n        objectSet: input.objectTypeApiName,\n        nullable: false\n      };\n    case \"array\":\n      return {\n        ...wireQueryDataTypeToQueryDataTypeDefinition(input.subType),\n        multiplicity: true\n      };\n    case \"set\":\n      return {\n        type: \"set\",\n        set: wireQueryDataTypeToQueryDataTypeDefinition(input.subType),\n        nullable: false\n      };\n    case \"union\":\n      const allowNulls = isNullableQueryDataType(input);\n\n      // special case for a union where one half is nullable to skip the union step and just allow nulls directly\n      if (allowNulls && input.unionTypes.length === 2) {\n        const nonNull = input.unionTypes.find(t => t.type != null);\n        if (nonNull) {\n          return {\n            ...wireQueryDataTypeToQueryDataTypeDefinition(nonNull),\n            nullable: true\n          };\n        }\n      }\n      return {\n        type: \"union\",\n        union: input.unionTypes.reduce((acc, t) => {\n          if (t.type === \"null\") {\n            return acc;\n          }\n          acc.push(wireQueryDataTypeToQueryDataTypeDefinition(t));\n          return acc;\n        }, []),\n        nullable: allowNulls\n      };\n    case \"struct\":\n      return {\n        type: \"struct\",\n        struct: Object.fromEntries(input.fields.map(f => [f.name, wireQueryDataTypeToQueryDataTypeDefinition(f.fieldType)])),\n        nullable: false\n      };\n    case \"twoDimensionalAggregation\":\n      return {\n        type: \"twoDimensionalAggregation\",\n        twoDimensionalAggregation: get2DQueryAggregationProps(input),\n        nullable: false\n      };\n    case \"threeDimensionalAggregation\":\n      return {\n        type: \"threeDimensionalAggregation\",\n        threeDimensionalAggregation: get3DQueryAggregationProps(input),\n        nullable: false\n      };\n    case \"entrySet\":\n      const keyType = wireQueryDataTypeToQueryDataTypeDefinition(input.keyType);\n      if (!validMapKeyTypes.includes(keyType.type)) {\n        throw new Error(\"Map types with a key type of \" + keyType.type + \" are not supported\" + validMapKeyTypes.toString());\n      }\n      if (keyType.multiplicity === true) {\n        throw new Error(\"Map types cannot have keys as arrays\");\n      }\n      return {\n        type: \"map\",\n        nullable: false,\n        keyType,\n        valueType: wireQueryDataTypeToQueryDataTypeDefinition(input.valueType)\n      };\n    case \"null\":\n    case \"unsupported\":\n      throw new Error(`Unable to process query because the server indicated an unsupported QueryDataType.type: ${input.type}. Please check that your query is using supported types.`);\n    default:\n      throw new Error(`Unsupported QueryDataType.type ${input.type}`);\n  }\n}\nfunction get2DQueryAggregationProps(input) {\n  if (input.keyType.type === \"range\") {\n    return {\n      keyType: input.keyType.type,\n      keySubtype: input.keyType.subType.type,\n      valueType: input.valueType.type\n    };\n  } else {\n    if (guardInvalidKeyTypes(input.keyType)) {\n      return {\n        keyType: input.keyType.type,\n        valueType: input.valueType.type\n      };\n    }\n    throw new Error(`Cannot create 2D aggregation with ${input.keyType.type} as its type`);\n  }\n}\nfunction get3DQueryAggregationProps(input) {\n  if (input.keyType.type === \"range\") {\n    return {\n      keyType: input.keyType.type,\n      keySubtype: input.keyType.subType.type,\n      valueType: get2DQueryAggregationProps(input.valueType)\n    };\n  } else {\n    if (guardInvalidKeyTypes(input.keyType)) {\n      return {\n        keyType: input.keyType.type,\n        valueType: get2DQueryAggregationProps(input.valueType)\n      };\n    }\n    throw new Error(`Cannot create 3D aggregation with ${input.keyType.type} as its type`);\n  }\n}\n\n/**\n * Guard against aggregation key types that are allowed by the backend types but are illegal to actually use\n */\nfunction guardInvalidKeyTypes(key) {\n  return key.type === \"string\" || key.type === \"boolean\";\n}\n\n/**\n * The set of all valid key types for maps. This includes all types that are represented by strings or numbers in the OSDK, and  Ontology Objects.\n */\nconst validMapKeyTypes = [\"string\", \"object\", \"double\", \"float\", \"integer\", \"long\", \"date\", \"timestamp\", \"byte\", \"datetime\", \"decimal\", \"marking\", \"short\", \"objectType\"];\n//# sourceMappingURL=wireQueryDataTypeToQueryDataTypeDefinition.js.map","/*\n * Copyright 2023 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { wireQueryDataTypeToQueryDataTypeDefinition } from \"./wireQueryDataTypeToQueryDataTypeDefinition.js\";\nexport function wireQueryTypeV2ToSdkQueryMetadata(input) {\n  return {\n    type: \"query\",\n    apiName: input.apiName,\n    description: input.description,\n    displayName: input.displayName,\n    version: input.version,\n    parameters: Object.fromEntries(Object.entries(input.parameters).map(([name, parameter]) => [name, wireQueryParameterV2ToQueryParameterDefinition(parameter)])),\n    output: wireQueryDataTypeToQueryDataTypeDefinition(input.output),\n    rid: input.rid\n  };\n}\nexport function wireQueryTypeV2ToSdkQueryDefinitionNoParams(input) {\n  return {\n    type: \"query\",\n    apiName: input.apiName,\n    description: input.description,\n    displayName: input.displayName,\n    version: input.version,\n    rid: input.rid\n  };\n}\nexport function wireQueryParameterV2ToQueryParameterDefinition(parameter) {\n  return {\n    description: parameter.description,\n    ...wireQueryDataTypeToQueryDataTypeDefinition(parameter.dataType)\n  };\n}\n//# sourceMappingURL=wireQueryTypeV2ToSdkQueryMetadata.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as OntologiesV2 from \"@osdk/foundry.ontologies\";\nimport { wireActionTypeV2ToSdkActionMetadata } from \"@osdk/generator-converters\";\nexport async function loadActionMetadata(client, actionType) {\n  const r = await OntologiesV2.ActionTypesV2.get(client, await client.ontologyRid, actionType);\n  return wireActionTypeV2ToSdkActionMetadata(r);\n}\n//# sourceMappingURL=loadActionMetadata.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as OntologiesV2 from \"@osdk/foundry.ontologies\";\nimport { wireObjectTypeFullMetadataToSdkObjectMetadata } from \"@osdk/generator-converters\";\nexport async function loadFullObjectMetadata(client, objectType) {\n  const full = await OntologiesV2.ObjectTypesV2.getFullMetadata(client, await client.ontologyRid, objectType, {\n    preview: true\n  });\n  const ret = wireObjectTypeFullMetadataToSdkObjectMetadata(full, true);\n  return {\n    ...ret\n  };\n}\n//# sourceMappingURL=loadFullObjectMetadata.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as OntologiesV2 from \"@osdk/foundry.ontologies\";\nimport { __UNSTABLE_wireInterfaceTypeV2ToSdkObjectDefinition } from \"@osdk/generator-converters\";\nexport async function loadInterfaceMetadata(client, objectType) {\n  const r = await OntologiesV2.OntologyInterfaces.get(client, await client.ontologyRid, objectType, {\n    preview: true\n  });\n  return __UNSTABLE_wireInterfaceTypeV2ToSdkObjectDefinition(r, true);\n}\n//# sourceMappingURL=loadInterfaceMetadata.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as OntologiesV2 from \"@osdk/foundry.ontologies\";\nimport { wireQueryTypeV2ToSdkQueryMetadata } from \"@osdk/generator-converters\";\nexport async function loadQueryMetadata(client, queryTypeApiNameAndVersion) {\n  const [apiName, version] = queryTypeApiNameAndVersion.split(\":\");\n  const r = await OntologiesV2.QueryTypes.get(client, await client.ontologyRid, apiName, {\n    version\n  });\n  return wireQueryTypeV2ToSdkQueryMetadata(r);\n}\n//# sourceMappingURL=loadQueryMetadata.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createAsyncClientCache } from \"../object/Cache.js\";\nimport { loadActionMetadata } from \"./loadActionMetadata.js\";\nimport { loadFullObjectMetadata } from \"./loadFullObjectMetadata.js\";\nimport { loadInterfaceMetadata } from \"./loadInterfaceMetadata.js\";\nimport { loadQueryMetadata } from \"./loadQueryMetadata.js\";\nimport { InterfaceDefinitions } from \"./OntologyProvider.js\";\nexport const createStandardOntologyProviderFactory = () => {\n  return client => {\n    function makeGetter(fn) {\n      const cache = createAsyncClientCache((client, key) => fn(client, key, false));\n      return async apiName => {\n        return await cache.get(client, apiName);\n      };\n    }\n    const ret = {\n      getObjectDefinition: makeGetter(async function (client, key) {\n        const objectDef = await loadFullObjectMetadata(client, key);\n\n        // ensure we have all of the interfaces loaded\n        const interfaceDefs = Object.fromEntries((await Promise.all(objectDef.implements?.map(i => ret.getInterfaceDefinition(i)) ?? [])).map(i => [i.apiName, {\n          def: i,\n          handler: undefined\n        }]));\n        const fullObjectDef = {\n          ...objectDef,\n          [InterfaceDefinitions]: interfaceDefs\n        };\n        return fullObjectDef;\n      }),\n      getInterfaceDefinition: makeGetter(async function (client, key) {\n        return loadInterfaceMetadata(client, key);\n      }),\n      getActionDefinition: makeGetter(async function (client, key) {\n        const r = await loadActionMetadata(client, key);\n        return r;\n      }),\n      getQueryDefinition: function (client, fn) {\n        const queryCache = createAsyncClientCache((client, key) => {\n          return fn(client, key);\n        });\n        return async (apiName, version) => {\n          const key = version ? `${apiName}:${version}` : apiName;\n          return await queryCache.get(client, key);\n        };\n      }(client, async function (client, key) {\n        return loadQueryMetadata(client, key);\n      })\n    };\n    return ret;\n  };\n};\n//# sourceMappingURL=StandardOntologyProvider.js.map","/*\n * Copyright 2023 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const USER_AGENT = `osdk-client/${\"2.3.0-beta.2\"}`;\n//# sourceMappingURL=UserAgent.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createSharedClientContext } from \"@osdk/shared.client.impl\";\nimport { convertWireToOsdkObjects, convertWireToOsdkObjects2 } from \"./object/convertWireToOsdkObjects.js\";\nimport { createObjectSet } from \"./objectSet/createObjectSet.js\";\nimport { createStandardOntologyProviderFactory } from \"./ontology/StandardOntologyProvider.js\";\nimport { USER_AGENT } from \"./util/UserAgent.js\";\n\n/** @internal */\nexport function createMinimalClient(metadata, baseUrl, tokenProvider, options = {}, fetchFn = global.fetch, objectSetFactory = createObjectSet, createOntologyProviderFactory = createStandardOntologyProviderFactory) {\n  if (process.env.NODE_ENV !== \"production\") {\n    try {\n      new URL(baseUrl);\n    } catch (e) {\n      const hint = !baseUrl.startsWith(\"http://\") || !baseUrl.startsWith(\"https://\") ? \". Did you forget to add 'http://' or 'https://'?\" : \"\";\n      throw new Error(`Invalid stack URL: ${baseUrl}${hint}`);\n    }\n  }\n  const processedBaseUrl = new URL(baseUrl);\n  processedBaseUrl.pathname += processedBaseUrl.pathname.endsWith(\"/\") ? \"\" : \"/\";\n  const minimalClient = {\n    ...createSharedClientContext(processedBaseUrl.toString(), tokenProvider, USER_AGENT, fetchFn),\n    objectSetFactory,\n    objectFactory: convertWireToOsdkObjects,\n    objectFactory2: convertWireToOsdkObjects2,\n    ontologyRid: metadata.ontologyRid,\n    logger: options.logger,\n    clientCacheKey: {},\n    requestContext: {}\n  };\n  return Object.freeze(Object.assign(minimalClient, {\n    ontologyProvider: createOntologyProviderFactory(options)(minimalClient)\n  }));\n}\n//# sourceMappingURL=createMinimalClient.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { InterfaceDefinitions } from \"./ontology/OntologyProvider.js\";\n\n/** @internal */\nexport const fetchMetadataInternal = async (client, definition) => {\n  if (definition.type === \"object\") {\n    const {\n      [InterfaceDefinitions]: interfaceDefs,\n      ...objectTypeDef\n    } = await client.ontologyProvider.getObjectDefinition(definition.apiName);\n    return objectTypeDef;\n  } else if (definition.type === \"interface\") {\n    return client.ontologyProvider.getInterfaceDefinition(definition.apiName);\n  } else if (definition.type === \"action\") {\n    return client.ontologyProvider.getActionDefinition(definition.apiName);\n  } else if (definition.type === \"query\") {\n    return client.ontologyProvider.getQueryDefinition(definition.apiName, definition.isFixedVersion ? definition.version : undefined);\n  } else {\n    throw new Error(\"Not implemented for given definition\");\n  }\n};\n//# sourceMappingURL=fetchMetadata.js.map","/*\n * Copyright 2025 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function noop() {}\nconst levels = {\n  trace: 10,\n  debug: 20,\n  info: 30,\n  warn: 40,\n  error: 50,\n  fatal: 60\n};\nexport class BaseLogger {\n  #factory;\n  constructor(bindings, options = {}, factory) {\n    this.bindings = bindings;\n    this.options = options;\n    this.#factory = factory;\n    for (const k of [\"trace\", \"debug\", \"info\", \"warn\", \"error\", \"fatal\"]) {\n      if (this.options?.level && !this.isLevelEnabled(k)) {\n        continue;\n      }\n      this[k] = this.createLogMethod(k, bindings);\n    }\n  }\n  trace = noop;\n  debug = noop;\n  warn = noop;\n  info = noop;\n  error = noop;\n  fatal = noop;\n  child(bindings, options) {\n    return new this.#factory({\n      ...this.bindings,\n      ...bindings\n    }, {\n      level: (options ?? this.options)?.level,\n      msgPrefix: [this.options?.msgPrefix, options?.msgPrefix].filter(x => x).join(\" \")\n    });\n  }\n  isLevelEnabled(level) {\n    const ourLevel = this.options?.level ?? \"info\";\n    return level in levels && ourLevel in levels && levels[level] >= levels[ourLevel];\n  }\n}\n//# sourceMappingURL=BaseLogger.js.map","/*\n * Copyright 2025 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { BaseLogger } from \"./BaseLogger.js\";\nexport class MinimalLogger extends BaseLogger {\n  constructor(bindings = {}, options = {}) {\n    super(bindings, {\n      ...options,\n      level: options.level ?? \"error\"\n    }, MinimalLogger);\n  }\n  createLogMethod(name, bindings) {\n    const msgs = [name];\n    if (this.options?.msgPrefix) {\n      msgs.push(this.options.msgPrefix);\n    }\n    if (typeof bindings === \"object\" && \"methodName\" in bindings) {\n      msgs.push(`.${bindings.methodName}()`);\n    }\n    return (...args) => {\n      // eslint-disable-next-line no-console\n      console[name === \"fatal\" ? \"error\" : name](msgs.join(\" \"), ...args);\n    };\n  }\n}\n//# sourceMappingURL=MinimalLogger.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as OntologiesV2 from \"@osdk/foundry.ontologies\";\nimport { isAttachmentFile, isAttachmentUpload } from \"../object/AttachmentUpload.js\";\nimport { getWireObjectSet, isObjectSet } from \"../objectSet/createObjectSet.js\";\nimport { isObjectSpecifiersObject } from \"./isObjectSpecifiersObject.js\";\nimport { extractPrimaryKeyFromObjectSpecifier } from \"./objectSpecifierUtils.js\";\nimport { isWireObjectSet } from \"./WireObjectSet.js\";\n\n/**\n * Marshall user-facing data into the wire DataValue type\n *\n * @see DataValue for the expected payloads\n * @internal\n */\nexport async function toDataValueQueries(value, client, desiredType) {\n  if (value == null) {\n    return value;\n  }\n  if (Array.isArray(value) && desiredType.multiplicity) {\n    const values = Array.from(value);\n    if (values.some(dataValue => isAttachmentUpload(dataValue) || isAttachmentFile(dataValue))) {\n      const converted = [];\n      for (const value of values) {\n        converted.push(await toDataValueQueries(value, client, desiredType));\n      }\n      return converted;\n    }\n    const promiseArray = Array.from(value, async innerValue => await toDataValueQueries(innerValue, client, desiredType));\n    return Promise.all(promiseArray);\n  }\n  switch (desiredType.type) {\n    case \"attachment\":\n      {\n        if (isAttachmentUpload(value)) {\n          const attachment = await OntologiesV2.Attachments.upload(client, value.data, {\n            filename: value.name\n          });\n          return attachment.rid;\n        }\n        if (isAttachmentFile(value)) {\n          const attachment = await OntologiesV2.Attachments.upload(client, value, {\n            filename: value.name\n          });\n          return attachment.rid;\n        }\n\n        // If it's not an upload, it's just an attachment rid string which we can pass through\n        return value;\n      }\n    case \"twoDimensionalAggregation\":\n      {\n        return {\n          groups: value\n        };\n      }\n    case \"threeDimensionalAggregation\":\n      {\n        return {\n          groups: value\n        };\n      }\n    case \"set\":\n      {\n        if (value instanceof Set) {\n          const promiseArray = Array.from(value, async innerValue => await toDataValueQueries(innerValue, client, desiredType[\"set\"]));\n          return Promise.all(promiseArray);\n        }\n        break;\n      }\n    case \"object\":\n      {\n        if (isObjectSpecifiersObject(value)) {\n          return value.$primaryKey;\n        }\n        break;\n      }\n    case \"objectSet\":\n      {\n        // object set (the rid as a string (passes through the last return), or the ObjectSet definition directly)\n        if (isWireObjectSet(value)) {\n          return value;\n        }\n        if (isObjectSet(value)) {\n          return getWireObjectSet(value);\n        }\n        break;\n      }\n    case \"map\":\n      {\n        if (typeof value === \"object\") {\n          const entrySet = [];\n          for (const [key, mapValue] of Object.entries(value)) {\n            entrySet.push({\n              key: desiredType.keyType.type === \"object\" ? extractPrimaryKeyFromObjectSpecifier(key) : await toDataValueQueries(key, client, desiredType.keyType),\n              value: await toDataValueQueries(mapValue, client, desiredType.valueType)\n            });\n          }\n          return entrySet;\n        }\n        break;\n      }\n    case \"struct\":\n      {\n        if (typeof value === \"object\") {\n          const structMap = {};\n          for (const [key, structValue] of Object.entries(value)) {\n            structMap[key] = await toDataValueQueries(structValue, client, desiredType[\"struct\"][key]);\n          }\n          return structMap;\n        }\n      }\n    case \"boolean\":\n    case \"date\":\n    case \"double\":\n    case \"float\":\n    case \"integer\":\n    case \"long\":\n    case \"string\":\n    case \"timestamp\":\n      return value;\n  }\n  return value;\n}\n//# sourceMappingURL=toDataValueQueries.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as OntologiesV2 from \"@osdk/foundry.ontologies\";\nimport invariant from \"tiny-invariant\";\nimport { createObjectSet } from \"../objectSet/createObjectSet.js\";\nimport { hydrateAttachmentFromRidInternal } from \"../public-utils/hydrateAttachmentFromRid.js\";\nimport { addUserAgentAndRequestContextHeaders } from \"../util/addUserAgentAndRequestContextHeaders.js\";\nimport { augmentRequestContext } from \"../util/augmentRequestContext.js\";\nimport { createObjectSpecifierFromPrimaryKey } from \"../util/objectSpecifierUtils.js\";\nimport { toDataValueQueries } from \"../util/toDataValueQueries.js\";\nexport async function applyQuery(client, query, params) {\n  const qd = await client.ontologyProvider.getQueryDefinition(query.apiName, query.isFixedVersion ? query.version : undefined);\n  const response = await OntologiesV2.Queries.execute(addUserAgentAndRequestContextHeaders(augmentRequestContext(client, () => ({\n    finalMethodCall: \"applyQuery\"\n  })), query), await client.ontologyRid, query.apiName, {\n    parameters: params ? await remapQueryParams(params, client, qd.parameters) : {}\n  }, {\n    version: qd.version\n  });\n  const objectOutputDefs = await getRequiredDefinitions(qd.output, client);\n  const remappedResponse = await remapQueryResponse(client, qd.output, response.value, objectOutputDefs);\n  return remappedResponse;\n}\nasync function remapQueryParams(params, client, paramTypes) {\n  const parameterMap = {};\n  for (const [key, value] of Object.entries(params)) {\n    parameterMap[key] = await toDataValueQueries(value, client, paramTypes[key]);\n  }\n  return parameterMap;\n}\nasync function remapQueryResponse(client, responseDataType, responseValue, definitions) {\n  // handle null responses\n  if (responseValue == null) {\n    if (responseDataType.nullable) {\n      return undefined;\n    } else {\n      throw new Error(\"Got null response when nullable was not allowed\");\n    }\n  }\n  if (responseDataType.multiplicity != null && responseDataType.multiplicity) {\n    const withoutMultiplicity = {\n      ...responseDataType,\n      multiplicity: false\n    };\n    for (let i = 0; i < responseValue.length; i++) {\n      responseValue[i] = await remapQueryResponse(client, withoutMultiplicity, responseValue[i], definitions);\n    }\n    return responseValue;\n  }\n  switch (responseDataType.type) {\n    case \"union\":\n      {\n        throw new Error(\"Union return types are not yet supported\");\n      }\n    case \"set\":\n      {\n        for (let i = 0; i < responseValue.length; i++) {\n          responseValue[i] = await remapQueryResponse(client, responseDataType.set, responseValue[i], definitions);\n        }\n        return responseValue;\n      }\n    case \"attachment\":\n      {\n        return hydrateAttachmentFromRidInternal(client, responseValue);\n      }\n    case \"object\":\n      {\n        const def = definitions.get(responseDataType.object);\n        if (!def || def.type !== \"object\") {\n          throw new Error(`Missing definition for ${responseDataType.object}`);\n        }\n        return createQueryObjectResponse(responseValue, def);\n      }\n    case \"objectSet\":\n      {\n        const def = definitions.get(responseDataType.objectSet);\n        if (!def) {\n          throw new Error(`Missing definition for ${responseDataType.objectSet}`);\n        }\n        if (typeof responseValue === \"string\") {\n          return createObjectSet(def, client, {\n            type: \"intersect\",\n            objectSets: [{\n              type: \"base\",\n              objectType: responseDataType.objectSet\n            }, {\n              type: \"reference\",\n              reference: responseValue\n            }]\n          });\n        }\n        return createObjectSet(def, client, responseValue);\n      }\n    case \"struct\":\n      {\n        // figure out what keys need to be fixed up\n        for (const [key, subtype] of Object.entries(responseDataType.struct)) {\n          if (requiresConversion(subtype)) {\n            responseValue[key] = await remapQueryResponse(client, subtype, responseValue[key], definitions);\n          }\n        }\n        return responseValue;\n      }\n    case \"map\":\n      {\n        const map = {};\n        !Array.isArray(responseValue) ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"Expected array entry\") : invariant(false) : void 0;\n        for (const entry of responseValue) {\n          !entry.key ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"Expected key\") : invariant(false) : void 0;\n          !entry.value ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"Expected value\") : invariant(false) : void 0;\n          const key = responseDataType.keyType.type === \"object\" ? getObjectSpecifier(entry.key, responseDataType.keyType.object, definitions) : entry.key;\n          const value = await remapQueryResponse(client, responseDataType.valueType, entry.value, definitions);\n          map[key] = value;\n        }\n        return map;\n      }\n    case \"twoDimensionalAggregation\":\n      {\n        const result = [];\n        for (const {\n          key,\n          value\n        } of responseValue.groups) {\n          result.push({\n            key,\n            value\n          });\n        }\n        return result;\n      }\n    case \"threeDimensionalAggregation\":\n      {\n        const result = [];\n        for (const {\n          key,\n          groups\n        } of responseValue.groups) {\n          const subResult = [];\n          for (const {\n            key: subKey,\n            value\n          } of groups) {\n            subResult.push({\n              key: subKey,\n              value\n            });\n          }\n          result.push({\n            key,\n            groups: subResult\n          });\n        }\n        return result;\n      }\n  }\n  return responseValue;\n}\nasync function getRequiredDefinitions(dataType, client) {\n  const result = new Map();\n  switch (dataType.type) {\n    case \"objectSet\":\n      {\n        const objectDef = await client.ontologyProvider.getObjectDefinition(dataType.objectSet);\n        result.set(dataType.objectSet, objectDef);\n        break;\n      }\n    case \"object\":\n      {\n        const objectDef = await client.ontologyProvider.getObjectDefinition(dataType.object);\n        result.set(dataType.object, objectDef);\n        break;\n      }\n    case \"set\":\n      {\n        return getRequiredDefinitions(dataType.set, client);\n      }\n    case \"map\":\n      {\n        for (const value of [dataType.keyType, dataType.valueType]) {\n          for (const [type, objectDef] of await getRequiredDefinitions(value, client)) {\n            result.set(type, objectDef);\n          }\n        }\n        break;\n      }\n    case \"struct\":\n      {\n        for (const value of Object.values(dataType.struct)) {\n          for (const [type, objectDef] of await getRequiredDefinitions(value, client)) {\n            result.set(type, objectDef);\n          }\n        }\n        break;\n      }\n    case \"attachment\":\n    case \"boolean\":\n    case \"date\":\n    case \"double\":\n    case \"float\":\n    case \"integer\":\n    case \"long\":\n    case \"string\":\n    case \"threeDimensionalAggregation\":\n    case \"timestamp\":\n    case \"twoDimensionalAggregation\":\n    case \"union\":\n      break;\n  }\n  return result;\n}\nfunction requiresConversion(dataType) {\n  switch (dataType.type) {\n    case \"boolean\":\n    case \"date\":\n    case \"double\":\n    case \"float\":\n    case \"integer\":\n    case \"long\":\n    case \"string\":\n    case \"timestamp\":\n      return false;\n    case \"union\":\n      return true;\n    case \"struct\":\n      return Object.values(dataType.struct).some(requiresConversion);\n    case \"set\":\n      return requiresConversion(dataType.set);\n    case \"attachment\":\n    case \"objectSet\":\n    case \"twoDimensionalAggregation\":\n    case \"threeDimensionalAggregation\":\n    case \"object\":\n      return true;\n    default:\n      return false;\n  }\n}\nfunction getObjectSpecifier(primaryKey, objectTypeApiName, definitions) {\n  const def = definitions.get(objectTypeApiName);\n  if (!def || def.type !== \"object\") {\n    throw new Error(`Missing definition for ${objectTypeApiName}`);\n  }\n  return createObjectSpecifierFromPrimaryKey(def, primaryKey);\n}\nexport function createQueryObjectResponse(primaryKey, objectDef) {\n  return {\n    $apiName: objectDef.apiName,\n    $title: undefined,\n    $objectType: objectDef.apiName,\n    $primaryKey: primaryKey,\n    $objectSpecifier: createObjectSpecifierFromPrimaryKey(objectDef, primaryKey)\n  };\n}\n//# sourceMappingURL=applyQuery.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { __EXPERIMENTAL__NOT_SUPPORTED_YET__createMediaReference, __EXPERIMENTAL__NOT_SUPPORTED_YET__fetchOneByRid, __EXPERIMENTAL__NOT_SUPPORTED_YET__fetchPageByRid, __EXPERIMENTAL__NOT_SUPPORTED_YET__getBulkLinks } from \"@osdk/api/unstable\";\nimport * as OntologiesV2 from \"@osdk/foundry.ontologies\";\nimport { symbolClientContext as oldSymbolClientContext } from \"@osdk/shared.client\";\nimport { createBulkLinksAsyncIterFactory } from \"./__unstable/createBulkLinksAsyncIterFactory.js\";\nimport { applyAction } from \"./actions/applyAction.js\";\nimport { additionalContext } from \"./Client.js\";\nimport { createMinimalClient } from \"./createMinimalClient.js\";\nimport { fetchMetadataInternal } from \"./fetchMetadata.js\";\nimport { MinimalLogger } from \"./logger/MinimalLogger.js\";\nimport { fetchPage } from \"./object/fetchPage.js\";\nimport { fetchSingle } from \"./object/fetchSingle.js\";\nimport { createObjectSet } from \"./objectSet/createObjectSet.js\";\nimport { applyQuery } from \"./queries/applyQuery.js\";\n\n// We import it this way to keep compatible with CJS. If we referenced the\n// value of `symbolClientContext` directly, then we would have to a dynamic import\n// in `createClientInternal` which would make it async and a break.\n// Since this is just a string in `@osdk/shared.client2` instead of a symbol,\n// we can safely perform this trick.\n\nclass ActionInvoker {\n  constructor(clientCtx, actionDef) {\n    // We type the property as a generic function as binding `applyAction`\n    // doesn't return a type thats all that useful anyway\n    // The implements covers us for the most part here as this exact type doesn't\n    // escape this file\n    this.applyAction = applyAction.bind(undefined, clientCtx, actionDef);\n    this.batchApplyAction = applyAction.bind(undefined, clientCtx, actionDef);\n  }\n}\nclass QueryInvoker {\n  constructor(clientCtx, queryDef) {\n    this.executeFunction = applyQuery.bind(undefined, clientCtx, queryDef);\n  }\n}\n\n/** @internal */\nexport function createClientInternal(objectSetFactory,\n// first so i can bind\nbaseUrl, ontologyRid, tokenProvider, options = undefined, fetchFn = fetch) {\n  if (typeof ontologyRid === \"string\") {\n    if (!ontologyRid.startsWith(\"ri.\")) {\n      throw new Error(\"Invalid ontology RID\");\n    }\n  } else {\n    // eslint-disable-next-line @typescript-eslint/no-floating-promises\n    ontologyRid.then(ontologyRid => {\n      if (!ontologyRid.startsWith(\"ri.\")) {\n        // FIXME this promise is not await so this just shows up as an unhandled promise rejection\n        throw new Error(\"Invalid ontology RID\");\n      }\n    });\n  }\n  const clientCtx = createMinimalClient({\n    ontologyRid\n  }, baseUrl, tokenProvider, {\n    ...options,\n    logger: options?.logger ?? new MinimalLogger()\n  }, fetchFn, objectSetFactory);\n  const fetchMetadata = fetchMetadataInternal.bind(undefined, clientCtx);\n  const client = Object.defineProperties(function (o) {\n    if (o.type === \"object\" || o.type === \"interface\") {\n      return objectSetFactory(o, clientCtx);\n    } else if (o.type === \"action\") {\n      return new ActionInvoker(clientCtx, o); // then as any for dealing with the conditional return value\n    } else if (o.type === \"query\") {\n      return new QueryInvoker(clientCtx, o);\n    } else if (o.type === \"experiment\") {\n      switch (o.name) {\n        case __EXPERIMENTAL__NOT_SUPPORTED_YET__getBulkLinks.name:\n          return {\n            getBulkLinks: createBulkLinksAsyncIterFactory(clientCtx)\n          };\n        case __EXPERIMENTAL__NOT_SUPPORTED_YET__fetchOneByRid.name:\n          return {\n            fetchOneByRid: async (objectType, rid, options) => {\n              return await fetchSingle(clientCtx, objectType, options, createWithRid([rid]));\n            }\n          };\n        case __EXPERIMENTAL__NOT_SUPPORTED_YET__createMediaReference.name:\n          return {\n            createMediaReference: async args => {\n              const {\n                data,\n                fileName,\n                objectType,\n                propertyType\n              } = args;\n              return await OntologiesV2.MediaReferenceProperties.upload(clientCtx, await clientCtx.ontologyRid, objectType.apiName, propertyType, data, {\n                mediaItemPath: fileName,\n                preview: true\n              });\n            }\n          };\n        case __EXPERIMENTAL__NOT_SUPPORTED_YET__fetchPageByRid.name:\n          return {\n            fetchPageByRid: async (objectOrInterfaceType, rids, options = {}) => {\n              return await fetchPage(clientCtx, objectOrInterfaceType, options, createWithRid(rids));\n            }\n          };\n      }\n      throw new Error(\"not implemented\");\n    } else {\n      throw new Error(\"not implemented\");\n    }\n  }, {\n    [oldSymbolClientContext]: {\n      value: clientCtx\n    },\n    [\"__osdkClientContext\"]: {\n      value: clientCtx\n    },\n    [additionalContext]: {\n      value: clientCtx\n    },\n    fetchMetadata: {\n      value: fetchMetadata\n    }\n  });\n  return client;\n}\nexport const createClient = createClientInternal.bind(undefined, createObjectSet);\nfunction createWithRid(rids) {\n  return {\n    type: \"static\",\n    \"objects\": rids\n  };\n}\n//# sourceMappingURL=createClient.js.map","export const $osdkMetadata = { extraUserAgent: 'typescript-sdk/0.5.0 typescript-sdk-generator/2.3.0-beta.2' };\nexport const $ontologyRid = 'ri.ontology.main.ontology.ab265709-5927-4853-99f0-c8f173e324e0';\n","import { $osdkMetadata } from '../../OntologyMetadata.js';\nexport const buildLegsFlightPlanner20 = {\n    apiName: 'buildLegsFlightPlanner20',\n    type: 'action',\n    osdkMetadata: $osdkMetadata,\n};\n","import { $osdkMetadata } from '../../OntologyMetadata.js';\nexport const calculateFlightTimes = {\n    apiName: 'calculateFlightTimes',\n    type: 'action',\n    osdkMetadata: $osdkMetadata,\n};\n","import { $osdkMetadata } from '../../OntologyMetadata.js';\nexport const calculateSunriseSunset = {\n    apiName: 'calculateSunriseSunset',\n    type: 'action',\n    osdkMetadata: $osdkMetadata,\n};\n","import { $osdkMetadata } from '../../OntologyMetadata.js';\nexport const createFlightLogObject = {\n    apiName: 'createFlightLogObject',\n    type: 'action',\n    osdkMetadata: $osdkMetadata,\n};\n","import { $osdkMetadata } from '../../OntologyMetadata.js';\nexport const createFlightWithWaypoints = {\n    apiName: 'createFlightWithWaypoints',\n    type: 'action',\n    osdkMetadata: $osdkMetadata,\n};\n","import { $osdkMetadata } from '../../OntologyMetadata.js';\nexport const createNewFlightFp2 = {\n    apiName: 'createNewFlightFp2',\n    type: 'action',\n    osdkMetadata: $osdkMetadata,\n};\n","import { $osdkMetadata } from '../../OntologyMetadata.js';\nexport const editExistingFlightFp2 = {\n    apiName: 'editExistingFlightFp2',\n    type: 'action',\n    osdkMetadata: $osdkMetadata,\n};\n","import { $osdkMetadata } from '../../OntologyMetadata.js';\nexport const flightAppUpdateEtdAndCrew = {\n    apiName: 'flightAppUpdateEtdAndCrew',\n    type: 'action',\n    osdkMetadata: $osdkMetadata,\n};\n","import { $osdkMetadata } from '../../OntologyMetadata.js';\nexport const flightFuelFpv2 = {\n    apiName: 'flightFuelFpv2',\n    type: 'action',\n    osdkMetadata: $osdkMetadata,\n};\n","import { $osdkMetadata } from '../../OntologyMetadata.js';\nexport const flightWeatherRiskTriggeredLightningWaves = {\n    apiName: 'flightWeatherRiskTriggeredLightningWaves',\n    type: 'action',\n    osdkMetadata: $osdkMetadata,\n};\n","import { $osdkMetadata } from '../../OntologyMetadata.js';\nexport const getGlobalWindsForFlight = {\n    apiName: 'getGlobalWindsForFlight',\n    type: 'action',\n    osdkMetadata: $osdkMetadata,\n};\n","import { $osdkMetadata } from '../../OntologyMetadata.js';\nexport const getWeatherForAlternates = {\n    apiName: 'getWeatherForAlternates',\n    type: 'action',\n    osdkMetadata: $osdkMetadata,\n};\n","import { $osdkMetadata } from '../../OntologyMetadata.js';\nexport const pseudoWeatherSegments = {\n    apiName: 'pseudoWeatherSegments',\n    type: 'action',\n    osdkMetadata: $osdkMetadata,\n};\n","import { $osdkMetadata } from '../../OntologyMetadata.js';\nexport const singleFlightAutomation = {\n    apiName: 'singleFlightAutomation',\n    type: 'action',\n    osdkMetadata: $osdkMetadata,\n};\n","import { $osdkMetadata } from '../../OntologyMetadata.js';\nexport const updateAlternantOneStep = {\n    apiName: 'updateAlternantOneStep',\n    type: 'action',\n    osdkMetadata: $osdkMetadata,\n};\n","import { $osdkMetadata } from '../../OntologyMetadata.js';\nexport const updateFastPlannerFlight = {\n    apiName: 'updateFastPlannerFlight',\n    type: 'action',\n    osdkMetadata: $osdkMetadata,\n};\n","import { $osdkMetadata } from '../../OntologyMetadata.js';\nexport const updateWeatherByRegion = {\n    apiName: 'updateWeatherByRegion',\n    type: 'action',\n    osdkMetadata: $osdkMetadata,\n};\n","import { $osdkMetadata } from '../../OntologyMetadata.js';\nexport const weatherWebookNorwayV9 = {\n    apiName: 'weatherWebookNorwayV9',\n    type: 'action',\n    osdkMetadata: $osdkMetadata,\n};\n","import { $osdkMetadata } from '../../OntologyMetadata.js';\nexport const AirportsData = {\n    type: 'object',\n    apiName: 'AirportsData',\n    osdkMetadata: $osdkMetadata,\n};\n","import { $osdkMetadata } from '../../OntologyMetadata.js';\nexport const AllGtLocationsV2 = {\n    type: 'object',\n    apiName: 'AllGtLocationsV2',\n    osdkMetadata: $osdkMetadata,\n};\n","import { $osdkMetadata } from '../../OntologyMetadata.js';\nexport const Asset = {\n    type: 'object',\n    apiName: 'Asset',\n    osdkMetadata: $osdkMetadata,\n};\n","import { $osdkMetadata } from '../../OntologyMetadata.js';\nexport const BristowHelidecks = {\n    type: 'object',\n    apiName: 'BristowHelidecks',\n    osdkMetadata: $osdkMetadata,\n};\n","import { $osdkMetadata } from '../../OntologyMetadata.js';\nexport const FlightFuelDburbury = {\n    type: 'object',\n    apiName: 'FlightFuelDburbury',\n    osdkMetadata: $osdkMetadata,\n};\n","import { $osdkMetadata } from '../../OntologyMetadata.js';\nexport const FlightLogObject = {\n    type: 'object',\n    apiName: 'FlightLogObject',\n    osdkMetadata: $osdkMetadata,\n};\n","import { $osdkMetadata } from '../../OntologyMetadata.js';\nexport const FuelPolicyBuilder = {\n    type: 'object',\n    apiName: 'FuelPolicyBuilder',\n    osdkMetadata: $osdkMetadata,\n};\n","import { $osdkMetadata } from '../../OntologyMetadata.js';\nexport const InternationalWeather = {\n    type: 'object',\n    apiName: 'InternationalWeather',\n    osdkMetadata: $osdkMetadata,\n};\n","import { $osdkMetadata } from '../../OntologyMetadata.js';\nexport const LegObjectOutputObject = {\n    type: 'object',\n    apiName: 'LegObjectOutputObject',\n    osdkMetadata: $osdkMetadata,\n};\n","import { $osdkMetadata } from '../../OntologyMetadata.js';\nexport const MainFlightObjectFp2 = {\n    type: 'object',\n    apiName: 'MainFlightObjectFp2',\n    osdkMetadata: $osdkMetadata,\n};\n","import { $osdkMetadata } from '../../OntologyMetadata.js';\nexport const MainFuelV2 = {\n    type: 'object',\n    apiName: 'MainFuelV2',\n    osdkMetadata: $osdkMetadata,\n};\n","import { $osdkMetadata } from '../../OntologyMetadata.js';\nexport const NorwayWeatherDatav2 = {\n    type: 'object',\n    apiName: 'NorwayWeatherDatav2',\n    osdkMetadata: $osdkMetadata,\n};\n","import { $osdkMetadata } from '../../OntologyMetadata.js';\nexport const NorwayWeatherSegments = {\n    type: 'object',\n    apiName: 'NorwayWeatherSegments',\n    osdkMetadata: $osdkMetadata,\n};\n","import { $osdkMetadata } from '../../OntologyMetadata.js';\nexport const NorwayWeatherXv8 = {\n    type: 'object',\n    apiName: 'NorwayWeatherXv8',\n    osdkMetadata: $osdkMetadata,\n};\n","import { $osdkMetadata } from '../../OntologyMetadata.js';\nexport const RegionalWeatherMinimaSettings = {\n    type: 'object',\n    apiName: 'RegionalWeatherMinimaSettings',\n    osdkMetadata: $osdkMetadata,\n};\n","import { $osdkMetadata } from '../../OntologyMetadata.js';\nexport const User = {\n    type: 'object',\n    apiName: 'User',\n    osdkMetadata: $osdkMetadata,\n};\n","let USER_AGENT;\nif (typeof navigator === 'undefined' || !navigator.userAgent?.startsWith?.('Mozilla/5.0 ')) {\n    const NAME = 'oauth4webapi';\n    const VERSION = 'v2.17.0';\n    USER_AGENT = `${NAME}/${VERSION}`;\n}\nfunction looseInstanceOf(input, expected) {\n    if (input == null) {\n        return false;\n    }\n    try {\n        return (input instanceof expected ||\n            Object.getPrototypeOf(input)[Symbol.toStringTag] === expected.prototype[Symbol.toStringTag]);\n    }\n    catch {\n        return false;\n    }\n}\nexport const clockSkew = Symbol();\nexport const clockTolerance = Symbol();\nexport const customFetch = Symbol();\nexport const modifyAssertion = Symbol();\nexport const jweDecrypt = Symbol();\nexport const jwksCache = Symbol();\nexport const useMtlsAlias = Symbol();\nconst encoder = new TextEncoder();\nconst decoder = new TextDecoder();\nfunction buf(input) {\n    if (typeof input === 'string') {\n        return encoder.encode(input);\n    }\n    return decoder.decode(input);\n}\nconst CHUNK_SIZE = 0x8000;\nfunction encodeBase64Url(input) {\n    if (input instanceof ArrayBuffer) {\n        input = new Uint8Array(input);\n    }\n    const arr = [];\n    for (let i = 0; i < input.byteLength; i += CHUNK_SIZE) {\n        arr.push(String.fromCharCode.apply(null, input.subarray(i, i + CHUNK_SIZE)));\n    }\n    return btoa(arr.join('')).replace(/=/g, '').replace(/\\+/g, '-').replace(/\\//g, '_');\n}\nfunction decodeBase64Url(input) {\n    try {\n        const binary = atob(input.replace(/-/g, '+').replace(/_/g, '/').replace(/\\s/g, ''));\n        const bytes = new Uint8Array(binary.length);\n        for (let i = 0; i < binary.length; i++) {\n            bytes[i] = binary.charCodeAt(i);\n        }\n        return bytes;\n    }\n    catch (cause) {\n        throw new OPE('The input to be decoded is not correctly encoded.', { cause });\n    }\n}\nfunction b64u(input) {\n    if (typeof input === 'string') {\n        return decodeBase64Url(input);\n    }\n    return encodeBase64Url(input);\n}\nclass LRU {\n    constructor(maxSize) {\n        this.cache = new Map();\n        this._cache = new Map();\n        this.maxSize = maxSize;\n    }\n    get(key) {\n        let v = this.cache.get(key);\n        if (v) {\n            return v;\n        }\n        if ((v = this._cache.get(key))) {\n            this.update(key, v);\n            return v;\n        }\n        return undefined;\n    }\n    has(key) {\n        return this.cache.has(key) || this._cache.has(key);\n    }\n    set(key, value) {\n        if (this.cache.has(key)) {\n            this.cache.set(key, value);\n        }\n        else {\n            this.update(key, value);\n        }\n        return this;\n    }\n    delete(key) {\n        if (this.cache.has(key)) {\n            return this.cache.delete(key);\n        }\n        if (this._cache.has(key)) {\n            return this._cache.delete(key);\n        }\n        return false;\n    }\n    update(key, value) {\n        this.cache.set(key, value);\n        if (this.cache.size >= this.maxSize) {\n            this._cache = this.cache;\n            this.cache = new Map();\n        }\n    }\n}\nexport class UnsupportedOperationError extends Error {\n    constructor(message) {\n        super(message ?? 'operation not supported');\n        this.name = this.constructor.name;\n        Error.captureStackTrace?.(this, this.constructor);\n    }\n}\nexport class OperationProcessingError extends Error {\n    constructor(message, options) {\n        super(message, options);\n        this.name = this.constructor.name;\n        Error.captureStackTrace?.(this, this.constructor);\n    }\n}\nconst OPE = OperationProcessingError;\nconst dpopNonces = new LRU(100);\nfunction isCryptoKey(key) {\n    return key instanceof CryptoKey;\n}\nfunction isPrivateKey(key) {\n    return isCryptoKey(key) && key.type === 'private';\n}\nfunction isPublicKey(key) {\n    return isCryptoKey(key) && key.type === 'public';\n}\nconst SUPPORTED_JWS_ALGS = [\n    'PS256',\n    'ES256',\n    'RS256',\n    'PS384',\n    'ES384',\n    'RS384',\n    'PS512',\n    'ES512',\n    'RS512',\n    'EdDSA',\n];\nfunction processDpopNonce(response) {\n    try {\n        const nonce = response.headers.get('dpop-nonce');\n        if (nonce) {\n            dpopNonces.set(new URL(response.url).origin, nonce);\n        }\n    }\n    catch { }\n    return response;\n}\nfunction normalizeTyp(value) {\n    return value.toLowerCase().replace(/^application\\//, '');\n}\nfunction isJsonObject(input) {\n    if (input === null || typeof input !== 'object' || Array.isArray(input)) {\n        return false;\n    }\n    return true;\n}\nfunction prepareHeaders(input) {\n    if (looseInstanceOf(input, Headers)) {\n        input = Object.fromEntries(input.entries());\n    }\n    const headers = new Headers(input);\n    if (USER_AGENT && !headers.has('user-agent')) {\n        headers.set('user-agent', USER_AGENT);\n    }\n    if (headers.has('authorization')) {\n        throw new TypeError('\"options.headers\" must not include the \"authorization\" header name');\n    }\n    if (headers.has('dpop')) {\n        throw new TypeError('\"options.headers\" must not include the \"dpop\" header name');\n    }\n    return headers;\n}\nfunction signal(value) {\n    if (typeof value === 'function') {\n        value = value();\n    }\n    if (!(value instanceof AbortSignal)) {\n        throw new TypeError('\"options.signal\" must return or be an instance of AbortSignal');\n    }\n    return value;\n}\nexport async function discoveryRequest(issuerIdentifier, options) {\n    if (!(issuerIdentifier instanceof URL)) {\n        throw new TypeError('\"issuerIdentifier\" must be an instance of URL');\n    }\n    if (issuerIdentifier.protocol !== 'https:' && issuerIdentifier.protocol !== 'http:') {\n        throw new TypeError('\"issuer.protocol\" must be \"https:\" or \"http:\"');\n    }\n    const url = new URL(issuerIdentifier.href);\n    switch (options?.algorithm) {\n        case undefined:\n        case 'oidc':\n            url.pathname = `${url.pathname}/.well-known/openid-configuration`.replace('//', '/');\n            break;\n        case 'oauth2':\n            if (url.pathname === '/') {\n                url.pathname = '.well-known/oauth-authorization-server';\n            }\n            else {\n                url.pathname = `.well-known/oauth-authorization-server/${url.pathname}`.replace('//', '/');\n            }\n            break;\n        default:\n            throw new TypeError('\"options.algorithm\" must be \"oidc\" (default), or \"oauth2\"');\n    }\n    const headers = prepareHeaders(options?.headers);\n    headers.set('accept', 'application/json');\n    return (options?.[customFetch] || fetch)(url.href, {\n        headers: Object.fromEntries(headers.entries()),\n        method: 'GET',\n        redirect: 'manual',\n        signal: options?.signal ? signal(options.signal) : null,\n    }).then(processDpopNonce);\n}\nfunction validateString(input) {\n    return typeof input === 'string' && input.length !== 0;\n}\nexport async function processDiscoveryResponse(expectedIssuerIdentifier, response) {\n    if (!(expectedIssuerIdentifier instanceof URL)) {\n        throw new TypeError('\"expectedIssuer\" must be an instance of URL');\n    }\n    if (!looseInstanceOf(response, Response)) {\n        throw new TypeError('\"response\" must be an instance of Response');\n    }\n    if (response.status !== 200) {\n        throw new OPE('\"response\" is not a conform Authorization Server Metadata response');\n    }\n    assertReadableResponse(response);\n    let json;\n    try {\n        json = await response.json();\n    }\n    catch (cause) {\n        throw new OPE('failed to parse \"response\" body as JSON', { cause });\n    }\n    if (!isJsonObject(json)) {\n        throw new OPE('\"response\" body must be a top level object');\n    }\n    if (!validateString(json.issuer)) {\n        throw new OPE('\"response\" body \"issuer\" property must be a non-empty string');\n    }\n    if (new URL(json.issuer).href !== expectedIssuerIdentifier.href) {\n        throw new OPE('\"response\" body \"issuer\" does not match \"expectedIssuer\"');\n    }\n    return json;\n}\nfunction randomBytes() {\n    return b64u(crypto.getRandomValues(new Uint8Array(32)));\n}\nexport function generateRandomCodeVerifier() {\n    return randomBytes();\n}\nexport function generateRandomState() {\n    return randomBytes();\n}\nexport function generateRandomNonce() {\n    return randomBytes();\n}\nexport async function calculatePKCECodeChallenge(codeVerifier) {\n    if (!validateString(codeVerifier)) {\n        throw new TypeError('\"codeVerifier\" must be a non-empty string');\n    }\n    return b64u(await crypto.subtle.digest('SHA-256', buf(codeVerifier)));\n}\nfunction getKeyAndKid(input) {\n    if (input instanceof CryptoKey) {\n        return { key: input };\n    }\n    if (!(input?.key instanceof CryptoKey)) {\n        return {};\n    }\n    if (input.kid !== undefined && !validateString(input.kid)) {\n        throw new TypeError('\"kid\" must be a non-empty string');\n    }\n    return {\n        key: input.key,\n        kid: input.kid,\n        modifyAssertion: input[modifyAssertion],\n    };\n}\nfunction formUrlEncode(token) {\n    return encodeURIComponent(token).replace(/%20/g, '+');\n}\nfunction clientSecretBasic(clientId, clientSecret) {\n    const username = formUrlEncode(clientId);\n    const password = formUrlEncode(clientSecret);\n    const credentials = btoa(`${username}:${password}`);\n    return `Basic ${credentials}`;\n}\nfunction psAlg(key) {\n    switch (key.algorithm.hash.name) {\n        case 'SHA-256':\n            return 'PS256';\n        case 'SHA-384':\n            return 'PS384';\n        case 'SHA-512':\n            return 'PS512';\n        default:\n            throw new UnsupportedOperationError('unsupported RsaHashedKeyAlgorithm hash name');\n    }\n}\nfunction rsAlg(key) {\n    switch (key.algorithm.hash.name) {\n        case 'SHA-256':\n            return 'RS256';\n        case 'SHA-384':\n            return 'RS384';\n        case 'SHA-512':\n            return 'RS512';\n        default:\n            throw new UnsupportedOperationError('unsupported RsaHashedKeyAlgorithm hash name');\n    }\n}\nfunction esAlg(key) {\n    switch (key.algorithm.namedCurve) {\n        case 'P-256':\n            return 'ES256';\n        case 'P-384':\n            return 'ES384';\n        case 'P-521':\n            return 'ES512';\n        default:\n            throw new UnsupportedOperationError('unsupported EcKeyAlgorithm namedCurve');\n    }\n}\nfunction keyToJws(key) {\n    switch (key.algorithm.name) {\n        case 'RSA-PSS':\n            return psAlg(key);\n        case 'RSASSA-PKCS1-v1_5':\n            return rsAlg(key);\n        case 'ECDSA':\n            return esAlg(key);\n        case 'Ed25519':\n        case 'Ed448':\n            return 'EdDSA';\n        default:\n            throw new UnsupportedOperationError('unsupported CryptoKey algorithm name');\n    }\n}\nfunction getClockSkew(client) {\n    const skew = client?.[clockSkew];\n    return typeof skew === 'number' && Number.isFinite(skew) ? skew : 0;\n}\nfunction getClockTolerance(client) {\n    const tolerance = client?.[clockTolerance];\n    return typeof tolerance === 'number' && Number.isFinite(tolerance) && Math.sign(tolerance) !== -1\n        ? tolerance\n        : 30;\n}\nfunction epochTime() {\n    return Math.floor(Date.now() / 1000);\n}\nfunction clientAssertion(as, client) {\n    const now = epochTime() + getClockSkew(client);\n    return {\n        jti: randomBytes(),\n        aud: [as.issuer, as.token_endpoint],\n        exp: now + 60,\n        iat: now,\n        nbf: now,\n        iss: client.client_id,\n        sub: client.client_id,\n    };\n}\nasync function privateKeyJwt(as, client, key, kid, modifyAssertion) {\n    const header = { alg: keyToJws(key), kid };\n    const payload = clientAssertion(as, client);\n    modifyAssertion?.(header, payload);\n    return jwt(header, payload, key);\n}\nfunction assertAs(as) {\n    if (typeof as !== 'object' || as === null) {\n        throw new TypeError('\"as\" must be an object');\n    }\n    if (!validateString(as.issuer)) {\n        throw new TypeError('\"as.issuer\" property must be a non-empty string');\n    }\n    return true;\n}\nfunction assertClient(client) {\n    if (typeof client !== 'object' || client === null) {\n        throw new TypeError('\"client\" must be an object');\n    }\n    if (!validateString(client.client_id)) {\n        throw new TypeError('\"client.client_id\" property must be a non-empty string');\n    }\n    return true;\n}\nfunction assertClientSecret(clientSecret) {\n    if (!validateString(clientSecret)) {\n        throw new TypeError('\"client.client_secret\" property must be a non-empty string');\n    }\n    return clientSecret;\n}\nfunction assertNoClientPrivateKey(clientAuthMethod, clientPrivateKey) {\n    if (clientPrivateKey !== undefined) {\n        throw new TypeError(`\"options.clientPrivateKey\" property must not be provided when ${clientAuthMethod} client authentication method is used.`);\n    }\n}\nfunction assertNoClientSecret(clientAuthMethod, clientSecret) {\n    if (clientSecret !== undefined) {\n        throw new TypeError(`\"client.client_secret\" property must not be provided when ${clientAuthMethod} client authentication method is used.`);\n    }\n}\nasync function clientAuthentication(as, client, body, headers, clientPrivateKey) {\n    body.delete('client_secret');\n    body.delete('client_assertion_type');\n    body.delete('client_assertion');\n    switch (client.token_endpoint_auth_method) {\n        case undefined:\n        case 'client_secret_basic': {\n            assertNoClientPrivateKey('client_secret_basic', clientPrivateKey);\n            headers.set('authorization', clientSecretBasic(client.client_id, assertClientSecret(client.client_secret)));\n            break;\n        }\n        case 'client_secret_post': {\n            assertNoClientPrivateKey('client_secret_post', clientPrivateKey);\n            body.set('client_id', client.client_id);\n            body.set('client_secret', assertClientSecret(client.client_secret));\n            break;\n        }\n        case 'private_key_jwt': {\n            assertNoClientSecret('private_key_jwt', client.client_secret);\n            if (clientPrivateKey === undefined) {\n                throw new TypeError('\"options.clientPrivateKey\" must be provided when \"client.token_endpoint_auth_method\" is \"private_key_jwt\"');\n            }\n            const { key, kid, modifyAssertion } = getKeyAndKid(clientPrivateKey);\n            if (!isPrivateKey(key)) {\n                throw new TypeError('\"options.clientPrivateKey.key\" must be a private CryptoKey');\n            }\n            body.set('client_id', client.client_id);\n            body.set('client_assertion_type', 'urn:ietf:params:oauth:client-assertion-type:jwt-bearer');\n            body.set('client_assertion', await privateKeyJwt(as, client, key, kid, modifyAssertion));\n            break;\n        }\n        case 'tls_client_auth':\n        case 'self_signed_tls_client_auth':\n        case 'none': {\n            assertNoClientSecret(client.token_endpoint_auth_method, client.client_secret);\n            assertNoClientPrivateKey(client.token_endpoint_auth_method, clientPrivateKey);\n            body.set('client_id', client.client_id);\n            break;\n        }\n        default:\n            throw new UnsupportedOperationError('unsupported client token_endpoint_auth_method');\n    }\n}\nasync function jwt(header, payload, key) {\n    if (!key.usages.includes('sign')) {\n        throw new TypeError('CryptoKey instances used for signing assertions must include \"sign\" in their \"usages\"');\n    }\n    const input = `${b64u(buf(JSON.stringify(header)))}.${b64u(buf(JSON.stringify(payload)))}`;\n    const signature = b64u(await crypto.subtle.sign(keyToSubtle(key), key, buf(input)));\n    return `${input}.${signature}`;\n}\nexport async function issueRequestObject(as, client, parameters, privateKey) {\n    assertAs(as);\n    assertClient(client);\n    parameters = new URLSearchParams(parameters);\n    const { key, kid, modifyAssertion } = getKeyAndKid(privateKey);\n    if (!isPrivateKey(key)) {\n        throw new TypeError('\"privateKey.key\" must be a private CryptoKey');\n    }\n    parameters.set('client_id', client.client_id);\n    const now = epochTime() + getClockSkew(client);\n    const claims = {\n        ...Object.fromEntries(parameters.entries()),\n        jti: randomBytes(),\n        aud: as.issuer,\n        exp: now + 60,\n        iat: now,\n        nbf: now,\n        iss: client.client_id,\n    };\n    let resource;\n    if (parameters.has('resource') &&\n        (resource = parameters.getAll('resource')) &&\n        resource.length > 1) {\n        claims.resource = resource;\n    }\n    {\n        let value = parameters.get('max_age');\n        if (value !== null) {\n            claims.max_age = parseInt(value, 10);\n            if (!Number.isFinite(claims.max_age)) {\n                throw new OPE('\"max_age\" parameter must be a number');\n            }\n        }\n    }\n    {\n        let value = parameters.get('claims');\n        if (value !== null) {\n            try {\n                claims.claims = JSON.parse(value);\n            }\n            catch (cause) {\n                throw new OPE('failed to parse the \"claims\" parameter as JSON', { cause });\n            }\n            if (!isJsonObject(claims.claims)) {\n                throw new OPE('\"claims\" parameter must be a JSON with a top level object');\n            }\n        }\n    }\n    {\n        let value = parameters.get('authorization_details');\n        if (value !== null) {\n            try {\n                claims.authorization_details = JSON.parse(value);\n            }\n            catch (cause) {\n                throw new OPE('failed to parse the \"authorization_details\" parameter as JSON', { cause });\n            }\n            if (!Array.isArray(claims.authorization_details)) {\n                throw new OPE('\"authorization_details\" parameter must be a JSON with a top level array');\n            }\n        }\n    }\n    const header = {\n        alg: keyToJws(key),\n        typ: 'oauth-authz-req+jwt',\n        kid,\n    };\n    modifyAssertion?.(header, claims);\n    return jwt(header, claims, key);\n}\nasync function dpopProofJwt(headers, options, url, htm, clockSkew, accessToken) {\n    const { privateKey, publicKey, nonce = dpopNonces.get(url.origin) } = options;\n    if (!isPrivateKey(privateKey)) {\n        throw new TypeError('\"DPoP.privateKey\" must be a private CryptoKey');\n    }\n    if (!isPublicKey(publicKey)) {\n        throw new TypeError('\"DPoP.publicKey\" must be a public CryptoKey');\n    }\n    if (nonce !== undefined && !validateString(nonce)) {\n        throw new TypeError('\"DPoP.nonce\" must be a non-empty string or undefined');\n    }\n    if (!publicKey.extractable) {\n        throw new TypeError('\"DPoP.publicKey.extractable\" must be true');\n    }\n    const now = epochTime() + clockSkew;\n    const header = {\n        alg: keyToJws(privateKey),\n        typ: 'dpop+jwt',\n        jwk: await publicJwk(publicKey),\n    };\n    const payload = {\n        iat: now,\n        jti: randomBytes(),\n        htm,\n        nonce,\n        htu: `${url.origin}${url.pathname}`,\n        ath: accessToken ? b64u(await crypto.subtle.digest('SHA-256', buf(accessToken))) : undefined,\n    };\n    options[modifyAssertion]?.(header, payload);\n    headers.set('dpop', await jwt(header, payload, privateKey));\n}\nlet jwkCache;\nasync function getSetPublicJwkCache(key) {\n    const { kty, e, n, x, y, crv } = await crypto.subtle.exportKey('jwk', key);\n    const jwk = { kty, e, n, x, y, crv };\n    jwkCache.set(key, jwk);\n    return jwk;\n}\nasync function publicJwk(key) {\n    jwkCache || (jwkCache = new WeakMap());\n    return jwkCache.get(key) || getSetPublicJwkCache(key);\n}\nfunction validateEndpoint(value, endpoint, useMtlsAlias) {\n    if (typeof value !== 'string') {\n        if (useMtlsAlias) {\n            throw new TypeError(`\"as.mtls_endpoint_aliases.${endpoint}\" must be a string`);\n        }\n        throw new TypeError(`\"as.${endpoint}\" must be a string`);\n    }\n    return new URL(value);\n}\nfunction resolveEndpoint(as, endpoint, useMtlsAlias = false) {\n    if (useMtlsAlias && as.mtls_endpoint_aliases && endpoint in as.mtls_endpoint_aliases) {\n        return validateEndpoint(as.mtls_endpoint_aliases[endpoint], endpoint, useMtlsAlias);\n    }\n    return validateEndpoint(as[endpoint], endpoint, useMtlsAlias);\n}\nfunction alias(client, options) {\n    if (client.use_mtls_endpoint_aliases || options?.[useMtlsAlias]) {\n        return true;\n    }\n    return false;\n}\nexport async function pushedAuthorizationRequest(as, client, parameters, options) {\n    assertAs(as);\n    assertClient(client);\n    const url = resolveEndpoint(as, 'pushed_authorization_request_endpoint', alias(client, options));\n    const body = new URLSearchParams(parameters);\n    body.set('client_id', client.client_id);\n    const headers = prepareHeaders(options?.headers);\n    headers.set('accept', 'application/json');\n    if (options?.DPoP !== undefined) {\n        await dpopProofJwt(headers, options.DPoP, url, 'POST', getClockSkew(client));\n    }\n    return authenticatedRequest(as, client, 'POST', url, body, headers, options);\n}\nexport function isOAuth2Error(input) {\n    const value = input;\n    if (typeof value !== 'object' || Array.isArray(value) || value === null) {\n        return false;\n    }\n    return value.error !== undefined;\n}\nfunction unquote(value) {\n    if (value.length >= 2 && value[0] === '\"' && value[value.length - 1] === '\"') {\n        return value.slice(1, -1);\n    }\n    return value;\n}\nconst SPLIT_REGEXP = /((?:,|, )?[0-9a-zA-Z!#$%&'*+-.^_`|~]+=)/;\nconst SCHEMES_REGEXP = /(?:^|, ?)([0-9a-zA-Z!#$%&'*+\\-.^_`|~]+)(?=$|[ ,])/g;\nfunction wwwAuth(scheme, params) {\n    const arr = params.split(SPLIT_REGEXP).slice(1);\n    if (!arr.length) {\n        return { scheme: scheme.toLowerCase(), parameters: {} };\n    }\n    arr[arr.length - 1] = arr[arr.length - 1].replace(/,$/, '');\n    const parameters = {};\n    for (let i = 1; i < arr.length; i += 2) {\n        const idx = i;\n        if (arr[idx][0] === '\"') {\n            while (arr[idx].slice(-1) !== '\"' && ++i < arr.length) {\n                arr[idx] += arr[i];\n            }\n        }\n        const key = arr[idx - 1].replace(/^(?:, ?)|=$/g, '').toLowerCase();\n        parameters[key] = unquote(arr[idx]);\n    }\n    return {\n        scheme: scheme.toLowerCase(),\n        parameters,\n    };\n}\nexport function parseWwwAuthenticateChallenges(response) {\n    if (!looseInstanceOf(response, Response)) {\n        throw new TypeError('\"response\" must be an instance of Response');\n    }\n    const header = response.headers.get('www-authenticate');\n    if (header === null) {\n        return undefined;\n    }\n    const result = [];\n    for (const { 1: scheme, index } of header.matchAll(SCHEMES_REGEXP)) {\n        result.push([scheme, index]);\n    }\n    if (!result.length) {\n        return undefined;\n    }\n    const challenges = result.map(([scheme, indexOf], i, others) => {\n        const next = others[i + 1];\n        let parameters;\n        if (next) {\n            parameters = header.slice(indexOf, next[1]);\n        }\n        else {\n            parameters = header.slice(indexOf);\n        }\n        return wwwAuth(scheme, parameters);\n    });\n    return challenges;\n}\nexport async function processPushedAuthorizationResponse(as, client, response) {\n    assertAs(as);\n    assertClient(client);\n    if (!looseInstanceOf(response, Response)) {\n        throw new TypeError('\"response\" must be an instance of Response');\n    }\n    if (response.status !== 201) {\n        let err;\n        if ((err = await handleOAuthBodyError(response))) {\n            return err;\n        }\n        throw new OPE('\"response\" is not a conform Pushed Authorization Request Endpoint response');\n    }\n    assertReadableResponse(response);\n    let json;\n    try {\n        json = await response.json();\n    }\n    catch (cause) {\n        throw new OPE('failed to parse \"response\" body as JSON', { cause });\n    }\n    if (!isJsonObject(json)) {\n        throw new OPE('\"response\" body must be a top level object');\n    }\n    if (!validateString(json.request_uri)) {\n        throw new OPE('\"response\" body \"request_uri\" property must be a non-empty string');\n    }\n    if (typeof json.expires_in !== 'number' || json.expires_in <= 0) {\n        throw new OPE('\"response\" body \"expires_in\" property must be a positive number');\n    }\n    return json;\n}\nexport async function protectedResourceRequest(accessToken, method, url, headers, body, options) {\n    if (!validateString(accessToken)) {\n        throw new TypeError('\"accessToken\" must be a non-empty string');\n    }\n    if (!(url instanceof URL)) {\n        throw new TypeError('\"url\" must be an instance of URL');\n    }\n    headers = prepareHeaders(headers);\n    if (options?.DPoP === undefined) {\n        headers.set('authorization', `Bearer ${accessToken}`);\n    }\n    else {\n        await dpopProofJwt(headers, options.DPoP, url, method.toUpperCase(), getClockSkew({ [clockSkew]: options?.[clockSkew] }), accessToken);\n        headers.set('authorization', `DPoP ${accessToken}`);\n    }\n    return (options?.[customFetch] || fetch)(url.href, {\n        body,\n        headers: Object.fromEntries(headers.entries()),\n        method,\n        redirect: 'manual',\n        signal: options?.signal ? signal(options.signal) : null,\n    }).then(processDpopNonce);\n}\nexport async function userInfoRequest(as, client, accessToken, options) {\n    assertAs(as);\n    assertClient(client);\n    const url = resolveEndpoint(as, 'userinfo_endpoint', alias(client, options));\n    const headers = prepareHeaders(options?.headers);\n    if (client.userinfo_signed_response_alg) {\n        headers.set('accept', 'application/jwt');\n    }\n    else {\n        headers.set('accept', 'application/json');\n        headers.append('accept', 'application/jwt');\n    }\n    return protectedResourceRequest(accessToken, 'GET', url, headers, null, {\n        ...options,\n        [clockSkew]: getClockSkew(client),\n    });\n}\nlet jwksMap;\nfunction setJwksCache(as, jwks, uat, cache) {\n    jwksMap || (jwksMap = new WeakMap());\n    jwksMap.set(as, {\n        jwks,\n        uat,\n        get age() {\n            return epochTime() - this.uat;\n        },\n    });\n    if (cache) {\n        Object.assign(cache, { jwks: structuredClone(jwks), uat });\n    }\n}\nfunction isFreshJwksCache(input) {\n    if (typeof input !== 'object' || input === null) {\n        return false;\n    }\n    if (!('uat' in input) || typeof input.uat !== 'number' || epochTime() - input.uat >= 300) {\n        return false;\n    }\n    if (!('jwks' in input) ||\n        !isJsonObject(input.jwks) ||\n        !Array.isArray(input.jwks.keys) ||\n        !Array.prototype.every.call(input.jwks.keys, isJsonObject)) {\n        return false;\n    }\n    return true;\n}\nfunction clearJwksCache(as, cache) {\n    jwksMap?.delete(as);\n    delete cache?.jwks;\n    delete cache?.uat;\n}\nasync function getPublicSigKeyFromIssuerJwksUri(as, options, header) {\n    const { alg, kid } = header;\n    checkSupportedJwsAlg(alg);\n    if (!jwksMap?.has(as) && isFreshJwksCache(options?.[jwksCache])) {\n        setJwksCache(as, options?.[jwksCache].jwks, options?.[jwksCache].uat);\n    }\n    let jwks;\n    let age;\n    if (jwksMap?.has(as)) {\n        ;\n        ({ jwks, age } = jwksMap.get(as));\n        if (age >= 300) {\n            clearJwksCache(as, options?.[jwksCache]);\n            return getPublicSigKeyFromIssuerJwksUri(as, options, header);\n        }\n    }\n    else {\n        jwks = await jwksRequest(as, options).then(processJwksResponse);\n        age = 0;\n        setJwksCache(as, jwks, epochTime(), options?.[jwksCache]);\n    }\n    let kty;\n    switch (alg.slice(0, 2)) {\n        case 'RS':\n        case 'PS':\n            kty = 'RSA';\n            break;\n        case 'ES':\n            kty = 'EC';\n            break;\n        case 'Ed':\n            kty = 'OKP';\n            break;\n        default:\n            throw new UnsupportedOperationError();\n    }\n    const candidates = jwks.keys.filter((jwk) => {\n        if (jwk.kty !== kty) {\n            return false;\n        }\n        if (kid !== undefined && kid !== jwk.kid) {\n            return false;\n        }\n        if (jwk.alg !== undefined && alg !== jwk.alg) {\n            return false;\n        }\n        if (jwk.use !== undefined && jwk.use !== 'sig') {\n            return false;\n        }\n        if (jwk.key_ops?.includes('verify') === false) {\n            return false;\n        }\n        switch (true) {\n            case alg === 'ES256' && jwk.crv !== 'P-256':\n            case alg === 'ES384' && jwk.crv !== 'P-384':\n            case alg === 'ES512' && jwk.crv !== 'P-521':\n            case alg === 'EdDSA' && !(jwk.crv === 'Ed25519' || jwk.crv === 'Ed448'):\n                return false;\n        }\n        return true;\n    });\n    const { 0: jwk, length } = candidates;\n    if (!length) {\n        if (age >= 60) {\n            clearJwksCache(as, options?.[jwksCache]);\n            return getPublicSigKeyFromIssuerJwksUri(as, options, header);\n        }\n        throw new OPE('error when selecting a JWT verification key, no applicable keys found');\n    }\n    if (length !== 1) {\n        throw new OPE('error when selecting a JWT verification key, multiple applicable keys found, a \"kid\" JWT Header Parameter is required');\n    }\n    const key = await importJwk(alg, jwk);\n    if (key.type !== 'public') {\n        throw new OPE('jwks_uri must only contain public keys');\n    }\n    return key;\n}\nexport const skipSubjectCheck = Symbol();\nfunction getContentType(response) {\n    return response.headers.get('content-type')?.split(';')[0];\n}\nexport async function processUserInfoResponse(as, client, expectedSubject, response) {\n    assertAs(as);\n    assertClient(client);\n    if (!looseInstanceOf(response, Response)) {\n        throw new TypeError('\"response\" must be an instance of Response');\n    }\n    if (response.status !== 200) {\n        throw new OPE('\"response\" is not a conform UserInfo Endpoint response');\n    }\n    let json;\n    if (getContentType(response) === 'application/jwt') {\n        assertReadableResponse(response);\n        const { claims, jwt } = await validateJwt(await response.text(), checkSigningAlgorithm.bind(undefined, client.userinfo_signed_response_alg, as.userinfo_signing_alg_values_supported), noSignatureCheck, getClockSkew(client), getClockTolerance(client), client[jweDecrypt])\n            .then(validateOptionalAudience.bind(undefined, client.client_id))\n            .then(validateOptionalIssuer.bind(undefined, as.issuer));\n        jwtResponseBodies.set(response, jwt);\n        json = claims;\n    }\n    else {\n        if (client.userinfo_signed_response_alg) {\n            throw new OPE('JWT UserInfo Response expected');\n        }\n        assertReadableResponse(response);\n        try {\n            json = await response.json();\n        }\n        catch (cause) {\n            throw new OPE('failed to parse \"response\" body as JSON', { cause });\n        }\n    }\n    if (!isJsonObject(json)) {\n        throw new OPE('\"response\" body must be a top level object');\n    }\n    if (!validateString(json.sub)) {\n        throw new OPE('\"response\" body \"sub\" property must be a non-empty string');\n    }\n    switch (expectedSubject) {\n        case skipSubjectCheck:\n            break;\n        default:\n            if (!validateString(expectedSubject)) {\n                throw new OPE('\"expectedSubject\" must be a non-empty string');\n            }\n            if (json.sub !== expectedSubject) {\n                throw new OPE('unexpected \"response\" body \"sub\" value');\n            }\n    }\n    return json;\n}\nasync function authenticatedRequest(as, client, method, url, body, headers, options) {\n    await clientAuthentication(as, client, body, headers, options?.clientPrivateKey);\n    headers.set('content-type', 'application/x-www-form-urlencoded;charset=UTF-8');\n    return (options?.[customFetch] || fetch)(url.href, {\n        body,\n        headers: Object.fromEntries(headers.entries()),\n        method,\n        redirect: 'manual',\n        signal: options?.signal ? signal(options.signal) : null,\n    }).then(processDpopNonce);\n}\nasync function tokenEndpointRequest(as, client, grantType, parameters, options) {\n    const url = resolveEndpoint(as, 'token_endpoint', alias(client, options));\n    parameters.set('grant_type', grantType);\n    const headers = prepareHeaders(options?.headers);\n    headers.set('accept', 'application/json');\n    if (options?.DPoP !== undefined) {\n        await dpopProofJwt(headers, options.DPoP, url, 'POST', getClockSkew(client));\n    }\n    return authenticatedRequest(as, client, 'POST', url, parameters, headers, options);\n}\nexport async function refreshTokenGrantRequest(as, client, refreshToken, options) {\n    assertAs(as);\n    assertClient(client);\n    if (!validateString(refreshToken)) {\n        throw new TypeError('\"refreshToken\" must be a non-empty string');\n    }\n    const parameters = new URLSearchParams(options?.additionalParameters);\n    parameters.set('refresh_token', refreshToken);\n    return tokenEndpointRequest(as, client, 'refresh_token', parameters, options);\n}\nconst idTokenClaims = new WeakMap();\nconst jwtResponseBodies = new WeakMap();\nexport function getValidatedIdTokenClaims(ref) {\n    if (!ref.id_token) {\n        return undefined;\n    }\n    const claims = idTokenClaims.get(ref);\n    if (!claims) {\n        throw new TypeError('\"ref\" was already garbage collected or did not resolve from the proper sources');\n    }\n    return claims[0];\n}\nexport async function validateIdTokenSignature(as, ref, options) {\n    assertAs(as);\n    if (!idTokenClaims.has(ref)) {\n        throw new OPE('\"ref\" does not contain an ID Token to verify the signature of');\n    }\n    const { 0: protectedHeader, 1: payload, 2: encodedSignature, } = idTokenClaims.get(ref)[1].split('.');\n    const header = JSON.parse(buf(b64u(protectedHeader)));\n    if (header.alg.startsWith('HS')) {\n        throw new UnsupportedOperationError();\n    }\n    let key;\n    key = await getPublicSigKeyFromIssuerJwksUri(as, options, header);\n    await validateJwsSignature(protectedHeader, payload, key, b64u(encodedSignature));\n}\nasync function validateJwtResponseSignature(as, ref, options) {\n    assertAs(as);\n    if (!jwtResponseBodies.has(ref)) {\n        throw new OPE('\"ref\" does not contain a processed JWT Response to verify the signature of');\n    }\n    const { 0: protectedHeader, 1: payload, 2: encodedSignature, } = jwtResponseBodies.get(ref).split('.');\n    const header = JSON.parse(buf(b64u(protectedHeader)));\n    if (header.alg.startsWith('HS')) {\n        throw new UnsupportedOperationError();\n    }\n    let key;\n    key = await getPublicSigKeyFromIssuerJwksUri(as, options, header);\n    await validateJwsSignature(protectedHeader, payload, key, b64u(encodedSignature));\n}\nexport function validateJwtUserInfoSignature(as, ref, options) {\n    return validateJwtResponseSignature(as, ref, options);\n}\nexport function validateJwtIntrospectionSignature(as, ref, options) {\n    return validateJwtResponseSignature(as, ref, options);\n}\nasync function processGenericAccessTokenResponse(as, client, response, ignoreIdToken = false, ignoreRefreshToken = false) {\n    assertAs(as);\n    assertClient(client);\n    if (!looseInstanceOf(response, Response)) {\n        throw new TypeError('\"response\" must be an instance of Response');\n    }\n    if (response.status !== 200) {\n        let err;\n        if ((err = await handleOAuthBodyError(response))) {\n            return err;\n        }\n        throw new OPE('\"response\" is not a conform Token Endpoint response');\n    }\n    assertReadableResponse(response);\n    let json;\n    try {\n        json = await response.json();\n    }\n    catch (cause) {\n        throw new OPE('failed to parse \"response\" body as JSON', { cause });\n    }\n    if (!isJsonObject(json)) {\n        throw new OPE('\"response\" body must be a top level object');\n    }\n    if (!validateString(json.access_token)) {\n        throw new OPE('\"response\" body \"access_token\" property must be a non-empty string');\n    }\n    if (!validateString(json.token_type)) {\n        throw new OPE('\"response\" body \"token_type\" property must be a non-empty string');\n    }\n    json.token_type = json.token_type.toLowerCase();\n    if (json.token_type !== 'dpop' && json.token_type !== 'bearer') {\n        throw new UnsupportedOperationError('unsupported `token_type` value');\n    }\n    if (json.expires_in !== undefined &&\n        (typeof json.expires_in !== 'number' || json.expires_in <= 0)) {\n        throw new OPE('\"response\" body \"expires_in\" property must be a positive number');\n    }\n    if (!ignoreRefreshToken &&\n        json.refresh_token !== undefined &&\n        !validateString(json.refresh_token)) {\n        throw new OPE('\"response\" body \"refresh_token\" property must be a non-empty string');\n    }\n    if (json.scope !== undefined && typeof json.scope !== 'string') {\n        throw new OPE('\"response\" body \"scope\" property must be a string');\n    }\n    if (!ignoreIdToken) {\n        if (json.id_token !== undefined && !validateString(json.id_token)) {\n            throw new OPE('\"response\" body \"id_token\" property must be a non-empty string');\n        }\n        if (json.id_token) {\n            const { claims, jwt } = await validateJwt(json.id_token, checkSigningAlgorithm.bind(undefined, client.id_token_signed_response_alg, as.id_token_signing_alg_values_supported), noSignatureCheck, getClockSkew(client), getClockTolerance(client), client[jweDecrypt])\n                .then(validatePresence.bind(undefined, ['aud', 'exp', 'iat', 'iss', 'sub']))\n                .then(validateIssuer.bind(undefined, as.issuer))\n                .then(validateAudience.bind(undefined, client.client_id));\n            if (Array.isArray(claims.aud) && claims.aud.length !== 1) {\n                if (claims.azp === undefined) {\n                    throw new OPE('ID Token \"aud\" (audience) claim includes additional untrusted audiences');\n                }\n                if (claims.azp !== client.client_id) {\n                    throw new OPE('unexpected ID Token \"azp\" (authorized party) claim value');\n                }\n            }\n            if (claims.auth_time !== undefined &&\n                (!Number.isFinite(claims.auth_time) || Math.sign(claims.auth_time) !== 1)) {\n                throw new OPE('ID Token \"auth_time\" (authentication time) must be a positive number');\n            }\n            idTokenClaims.set(json, [claims, jwt]);\n        }\n    }\n    return json;\n}\nexport async function processRefreshTokenResponse(as, client, response) {\n    return processGenericAccessTokenResponse(as, client, response);\n}\nfunction validateOptionalAudience(expected, result) {\n    if (result.claims.aud !== undefined) {\n        return validateAudience(expected, result);\n    }\n    return result;\n}\nfunction validateAudience(expected, result) {\n    if (Array.isArray(result.claims.aud)) {\n        if (!result.claims.aud.includes(expected)) {\n            throw new OPE('unexpected JWT \"aud\" (audience) claim value');\n        }\n    }\n    else if (result.claims.aud !== expected) {\n        throw new OPE('unexpected JWT \"aud\" (audience) claim value');\n    }\n    return result;\n}\nfunction validateOptionalIssuer(expected, result) {\n    if (result.claims.iss !== undefined) {\n        return validateIssuer(expected, result);\n    }\n    return result;\n}\nfunction validateIssuer(expected, result) {\n    if (result.claims.iss !== expected) {\n        throw new OPE('unexpected JWT \"iss\" (issuer) claim value');\n    }\n    return result;\n}\nconst branded = new WeakSet();\nfunction brand(searchParams) {\n    branded.add(searchParams);\n    return searchParams;\n}\nexport async function authorizationCodeGrantRequest(as, client, callbackParameters, redirectUri, codeVerifier, options) {\n    assertAs(as);\n    assertClient(client);\n    if (!branded.has(callbackParameters)) {\n        throw new TypeError('\"callbackParameters\" must be an instance of URLSearchParams obtained from \"validateAuthResponse()\", or \"validateJwtAuthResponse()');\n    }\n    if (!validateString(redirectUri)) {\n        throw new TypeError('\"redirectUri\" must be a non-empty string');\n    }\n    if (!validateString(codeVerifier)) {\n        throw new TypeError('\"codeVerifier\" must be a non-empty string');\n    }\n    const code = getURLSearchParameter(callbackParameters, 'code');\n    if (!code) {\n        throw new OPE('no authorization code in \"callbackParameters\"');\n    }\n    const parameters = new URLSearchParams(options?.additionalParameters);\n    parameters.set('redirect_uri', redirectUri);\n    parameters.set('code_verifier', codeVerifier);\n    parameters.set('code', code);\n    return tokenEndpointRequest(as, client, 'authorization_code', parameters, options);\n}\nconst jwtClaimNames = {\n    aud: 'audience',\n    c_hash: 'code hash',\n    client_id: 'client id',\n    exp: 'expiration time',\n    iat: 'issued at',\n    iss: 'issuer',\n    jti: 'jwt id',\n    nonce: 'nonce',\n    s_hash: 'state hash',\n    sub: 'subject',\n    ath: 'access token hash',\n    htm: 'http method',\n    htu: 'http uri',\n    cnf: 'confirmation',\n};\nfunction validatePresence(required, result) {\n    for (const claim of required) {\n        if (result.claims[claim] === undefined) {\n            throw new OPE(`JWT \"${claim}\" (${jwtClaimNames[claim]}) claim missing`);\n        }\n    }\n    return result;\n}\nexport const expectNoNonce = Symbol();\nexport const skipAuthTimeCheck = Symbol();\nexport async function processAuthorizationCodeOpenIDResponse(as, client, response, expectedNonce, maxAge) {\n    const result = await processGenericAccessTokenResponse(as, client, response);\n    if (isOAuth2Error(result)) {\n        return result;\n    }\n    if (!validateString(result.id_token)) {\n        throw new OPE('\"response\" body \"id_token\" property must be a non-empty string');\n    }\n    maxAge ?? (maxAge = client.default_max_age ?? skipAuthTimeCheck);\n    const claims = getValidatedIdTokenClaims(result);\n    if ((client.require_auth_time || maxAge !== skipAuthTimeCheck) &&\n        claims.auth_time === undefined) {\n        throw new OPE('ID Token \"auth_time\" (authentication time) claim missing');\n    }\n    if (maxAge !== skipAuthTimeCheck) {\n        if (typeof maxAge !== 'number' || maxAge < 0) {\n            throw new TypeError('\"maxAge\" must be a non-negative number');\n        }\n        const now = epochTime() + getClockSkew(client);\n        const tolerance = getClockTolerance(client);\n        if (claims.auth_time + maxAge < now - tolerance) {\n            throw new OPE('too much time has elapsed since the last End-User authentication');\n        }\n    }\n    switch (expectedNonce) {\n        case undefined:\n        case expectNoNonce:\n            if (claims.nonce !== undefined) {\n                throw new OPE('unexpected ID Token \"nonce\" claim value');\n            }\n            break;\n        default:\n            if (!validateString(expectedNonce)) {\n                throw new TypeError('\"expectedNonce\" must be a non-empty string');\n            }\n            if (claims.nonce === undefined) {\n                throw new OPE('ID Token \"nonce\" claim missing');\n            }\n            if (claims.nonce !== expectedNonce) {\n                throw new OPE('unexpected ID Token \"nonce\" claim value');\n            }\n    }\n    return result;\n}\nexport async function processAuthorizationCodeOAuth2Response(as, client, response) {\n    const result = await processGenericAccessTokenResponse(as, client, response, true);\n    if (isOAuth2Error(result)) {\n        return result;\n    }\n    if (result.id_token !== undefined) {\n        if (typeof result.id_token === 'string' && result.id_token.length) {\n            throw new OPE('Unexpected ID Token returned, use processAuthorizationCodeOpenIDResponse() for OpenID Connect callback processing');\n        }\n        delete result.id_token;\n    }\n    return result;\n}\nfunction checkJwtType(expected, result) {\n    if (typeof result.header.typ !== 'string' || normalizeTyp(result.header.typ) !== expected) {\n        throw new OPE('unexpected JWT \"typ\" header parameter value');\n    }\n    return result;\n}\nexport async function clientCredentialsGrantRequest(as, client, parameters, options) {\n    assertAs(as);\n    assertClient(client);\n    return tokenEndpointRequest(as, client, 'client_credentials', new URLSearchParams(parameters), options);\n}\nexport async function genericTokenEndpointRequest(as, client, grantType, parameters, options) {\n    assertAs(as);\n    assertClient(client);\n    if (!validateString(grantType)) {\n        throw new TypeError('\"grantType\" must be a non-empty string');\n    }\n    return tokenEndpointRequest(as, client, grantType, new URLSearchParams(parameters), options);\n}\nexport async function processClientCredentialsResponse(as, client, response) {\n    const result = await processGenericAccessTokenResponse(as, client, response, true, true);\n    if (isOAuth2Error(result)) {\n        return result;\n    }\n    return result;\n}\nexport async function revocationRequest(as, client, token, options) {\n    assertAs(as);\n    assertClient(client);\n    if (!validateString(token)) {\n        throw new TypeError('\"token\" must be a non-empty string');\n    }\n    const url = resolveEndpoint(as, 'revocation_endpoint', alias(client, options));\n    const body = new URLSearchParams(options?.additionalParameters);\n    body.set('token', token);\n    const headers = prepareHeaders(options?.headers);\n    headers.delete('accept');\n    return authenticatedRequest(as, client, 'POST', url, body, headers, options);\n}\nexport async function processRevocationResponse(response) {\n    if (!looseInstanceOf(response, Response)) {\n        throw new TypeError('\"response\" must be an instance of Response');\n    }\n    if (response.status !== 200) {\n        let err;\n        if ((err = await handleOAuthBodyError(response))) {\n            return err;\n        }\n        throw new OPE('\"response\" is not a conform Revocation Endpoint response');\n    }\n    return undefined;\n}\nfunction assertReadableResponse(response) {\n    if (response.bodyUsed) {\n        throw new TypeError('\"response\" body has been used already');\n    }\n}\nexport async function introspectionRequest(as, client, token, options) {\n    assertAs(as);\n    assertClient(client);\n    if (!validateString(token)) {\n        throw new TypeError('\"token\" must be a non-empty string');\n    }\n    const url = resolveEndpoint(as, 'introspection_endpoint', alias(client, options));\n    const body = new URLSearchParams(options?.additionalParameters);\n    body.set('token', token);\n    const headers = prepareHeaders(options?.headers);\n    if (options?.requestJwtResponse ?? client.introspection_signed_response_alg) {\n        headers.set('accept', 'application/token-introspection+jwt');\n    }\n    else {\n        headers.set('accept', 'application/json');\n    }\n    return authenticatedRequest(as, client, 'POST', url, body, headers, options);\n}\nexport async function processIntrospectionResponse(as, client, response) {\n    assertAs(as);\n    assertClient(client);\n    if (!looseInstanceOf(response, Response)) {\n        throw new TypeError('\"response\" must be an instance of Response');\n    }\n    if (response.status !== 200) {\n        let err;\n        if ((err = await handleOAuthBodyError(response))) {\n            return err;\n        }\n        throw new OPE('\"response\" is not a conform Introspection Endpoint response');\n    }\n    let json;\n    if (getContentType(response) === 'application/token-introspection+jwt') {\n        assertReadableResponse(response);\n        const { claims, jwt } = await validateJwt(await response.text(), checkSigningAlgorithm.bind(undefined, client.introspection_signed_response_alg, as.introspection_signing_alg_values_supported), noSignatureCheck, getClockSkew(client), getClockTolerance(client), client[jweDecrypt])\n            .then(checkJwtType.bind(undefined, 'token-introspection+jwt'))\n            .then(validatePresence.bind(undefined, ['aud', 'iat', 'iss']))\n            .then(validateIssuer.bind(undefined, as.issuer))\n            .then(validateAudience.bind(undefined, client.client_id));\n        jwtResponseBodies.set(response, jwt);\n        json = claims.token_introspection;\n        if (!isJsonObject(json)) {\n            throw new OPE('JWT \"token_introspection\" claim must be a JSON object');\n        }\n    }\n    else {\n        assertReadableResponse(response);\n        try {\n            json = await response.json();\n        }\n        catch (cause) {\n            throw new OPE('failed to parse \"response\" body as JSON', { cause });\n        }\n        if (!isJsonObject(json)) {\n            throw new OPE('\"response\" body must be a top level object');\n        }\n    }\n    if (typeof json.active !== 'boolean') {\n        throw new OPE('\"response\" body \"active\" property must be a boolean');\n    }\n    return json;\n}\nasync function jwksRequest(as, options) {\n    assertAs(as);\n    const url = resolveEndpoint(as, 'jwks_uri');\n    const headers = prepareHeaders(options?.headers);\n    headers.set('accept', 'application/json');\n    headers.append('accept', 'application/jwk-set+json');\n    return (options?.[customFetch] || fetch)(url.href, {\n        headers: Object.fromEntries(headers.entries()),\n        method: 'GET',\n        redirect: 'manual',\n        signal: options?.signal ? signal(options.signal) : null,\n    }).then(processDpopNonce);\n}\nasync function processJwksResponse(response) {\n    if (!looseInstanceOf(response, Response)) {\n        throw new TypeError('\"response\" must be an instance of Response');\n    }\n    if (response.status !== 200) {\n        throw new OPE('\"response\" is not a conform JSON Web Key Set response');\n    }\n    assertReadableResponse(response);\n    let json;\n    try {\n        json = await response.json();\n    }\n    catch (cause) {\n        throw new OPE('failed to parse \"response\" body as JSON', { cause });\n    }\n    if (!isJsonObject(json)) {\n        throw new OPE('\"response\" body must be a top level object');\n    }\n    if (!Array.isArray(json.keys)) {\n        throw new OPE('\"response\" body \"keys\" property must be an array');\n    }\n    if (!Array.prototype.every.call(json.keys, isJsonObject)) {\n        throw new OPE('\"response\" body \"keys\" property members must be JWK formatted objects');\n    }\n    return json;\n}\nasync function handleOAuthBodyError(response) {\n    if (response.status > 399 && response.status < 500) {\n        assertReadableResponse(response);\n        try {\n            const json = await response.json();\n            if (isJsonObject(json) && typeof json.error === 'string' && json.error.length) {\n                if (json.error_description !== undefined && typeof json.error_description !== 'string') {\n                    delete json.error_description;\n                }\n                if (json.error_uri !== undefined && typeof json.error_uri !== 'string') {\n                    delete json.error_uri;\n                }\n                if (json.algs !== undefined && typeof json.algs !== 'string') {\n                    delete json.algs;\n                }\n                if (json.scope !== undefined && typeof json.scope !== 'string') {\n                    delete json.scope;\n                }\n                return json;\n            }\n        }\n        catch { }\n    }\n    return undefined;\n}\nfunction checkSupportedJwsAlg(alg) {\n    if (!SUPPORTED_JWS_ALGS.includes(alg)) {\n        throw new UnsupportedOperationError('unsupported JWS \"alg\" identifier');\n    }\n    return alg;\n}\nfunction checkRsaKeyAlgorithm(algorithm) {\n    if (typeof algorithm.modulusLength !== 'number' || algorithm.modulusLength < 2048) {\n        throw new OPE(`${algorithm.name} modulusLength must be at least 2048 bits`);\n    }\n}\nfunction ecdsaHashName(namedCurve) {\n    switch (namedCurve) {\n        case 'P-256':\n            return 'SHA-256';\n        case 'P-384':\n            return 'SHA-384';\n        case 'P-521':\n            return 'SHA-512';\n        default:\n            throw new UnsupportedOperationError();\n    }\n}\nfunction keyToSubtle(key) {\n    switch (key.algorithm.name) {\n        case 'ECDSA':\n            return {\n                name: key.algorithm.name,\n                hash: ecdsaHashName(key.algorithm.namedCurve),\n            };\n        case 'RSA-PSS': {\n            checkRsaKeyAlgorithm(key.algorithm);\n            switch (key.algorithm.hash.name) {\n                case 'SHA-256':\n                case 'SHA-384':\n                case 'SHA-512':\n                    return {\n                        name: key.algorithm.name,\n                        saltLength: parseInt(key.algorithm.hash.name.slice(-3), 10) >> 3,\n                    };\n                default:\n                    throw new UnsupportedOperationError();\n            }\n        }\n        case 'RSASSA-PKCS1-v1_5':\n            checkRsaKeyAlgorithm(key.algorithm);\n            return key.algorithm.name;\n        case 'Ed448':\n        case 'Ed25519':\n            return key.algorithm.name;\n    }\n    throw new UnsupportedOperationError();\n}\nconst noSignatureCheck = Symbol();\nasync function validateJwsSignature(protectedHeader, payload, key, signature) {\n    const input = `${protectedHeader}.${payload}`;\n    const verified = await crypto.subtle.verify(keyToSubtle(key), key, signature, buf(input));\n    if (!verified) {\n        throw new OPE('JWT signature verification failed');\n    }\n}\nasync function validateJwt(jws, checkAlg, getKey, clockSkew, clockTolerance, decryptJwt) {\n    let { 0: protectedHeader, 1: payload, 2: encodedSignature, length } = jws.split('.');\n    if (length === 5) {\n        if (decryptJwt !== undefined) {\n            jws = await decryptJwt(jws);\n            ({ 0: protectedHeader, 1: payload, 2: encodedSignature, length } = jws.split('.'));\n        }\n        else {\n            throw new UnsupportedOperationError('JWE structure JWTs are not supported');\n        }\n    }\n    if (length !== 3) {\n        throw new OPE('Invalid JWT');\n    }\n    let header;\n    try {\n        header = JSON.parse(buf(b64u(protectedHeader)));\n    }\n    catch (cause) {\n        throw new OPE('failed to parse JWT Header body as base64url encoded JSON', { cause });\n    }\n    if (!isJsonObject(header)) {\n        throw new OPE('JWT Header must be a top level object');\n    }\n    checkAlg(header);\n    if (header.crit !== undefined) {\n        throw new OPE('unexpected JWT \"crit\" header parameter');\n    }\n    const signature = b64u(encodedSignature);\n    let key;\n    if (getKey !== noSignatureCheck) {\n        key = await getKey(header);\n        await validateJwsSignature(protectedHeader, payload, key, signature);\n    }\n    let claims;\n    try {\n        claims = JSON.parse(buf(b64u(payload)));\n    }\n    catch (cause) {\n        throw new OPE('failed to parse JWT Payload body as base64url encoded JSON', { cause });\n    }\n    if (!isJsonObject(claims)) {\n        throw new OPE('JWT Payload must be a top level object');\n    }\n    const now = epochTime() + clockSkew;\n    if (claims.exp !== undefined) {\n        if (typeof claims.exp !== 'number') {\n            throw new OPE('unexpected JWT \"exp\" (expiration time) claim type');\n        }\n        if (claims.exp <= now - clockTolerance) {\n            throw new OPE('unexpected JWT \"exp\" (expiration time) claim value, timestamp is <= now()');\n        }\n    }\n    if (claims.iat !== undefined) {\n        if (typeof claims.iat !== 'number') {\n            throw new OPE('unexpected JWT \"iat\" (issued at) claim type');\n        }\n    }\n    if (claims.iss !== undefined) {\n        if (typeof claims.iss !== 'string') {\n            throw new OPE('unexpected JWT \"iss\" (issuer) claim type');\n        }\n    }\n    if (claims.nbf !== undefined) {\n        if (typeof claims.nbf !== 'number') {\n            throw new OPE('unexpected JWT \"nbf\" (not before) claim type');\n        }\n        if (claims.nbf > now + clockTolerance) {\n            throw new OPE('unexpected JWT \"nbf\" (not before) claim value, timestamp is > now()');\n        }\n    }\n    if (claims.aud !== undefined) {\n        if (typeof claims.aud !== 'string' && !Array.isArray(claims.aud)) {\n            throw new OPE('unexpected JWT \"aud\" (audience) claim type');\n        }\n    }\n    return { header, claims, signature, key, jwt: jws };\n}\nexport async function validateJwtAuthResponse(as, client, parameters, expectedState, options) {\n    assertAs(as);\n    assertClient(client);\n    if (parameters instanceof URL) {\n        parameters = parameters.searchParams;\n    }\n    if (!(parameters instanceof URLSearchParams)) {\n        throw new TypeError('\"parameters\" must be an instance of URLSearchParams, or URL');\n    }\n    const response = getURLSearchParameter(parameters, 'response');\n    if (!response) {\n        throw new OPE('\"parameters\" does not contain a JARM response');\n    }\n    const { claims } = await validateJwt(response, checkSigningAlgorithm.bind(undefined, client.authorization_signed_response_alg, as.authorization_signing_alg_values_supported), getPublicSigKeyFromIssuerJwksUri.bind(undefined, as, options), getClockSkew(client), getClockTolerance(client), client[jweDecrypt])\n        .then(validatePresence.bind(undefined, ['aud', 'exp', 'iss']))\n        .then(validateIssuer.bind(undefined, as.issuer))\n        .then(validateAudience.bind(undefined, client.client_id));\n    const result = new URLSearchParams();\n    for (const [key, value] of Object.entries(claims)) {\n        if (typeof value === 'string' && key !== 'aud') {\n            result.set(key, value);\n        }\n    }\n    return validateAuthResponse(as, client, result, expectedState);\n}\nasync function idTokenHash(alg, data, key) {\n    let algorithm;\n    switch (alg) {\n        case 'RS256':\n        case 'PS256':\n        case 'ES256':\n            algorithm = 'SHA-256';\n            break;\n        case 'RS384':\n        case 'PS384':\n        case 'ES384':\n            algorithm = 'SHA-384';\n            break;\n        case 'RS512':\n        case 'PS512':\n        case 'ES512':\n            algorithm = 'SHA-512';\n            break;\n        case 'EdDSA':\n            if (key.algorithm.name === 'Ed25519') {\n                algorithm = 'SHA-512';\n                break;\n            }\n            throw new UnsupportedOperationError();\n        default:\n            throw new UnsupportedOperationError();\n    }\n    const digest = await crypto.subtle.digest(algorithm, buf(data));\n    return b64u(digest.slice(0, digest.byteLength / 2));\n}\nasync function idTokenHashMatches(data, actual, alg, key) {\n    const expected = await idTokenHash(alg, data, key);\n    return actual === expected;\n}\nexport async function validateDetachedSignatureResponse(as, client, parameters, expectedNonce, expectedState, maxAge, options) {\n    assertAs(as);\n    assertClient(client);\n    if (parameters instanceof URL) {\n        if (!parameters.hash.length) {\n            throw new TypeError('\"parameters\" as an instance of URL must contain a hash (fragment) with the Authorization Response parameters');\n        }\n        parameters = new URLSearchParams(parameters.hash.slice(1));\n    }\n    if (!(parameters instanceof URLSearchParams)) {\n        throw new TypeError('\"parameters\" must be an instance of URLSearchParams');\n    }\n    parameters = new URLSearchParams(parameters);\n    const id_token = getURLSearchParameter(parameters, 'id_token');\n    parameters.delete('id_token');\n    switch (expectedState) {\n        case undefined:\n        case expectNoState:\n            break;\n        default:\n            if (!validateString(expectedState)) {\n                throw new TypeError('\"expectedState\" must be a non-empty string');\n            }\n    }\n    const result = validateAuthResponse({\n        ...as,\n        authorization_response_iss_parameter_supported: false,\n    }, client, parameters, expectedState);\n    if (isOAuth2Error(result)) {\n        return result;\n    }\n    if (!id_token) {\n        throw new OPE('\"parameters\" does not contain an ID Token');\n    }\n    const code = getURLSearchParameter(parameters, 'code');\n    if (!code) {\n        throw new OPE('\"parameters\" does not contain an Authorization Code');\n    }\n    const requiredClaims = [\n        'aud',\n        'exp',\n        'iat',\n        'iss',\n        'sub',\n        'nonce',\n        'c_hash',\n    ];\n    if (typeof expectedState === 'string') {\n        requiredClaims.push('s_hash');\n    }\n    const { claims, header, key } = await validateJwt(id_token, checkSigningAlgorithm.bind(undefined, client.id_token_signed_response_alg, as.id_token_signing_alg_values_supported), getPublicSigKeyFromIssuerJwksUri.bind(undefined, as, options), getClockSkew(client), getClockTolerance(client), client[jweDecrypt])\n        .then(validatePresence.bind(undefined, requiredClaims))\n        .then(validateIssuer.bind(undefined, as.issuer))\n        .then(validateAudience.bind(undefined, client.client_id));\n    const clockSkew = getClockSkew(client);\n    const now = epochTime() + clockSkew;\n    if (claims.iat < now - 3600) {\n        throw new OPE('unexpected JWT \"iat\" (issued at) claim value, it is too far in the past');\n    }\n    if (typeof claims.c_hash !== 'string' ||\n        (await idTokenHashMatches(code, claims.c_hash, header.alg, key)) !== true) {\n        throw new OPE('invalid ID Token \"c_hash\" (code hash) claim value');\n    }\n    if (claims.s_hash !== undefined && typeof expectedState !== 'string') {\n        throw new OPE('could not verify ID Token \"s_hash\" (state hash) claim value');\n    }\n    if (typeof expectedState === 'string' &&\n        (typeof claims.s_hash !== 'string' ||\n            (await idTokenHashMatches(expectedState, claims.s_hash, header.alg, key)) !== true)) {\n        throw new OPE('invalid ID Token \"s_hash\" (state hash) claim value');\n    }\n    if (claims.auth_time !== undefined &&\n        (!Number.isFinite(claims.auth_time) || Math.sign(claims.auth_time) !== 1)) {\n        throw new OPE('ID Token \"auth_time\" (authentication time) must be a positive number');\n    }\n    maxAge ?? (maxAge = client.default_max_age ?? skipAuthTimeCheck);\n    if ((client.require_auth_time || maxAge !== skipAuthTimeCheck) &&\n        claims.auth_time === undefined) {\n        throw new OPE('ID Token \"auth_time\" (authentication time) claim missing');\n    }\n    if (maxAge !== skipAuthTimeCheck) {\n        if (typeof maxAge !== 'number' || maxAge < 0) {\n            throw new TypeError('\"maxAge\" must be a non-negative number');\n        }\n        const now = epochTime() + getClockSkew(client);\n        const tolerance = getClockTolerance(client);\n        if (claims.auth_time + maxAge < now - tolerance) {\n            throw new OPE('too much time has elapsed since the last End-User authentication');\n        }\n    }\n    if (!validateString(expectedNonce)) {\n        throw new TypeError('\"expectedNonce\" must be a non-empty string');\n    }\n    if (claims.nonce !== expectedNonce) {\n        throw new OPE('unexpected ID Token \"nonce\" claim value');\n    }\n    if (Array.isArray(claims.aud) && claims.aud.length !== 1) {\n        if (claims.azp === undefined) {\n            throw new OPE('ID Token \"aud\" (audience) claim includes additional untrusted audiences');\n        }\n        if (claims.azp !== client.client_id) {\n            throw new OPE('unexpected ID Token \"azp\" (authorized party) claim value');\n        }\n    }\n    return result;\n}\nfunction checkSigningAlgorithm(client, issuer, header) {\n    if (client !== undefined) {\n        if (header.alg !== client) {\n            throw new OPE('unexpected JWT \"alg\" header parameter');\n        }\n        return;\n    }\n    if (Array.isArray(issuer)) {\n        if (!issuer.includes(header.alg)) {\n            throw new OPE('unexpected JWT \"alg\" header parameter');\n        }\n        return;\n    }\n    if (header.alg !== 'RS256') {\n        throw new OPE('unexpected JWT \"alg\" header parameter');\n    }\n}\nfunction getURLSearchParameter(parameters, name) {\n    const { 0: value, length } = parameters.getAll(name);\n    if (length > 1) {\n        throw new OPE(`\"${name}\" parameter must be provided only once`);\n    }\n    return value;\n}\nexport const skipStateCheck = Symbol();\nexport const expectNoState = Symbol();\nexport function validateAuthResponse(as, client, parameters, expectedState) {\n    assertAs(as);\n    assertClient(client);\n    if (parameters instanceof URL) {\n        parameters = parameters.searchParams;\n    }\n    if (!(parameters instanceof URLSearchParams)) {\n        throw new TypeError('\"parameters\" must be an instance of URLSearchParams, or URL');\n    }\n    if (getURLSearchParameter(parameters, 'response')) {\n        throw new OPE('\"parameters\" contains a JARM response, use validateJwtAuthResponse() instead of validateAuthResponse()');\n    }\n    const iss = getURLSearchParameter(parameters, 'iss');\n    const state = getURLSearchParameter(parameters, 'state');\n    if (!iss && as.authorization_response_iss_parameter_supported) {\n        throw new OPE('response parameter \"iss\" (issuer) missing');\n    }\n    if (iss && iss !== as.issuer) {\n        throw new OPE('unexpected \"iss\" (issuer) response parameter value');\n    }\n    switch (expectedState) {\n        case undefined:\n        case expectNoState:\n            if (state !== undefined) {\n                throw new OPE('unexpected \"state\" response parameter encountered');\n            }\n            break;\n        case skipStateCheck:\n            break;\n        default:\n            if (!validateString(expectedState)) {\n                throw new OPE('\"expectedState\" must be a non-empty string');\n            }\n            if (state === undefined) {\n                throw new OPE('response parameter \"state\" missing');\n            }\n            if (state !== expectedState) {\n                throw new OPE('unexpected \"state\" response parameter value');\n            }\n    }\n    const error = getURLSearchParameter(parameters, 'error');\n    if (error) {\n        return {\n            error,\n            error_description: getURLSearchParameter(parameters, 'error_description'),\n            error_uri: getURLSearchParameter(parameters, 'error_uri'),\n        };\n    }\n    const id_token = getURLSearchParameter(parameters, 'id_token');\n    const token = getURLSearchParameter(parameters, 'token');\n    if (id_token !== undefined || token !== undefined) {\n        throw new UnsupportedOperationError('implicit and hybrid flows are not supported');\n    }\n    return brand(new URLSearchParams(parameters));\n}\nfunction algToSubtle(alg, crv) {\n    switch (alg) {\n        case 'PS256':\n        case 'PS384':\n        case 'PS512':\n            return { name: 'RSA-PSS', hash: `SHA-${alg.slice(-3)}` };\n        case 'RS256':\n        case 'RS384':\n        case 'RS512':\n            return { name: 'RSASSA-PKCS1-v1_5', hash: `SHA-${alg.slice(-3)}` };\n        case 'ES256':\n        case 'ES384':\n            return { name: 'ECDSA', namedCurve: `P-${alg.slice(-3)}` };\n        case 'ES512':\n            return { name: 'ECDSA', namedCurve: 'P-521' };\n        case 'EdDSA': {\n            switch (crv) {\n                case 'Ed25519':\n                case 'Ed448':\n                    return crv;\n                default:\n                    throw new UnsupportedOperationError();\n            }\n        }\n        default:\n            throw new UnsupportedOperationError();\n    }\n}\nasync function importJwk(alg, jwk) {\n    const { ext, key_ops, use, ...key } = jwk;\n    return crypto.subtle.importKey('jwk', key, algToSubtle(alg, jwk.crv), true, ['verify']);\n}\nexport async function deviceAuthorizationRequest(as, client, parameters, options) {\n    assertAs(as);\n    assertClient(client);\n    const url = resolveEndpoint(as, 'device_authorization_endpoint', alias(client, options));\n    const body = new URLSearchParams(parameters);\n    body.set('client_id', client.client_id);\n    const headers = prepareHeaders(options?.headers);\n    headers.set('accept', 'application/json');\n    return authenticatedRequest(as, client, 'POST', url, body, headers, options);\n}\nexport async function processDeviceAuthorizationResponse(as, client, response) {\n    assertAs(as);\n    assertClient(client);\n    if (!looseInstanceOf(response, Response)) {\n        throw new TypeError('\"response\" must be an instance of Response');\n    }\n    if (response.status !== 200) {\n        let err;\n        if ((err = await handleOAuthBodyError(response))) {\n            return err;\n        }\n        throw new OPE('\"response\" is not a conform Device Authorization Endpoint response');\n    }\n    assertReadableResponse(response);\n    let json;\n    try {\n        json = await response.json();\n    }\n    catch (cause) {\n        throw new OPE('failed to parse \"response\" body as JSON', { cause });\n    }\n    if (!isJsonObject(json)) {\n        throw new OPE('\"response\" body must be a top level object');\n    }\n    if (!validateString(json.device_code)) {\n        throw new OPE('\"response\" body \"device_code\" property must be a non-empty string');\n    }\n    if (!validateString(json.user_code)) {\n        throw new OPE('\"response\" body \"user_code\" property must be a non-empty string');\n    }\n    if (!validateString(json.verification_uri)) {\n        throw new OPE('\"response\" body \"verification_uri\" property must be a non-empty string');\n    }\n    if (typeof json.expires_in !== 'number' || json.expires_in <= 0) {\n        throw new OPE('\"response\" body \"expires_in\" property must be a positive number');\n    }\n    if (json.verification_uri_complete !== undefined &&\n        !validateString(json.verification_uri_complete)) {\n        throw new OPE('\"response\" body \"verification_uri_complete\" property must be a non-empty string');\n    }\n    if (json.interval !== undefined && (typeof json.interval !== 'number' || json.interval <= 0)) {\n        throw new OPE('\"response\" body \"interval\" property must be a positive number');\n    }\n    return json;\n}\nexport async function deviceCodeGrantRequest(as, client, deviceCode, options) {\n    assertAs(as);\n    assertClient(client);\n    if (!validateString(deviceCode)) {\n        throw new TypeError('\"deviceCode\" must be a non-empty string');\n    }\n    const parameters = new URLSearchParams(options?.additionalParameters);\n    parameters.set('device_code', deviceCode);\n    return tokenEndpointRequest(as, client, 'urn:ietf:params:oauth:grant-type:device_code', parameters, options);\n}\nexport async function processDeviceCodeResponse(as, client, response) {\n    return processGenericAccessTokenResponse(as, client, response);\n}\nexport async function generateKeyPair(alg, options) {\n    if (!validateString(alg)) {\n        throw new TypeError('\"alg\" must be a non-empty string');\n    }\n    const algorithm = algToSubtle(alg, alg === 'EdDSA' ? (options?.crv ?? 'Ed25519') : undefined);\n    if (alg.startsWith('PS') || alg.startsWith('RS')) {\n        Object.assign(algorithm, {\n            modulusLength: options?.modulusLength ?? 2048,\n            publicExponent: new Uint8Array([0x01, 0x00, 0x01]),\n        });\n    }\n    return crypto.subtle.generateKey(algorithm, options?.extractable ?? false, [\n        'sign',\n        'verify',\n    ]);\n}\nfunction normalizeHtu(htu) {\n    const url = new URL(htu);\n    url.search = '';\n    url.hash = '';\n    return url.href;\n}\nasync function validateDPoP(as, request, accessToken, accessTokenClaims, options) {\n    const header = request.headers.get('dpop');\n    if (header === null) {\n        throw new OPE('operation indicated DPoP use but the request has no DPoP HTTP Header');\n    }\n    if (request.headers.get('authorization')?.toLowerCase().startsWith('dpop ') === false) {\n        throw new OPE(`operation indicated DPoP use but the request's Authorization HTTP Header scheme is not DPoP`);\n    }\n    if (typeof accessTokenClaims.cnf?.jkt !== 'string') {\n        throw new OPE('operation indicated DPoP use but the JWT Access Token has no jkt confirmation claim');\n    }\n    const clockSkew = getClockSkew(options);\n    const proof = await validateJwt(header, checkSigningAlgorithm.bind(undefined, undefined, as?.dpop_signing_alg_values_supported || SUPPORTED_JWS_ALGS), async ({ jwk, alg }) => {\n        if (!jwk) {\n            throw new OPE('DPoP Proof is missing the jwk header parameter');\n        }\n        const key = await importJwk(alg, jwk);\n        if (key.type !== 'public') {\n            throw new OPE('DPoP Proof jwk header parameter must contain a public key');\n        }\n        return key;\n    }, clockSkew, getClockTolerance(options), undefined)\n        .then(checkJwtType.bind(undefined, 'dpop+jwt'))\n        .then(validatePresence.bind(undefined, ['iat', 'jti', 'ath', 'htm', 'htu']));\n    const now = epochTime() + clockSkew;\n    const diff = Math.abs(now - proof.claims.iat);\n    if (diff > 300) {\n        throw new OPE('DPoP Proof iat is not recent enough');\n    }\n    if (proof.claims.htm !== request.method) {\n        throw new OPE('DPoP Proof htm mismatch');\n    }\n    if (typeof proof.claims.htu !== 'string' ||\n        normalizeHtu(proof.claims.htu) !== normalizeHtu(request.url)) {\n        throw new OPE('DPoP Proof htu mismatch');\n    }\n    {\n        const expected = b64u(await crypto.subtle.digest('SHA-256', encoder.encode(accessToken)));\n        if (proof.claims.ath !== expected) {\n            throw new OPE('DPoP Proof ath mismatch');\n        }\n    }\n    {\n        let components;\n        switch (proof.header.jwk.kty) {\n            case 'EC':\n                components = {\n                    crv: proof.header.jwk.crv,\n                    kty: proof.header.jwk.kty,\n                    x: proof.header.jwk.x,\n                    y: proof.header.jwk.y,\n                };\n                break;\n            case 'OKP':\n                components = {\n                    crv: proof.header.jwk.crv,\n                    kty: proof.header.jwk.kty,\n                    x: proof.header.jwk.x,\n                };\n                break;\n            case 'RSA':\n                components = {\n                    e: proof.header.jwk.e,\n                    kty: proof.header.jwk.kty,\n                    n: proof.header.jwk.n,\n                };\n                break;\n            default:\n                throw new UnsupportedOperationError();\n        }\n        const expected = b64u(await crypto.subtle.digest('SHA-256', encoder.encode(JSON.stringify(components))));\n        if (accessTokenClaims.cnf.jkt !== expected) {\n            throw new OPE('JWT Access Token confirmation mismatch');\n        }\n    }\n}\nexport async function validateJwtAccessToken(as, request, expectedAudience, options) {\n    assertAs(as);\n    if (!looseInstanceOf(request, Request)) {\n        throw new TypeError('\"request\" must be an instance of Request');\n    }\n    if (!validateString(expectedAudience)) {\n        throw new OPE('\"expectedAudience\" must be a non-empty string');\n    }\n    const authorization = request.headers.get('authorization');\n    if (authorization === null) {\n        throw new OPE('\"request\" is missing an Authorization HTTP Header');\n    }\n    let { 0: scheme, 1: accessToken, length } = authorization.split(' ');\n    scheme = scheme.toLowerCase();\n    switch (scheme) {\n        case 'dpop':\n        case 'bearer':\n            break;\n        default:\n            throw new UnsupportedOperationError('unsupported Authorization HTTP Header scheme');\n    }\n    if (length !== 2) {\n        throw new OPE('invalid Authorization HTTP Header format');\n    }\n    const requiredClaims = [\n        'iss',\n        'exp',\n        'aud',\n        'sub',\n        'iat',\n        'jti',\n        'client_id',\n    ];\n    if (options?.requireDPoP || scheme === 'dpop' || request.headers.has('dpop')) {\n        requiredClaims.push('cnf');\n    }\n    const { claims } = await validateJwt(accessToken, checkSigningAlgorithm.bind(undefined, undefined, SUPPORTED_JWS_ALGS), getPublicSigKeyFromIssuerJwksUri.bind(undefined, as, options), getClockSkew(options), getClockTolerance(options), undefined)\n        .then(checkJwtType.bind(undefined, 'at+jwt'))\n        .then(validatePresence.bind(undefined, requiredClaims))\n        .then(validateIssuer.bind(undefined, as.issuer))\n        .then(validateAudience.bind(undefined, expectedAudience));\n    for (const claim of ['client_id', 'jti', 'sub']) {\n        if (typeof claims[claim] !== 'string') {\n            throw new OPE(`unexpected JWT \"${claim}\" claim type`);\n        }\n    }\n    if ('cnf' in claims) {\n        if (!isJsonObject(claims.cnf)) {\n            throw new OPE('unexpected JWT \"cnf\" (confirmation) claim value');\n        }\n        const { 0: cnf, length } = Object.keys(claims.cnf);\n        if (length) {\n            if (length !== 1) {\n                throw new UnsupportedOperationError('multiple confirmation claims are not supported');\n            }\n            if (cnf !== 'jkt') {\n                throw new UnsupportedOperationError('unsupported JWT Confirmation method');\n            }\n        }\n    }\n    if (options?.requireDPoP ||\n        scheme === 'dpop' ||\n        claims.cnf?.jkt !== undefined ||\n        request.headers.has('dpop')) {\n        await validateDPoP(as, request, accessToken, claims, options);\n    }\n    return claims;\n}\nexport const experimentalCustomFetch = customFetch;\nexport const experimental_customFetch = customFetch;\nexport const experimentalUseMtlsAlias = useMtlsAlias;\nexport const experimental_useMtlsAlias = useMtlsAlias;\nexport const experimental_validateDetachedSignatureResponse = (...args) => validateDetachedSignatureResponse(...args);\nexport const experimental_validateJwtAccessToken = (...args) => validateJwtAccessToken(...args);\nexport const validateJwtUserinfoSignature = (...args) => validateJwtUserInfoSignature(...args);\nexport const experimental_jwksCache = jwksCache;\n","var e=class extends EventTarget{dispatchTypedEvent(s,t){return super.dispatchEvent(t)}};export{e as TypedEventTarget};\n","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isOAuth2Error } from \"oauth4webapi\";\nexport function throwIfError(result) {\n  if (isOAuth2Error(result)) {\n    throw new Error(`Failed to get token: ${result.error}`);\n  }\n  return result;\n}\n//# sourceMappingURL=throwIfError.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { processRevocationResponse, revocationRequest } from \"oauth4webapi\";\nimport invariant from \"tiny-invariant\";\nimport { TypedEventTarget } from \"typescript-event-target\";\nimport { throwIfError } from \"./throwIfError.js\";\n// Node 18 is supposed to have a `CustomEvent` but it is not exposed on `globalThis`\n// which creates a problem for making a single codebase for node and browser. This polyfill works around it\nconst CustomEvent = globalThis.CustomEvent;\nfunction localStorageKey(client) {\n  return `@osdk/oauth : refresh : ${client.client_id}`;\n}\nexport function saveLocal(client, x) {\n  // MUST `localStorage?` as nodejs does not have localStorage\n  globalThis.localStorage?.setItem(localStorageKey(client), JSON.stringify(x));\n}\nexport function removeLocal(client) {\n  // MUST `localStorage?` as nodejs does not have localStorage\n  globalThis.localStorage?.removeItem(localStorageKey(client));\n}\nexport function readLocal(client) {\n  return JSON.parse(\n  // MUST `localStorage?` as nodejs does not have localStorage\n  globalThis.localStorage?.getItem(localStorageKey(client)) ?? \"{}\");\n}\nexport function saveSession(client, x) {\n  // MUST `sessionStorage?` as nodejs does not have sessionStorage\n  globalThis.sessionStorage?.setItem(localStorageKey(client), JSON.stringify(x));\n}\nexport function removeSession(client) {\n  // MUST `sessionStorage?` as nodejs does not have sessionStorage\n  globalThis.sessionStorage?.removeItem(localStorageKey(client));\n}\nexport function readSession(client) {\n  return JSON.parse(\n  // MUST `sessionStorage?` as nodejs does not have sessionStorage\n  globalThis.sessionStorage?.getItem(localStorageKey(client)) ?? \"{}\");\n}\nexport function common(client, as, _signIn, oauthHttpOptions, refresh, refreshTokenMarker, scopes) {\n  let token;\n  const eventTarget = new TypedEventTarget();\n  function makeTokenAndSaveRefresh(resp, type) {\n    const {\n      refresh_token,\n      expires_in,\n      access_token\n    } = resp;\n    !(expires_in != null) ? process.env.NODE_ENV !== \"production\" ? invariant(false) : invariant(false) : void 0;\n    saveLocal(client, {\n      refresh_token,\n      refreshTokenMarker,\n      requestedScopes: scopes\n    });\n    token = {\n      refresh_token,\n      expires_in,\n      access_token,\n      expires_at: Date.now() + expires_in * 1000\n    };\n    eventTarget.dispatchTypedEvent(type, new CustomEvent(type, {\n      detail: token\n    }));\n    return token;\n  }\n  let refreshTimeout;\n  function rmTimeout() {\n    if (refreshTimeout) clearTimeout(refreshTimeout);\n  }\n  function restartRefreshTimer(evt) {\n    if (refresh) {\n      rmTimeout();\n      refreshTimeout = setTimeout(refresh, evt.detail.expires_in * 1000 - 60 * 1000);\n    }\n  }\n  let pendingSignIn;\n  async function signIn() {\n    if (pendingSignIn) {\n      return pendingSignIn;\n    }\n    try {\n      pendingSignIn = _signIn();\n      return await pendingSignIn;\n    } finally {\n      pendingSignIn = undefined;\n    }\n  }\n  eventTarget.addEventListener(\"signIn\", restartRefreshTimer);\n  eventTarget.addEventListener(\"refresh\", restartRefreshTimer);\n  function getTokenOrUndefined() {\n    if (!token || Date.now() >= token.expires_at) {\n      return undefined;\n    }\n    return token?.access_token;\n  }\n  const getToken = Object.assign(async function getToken() {\n    if (!token || Date.now() >= token.expires_at) {\n      token = await signIn();\n    }\n    return token?.access_token;\n  }, {\n    signIn,\n    refresh,\n    signOut: async function signOut() {\n      !token ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"not signed in\") : invariant(false) : void 0;\n      const result = await processRevocationResponse(await revocationRequest(as, client, token.access_token, oauthHttpOptions));\n      rmTimeout();\n\n      // Clean up\n      removeLocal(client);\n      token = undefined;\n      throwIfError(result);\n      eventTarget.dispatchTypedEvent(\"signOut\", new Event(\"signOut\"));\n    },\n    rmTimeout,\n    getTokenOrUndefined,\n    addEventListener: eventTarget.addEventListener.bind(eventTarget),\n    removeEventListener: eventTarget.removeEventListener.bind(eventTarget)\n  });\n  return {\n    getToken,\n    makeTokenAndSaveRefresh\n  };\n}\nexport function createAuthorizationServer(ctxPath, url) {\n  const issuer = `${new URL(ctxPath, url.endsWith(\"/\") ? url : url + \"/\")}`;\n  return {\n    token_endpoint: `${issuer}/api/oauth2/token`,\n    authorization_endpoint: `${issuer}/api/oauth2/authorize`,\n    revocation_endpoint: `${issuer}/api/oauth2/revoke_token`,\n    issuer\n  };\n}\n//# sourceMappingURL=common.js.map","// From https://github.com/sindresorhus/random-int/blob/c37741b56f76b9160b0b63dae4e9c64875128146/index.js#L13-L15\nconst randomInteger = (minimum, maximum) => Math.floor((Math.random() * (maximum - minimum + 1)) + minimum);\n\nconst createAbortError = () => {\n\tconst error = new Error('Delay aborted');\n\terror.name = 'AbortError';\n\treturn error;\n};\n\nconst clearMethods = new WeakMap();\n\nexport function createDelay({clearTimeout: defaultClear, setTimeout: defaultSet} = {}) {\n\t// We cannot use `async` here as we need the promise identity.\n\treturn (milliseconds, {value, signal} = {}) => {\n\t\t// TODO: Use `signal?.throwIfAborted()` when targeting Node.js 18.\n\t\tif (signal?.aborted) {\n\t\t\treturn Promise.reject(createAbortError());\n\t\t}\n\n\t\tlet timeoutId;\n\t\tlet settle;\n\t\tlet rejectFunction;\n\t\tconst clear = defaultClear ?? clearTimeout;\n\n\t\tconst signalListener = () => {\n\t\t\tclear(timeoutId);\n\t\t\trejectFunction(createAbortError());\n\t\t};\n\n\t\tconst cleanup = () => {\n\t\t\tif (signal) {\n\t\t\t\tsignal.removeEventListener('abort', signalListener);\n\t\t\t}\n\t\t};\n\n\t\tconst delayPromise = new Promise((resolve, reject) => {\n\t\t\tsettle = () => {\n\t\t\t\tcleanup();\n\t\t\t\tresolve(value);\n\t\t\t};\n\n\t\t\trejectFunction = reject;\n\t\t\ttimeoutId = (defaultSet ?? setTimeout)(settle, milliseconds);\n\t\t});\n\n\t\tif (signal) {\n\t\t\tsignal.addEventListener('abort', signalListener, {once: true});\n\t\t}\n\n\t\tclearMethods.set(delayPromise, () => {\n\t\t\tclear(timeoutId);\n\t\t\ttimeoutId = null;\n\t\t\tsettle();\n\t\t});\n\n\t\treturn delayPromise;\n\t};\n}\n\nconst delay = createDelay();\n\nexport default delay;\n\nexport async function rangeDelay(minimum, maximum, options = {}) {\n\treturn delay(randomInteger(minimum, maximum), options);\n}\n\nexport function clearDelay(promise) {\n\tclearMethods.get(promise)?.();\n}\n","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport invariant from \"tiny-invariant\";\nexport function processOptionsAndAssignDefaults(url, redirect_uri, useHistory, loginPage, postLoginPage, scopes, fetchFn, ctxPath) {\n  let options = {};\n  if (typeof useHistory === \"object\") {\n    !(!loginPage && !postLoginPage && !scopes && !fetchFn && !ctxPath) ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"If useHistory is an object, other options should not be provided\") : invariant(false) : void 0;\n    options = useHistory;\n  } else {\n    options = {\n      useHistory,\n      loginPage,\n      postLoginPage,\n      scopes,\n      fetchFn,\n      ctxPath\n    };\n  }\n  !url ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"url is required\") : invariant(false) : void 0;\n  !redirect_uri ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"redirectUrl is required\") : invariant(false) : void 0;\n\n  // Assign defaults\n  return {\n    useHistory: options.useHistory ?? true,\n    loginPage: options.loginPage,\n    postLoginPage: options.postLoginPage || window.location.toString(),\n    joinedScopes: [...(options.scopes ?? [\"api:read-data\", \"api:write-data\", \"api:use-ontologies-read\", \"api:use-ontologies-write\"])].sort().join(\" \"),\n    fetchFn: options.fetchFn ?? globalThis.fetch,\n    ctxPath: options.ctxPath ?? \"multipass\",\n    refreshTokenMarker: options.refreshTokenMarker\n  };\n}\n//# sourceMappingURL=utils.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport delay from \"delay\";\nimport { authorizationCodeGrantRequest, calculatePKCECodeChallenge, customFetch, generateRandomCodeVerifier, generateRandomState, processAuthorizationCodeOAuth2Response, refreshTokenGrantRequest, validateAuthResponse } from \"oauth4webapi\";\nimport { common, createAuthorizationServer, readLocal, readSession, removeLocal, removeSession, saveLocal, saveSession } from \"./common.js\";\nimport { throwIfError } from \"./throwIfError.js\";\nimport { processOptionsAndAssignDefaults } from \"./utils.js\";\n\n/**\n * Creates a PublicOauthClient for authentication.\n *\n * @param {string} clientId - The client_id from the OAuth configuration on the server\n * @param {string} url - The base URL of your Foundry server\n * @param {string} redirectUrl - The URL configured for redirect in the OAuth configuration on the server\n * @param {PublicOauthClientOptions} options - Additional options for the client\n * @returns {PublicOauthClient} A client that can be used as a token provider\n */\n\n/**\n * Creates a PublicOauthClient for authentication.\n *\n * @param {string} clientId - The client_id from the OAuth configuration on the server\n * @param {string} url - The base URL of your Foundry server\n * @param {string} redirectUrl - The URL configured for redirect in the OAuth configuration on the server\n * @param {boolean} useHistory - If true, uses `history.replaceState()`, otherwise uses `window.location.assign()` (defaults to true)\n * @param {string} loginPage - Custom landing page URL prior to logging in\n * @param {string} postLoginPage - URL to return to after completed authentication cycle (defaults to `window.location.toString()`)\n * @param {string[]} scopes - OAuth scopes to request. If not provided, defaults to `[\"api:read-data\", \"api:write-data\", \"api:use-ontologies-read\", \"api:use-ontologies-write\"]`\n * @param {typeof globalThis.fetch} fetchFn - Custom fetch function to use for requests (defaults to `globalThis.fetch`)\n * @param {string} ctxPath - Context path for the authorization server (defaults to \"multipass\")\n * @returns {PublicOauthClient} A client that can be used as a token provider\n */\n\nexport function createPublicOauthClient(client_id, url, redirect_uri, useHistory, loginPage, postLoginPage, scopes, fetchFn, ctxPath) {\n  let refreshTokenMarker;\n  let joinedScopes;\n  ({\n    useHistory,\n    loginPage,\n    postLoginPage,\n    joinedScopes,\n    fetchFn,\n    ctxPath,\n    refreshTokenMarker\n  } = processOptionsAndAssignDefaults(url, redirect_uri, useHistory, loginPage, postLoginPage, scopes, fetchFn, ctxPath));\n  const client = {\n    client_id,\n    token_endpoint_auth_method: \"none\"\n  };\n  const authServer = createAuthorizationServer(ctxPath, url);\n  const oauthHttpOptions = {\n    [customFetch]: fetchFn\n  };\n  const {\n    makeTokenAndSaveRefresh,\n    getToken\n  } = common(client, authServer, /** Will throw if there is no token! */\n  async function _signIn() {\n    // 1. Check if we have a refresh token in local storage\n    return (await maybeRefresh()\n    // 2. If there is no refresh token we are likely trying to perform the callback\n    ) ?? (await maybeHandleAuthReturn())\n    // 3. If we haven't been able to load the token from one of the two above ways, we need to make the initial auth request\n    ?? (await initiateLoginRedirect());\n  }, oauthHttpOptions, maybeRefresh.bind(globalThis, true), refreshTokenMarker, joinedScopes);\n\n  // as an arrow function, `useHistory` is known to be a boolean\n  const go = async x => {\n    if (useHistory) {\n      window.history.replaceState({}, \"\", x);\n      return;\n    } else window.location.assign(x);\n    await delay(1000);\n    throw new Error(\"Unable to redirect\");\n  };\n  async function maybeRefresh(expectRefreshToken) {\n    const {\n      refresh_token,\n      refreshTokenMarker: lastRefreshTokenMarker,\n      requestedScopes: initialRequestedScopes\n    } = readLocal(client);\n    const areScopesEqual = initialRequestedScopes != null && joinedScopes === initialRequestedScopes;\n    if (!refresh_token || lastRefreshTokenMarker !== refreshTokenMarker || !areScopesEqual) {\n      if (expectRefreshToken) throw new Error(\"No refresh token found\");\n      return;\n    }\n    try {\n      // note, we don't use processRefreshTokenResponse because the mp oauth implementation\n      // doesn't do refresh tokens quite right and this lets us skip the id check\n      const result = makeTokenAndSaveRefresh(throwIfError(await processAuthorizationCodeOAuth2Response(authServer, client, await refreshTokenGrantRequest(authServer, client, refresh_token, oauthHttpOptions))), \"refresh\");\n      if (result && window.location.pathname === new URL(redirect_uri).pathname) {\n        const {\n          oldUrl\n        } = readSession(client);\n        // don't block on the redirect\n        void go(oldUrl ?? \"/\");\n      }\n      return result;\n    } catch (e) {\n      if (process.env.NODE_ENV !== \"production\") {\n        // eslint-disable-next-line no-console\n        console.warn(\"Failed to get OAuth2 refresh token. Removing refresh token\", e);\n      }\n      removeLocal(client);\n      if (expectRefreshToken) {\n        throw new Error(\"Could not refresh token\");\n      }\n    }\n  }\n  async function maybeHandleAuthReturn() {\n    const {\n      state,\n      oldUrl,\n      codeVerifier\n    } = readSession(client);\n    if (!codeVerifier) return;\n    try {\n      const ret = makeTokenAndSaveRefresh(throwIfError(await processAuthorizationCodeOAuth2Response(authServer, client, await authorizationCodeGrantRequest(authServer, client, throwIfError(validateAuthResponse(authServer, client, new URL(window.location.href), state)), redirect_uri, codeVerifier, oauthHttpOptions))), \"signIn\");\n      void go(oldUrl);\n      return ret;\n    } catch (e) {\n      if (process.env.NODE_ENV !== \"production\") {\n        // eslint-disable-next-line no-console\n        console.warn(\"Failed to get OAuth2 token using PKCE, removing PKCE and starting a new auth flow\", e);\n      }\n      removeLocal(client);\n      removeSession(client);\n      throw e;\n    }\n  }\n\n  // As an arrow function, `scopes` and `postLoginPage` are known at compile time\n  const initiateLoginRedirect = async () => {\n    if (loginPage && window.location.href !== loginPage && window.location.pathname !== loginPage) {\n      saveLocal(client, {});\n      saveSession(client, {\n        oldUrl: postLoginPage\n      });\n      await go(loginPage);\n      return;\n    }\n    const state = generateRandomState();\n    const codeVerifier = generateRandomCodeVerifier();\n    const oldUrl = readSession(client).oldUrl ?? window.location.toString();\n    saveLocal(client, {});\n    saveSession(client, {\n      codeVerifier,\n      state,\n      oldUrl\n    });\n    window.location.assign(`${authServer.authorization_endpoint}?${new URLSearchParams({\n      client_id,\n      response_type: \"code\",\n      state,\n      redirect_uri,\n      code_challenge: await calculatePKCECodeChallenge(codeVerifier),\n      code_challenge_method: \"S256\",\n      scope: `offline_access ${joinedScopes}`\n    })}`);\n\n    // Give time for redirect to happen\n    await delay(1000);\n    throw new Error(\"Unable to redirect\");\n  };\n  return getToken;\n}\n//# sourceMappingURL=createPublicOauthClient.js.map","/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { foundryPlatformFetch as $foundryPlatformFetch } from \"@osdk/shared.net.platformapi\";\n//\nconst _deleteUser = [3, \"/v2/admin/users/{0}\"];\n/**\n * Delete the User with the specified id.\n *\n * @public\n *\n * Required Scopes: [api:admin-write]\n * URL: /v2/admin/users/{userId}\n */\nexport function deleteUser($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _deleteUser, ...args);\n}\nconst _list = [0, \"/v2/admin/users\", 2];\n/**\n * Lists all Users.\n *\n * This is a paged endpoint. Each page may be smaller or larger than the requested page size. However, it is guaranteed that if there are more results available, the `nextPageToken` field will be populated. To get the next page, make the same request again, but set the value of the `pageToken` query parameter to be value of the `nextPageToken` value of the previous response. If there is no `nextPageToken` field in the response, you are on the last page.\n *\n * @public\n *\n * Required Scopes: [api:admin-read]\n * URL: /v2/admin/users\n */\nexport function list($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _list, ...args);\n}\nconst _get = [0, \"/v2/admin/users/{0}\"];\n/**\n * Get the User with the specified id.\n *\n * @public\n *\n * Required Scopes: [api:admin-read]\n * URL: /v2/admin/users/{userId}\n */\nexport function get($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _get, ...args);\n}\nconst _getBatch = [1, \"/v2/admin/users/getBatch\", 1];\n/**\n * Execute multiple get requests on User.\n *\n * The maximum batch size for this endpoint is 500.\n *\n * @public\n *\n * Required Scopes: [api:admin-read]\n * URL: /v2/admin/users/getBatch\n */\nexport function getBatch($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _getBatch, ...args);\n}\nconst _getCurrent = [0, \"/v2/admin/users/getCurrent\"];\n/**\n * @public\n *\n * Required Scopes: [api:admin-read]\n * URL: /v2/admin/users/getCurrent\n */\nexport function getCurrent($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _getCurrent, ...args);\n}\nconst _getMarkings = [0, \"/v2/admin/users/{0}/getMarkings\", 2];\n/**\n * Retrieve Markings that the user is currently a member of.\n *\n * @beta\n *\n * Required Scopes: [api:admin-read]\n * URL: /v2/admin/users/{userId}/getMarkings\n */\nexport function getMarkings($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _getMarkings, ...args);\n}\nconst _profilePicture = [0, \"/v2/admin/users/{0}/profilePicture\",,, \"application/octet-stream\"];\n/**\n * @public\n *\n * Required Scopes: [api:admin-read]\n * URL: /v2/admin/users/{userId}/profilePicture\n */\nexport function profilePicture($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _profilePicture, ...args);\n}\nconst _search = [1, \"/v2/admin/users/search\", 1];\n/**\n * Perform a case-insensitive prefix search for users based on username, given name and family name.\n *\n * @public\n *\n * Required Scopes: [api:admin-read]\n * URL: /v2/admin/users/search\n */\nexport function search($ctx, ...args) {\n  return $foundryPlatformFetch($ctx, _search, ...args);\n}\n//# sourceMappingURL=User.js.map"],"names":["DistanceUnitMapping","TimeDurationMapping","DurationMapping","TimeseriesDurationMapping","message","errorName","errorCode","statusCode","errorInstanceId","parameters","PalantirApiError","originalError","ActionValidationError","validation","__EXPERIMENTAL__NOT_SUPPORTED_YET__createMediaReference","__EXPERIMENTAL__NOT_SUPPORTED_YET__fetchOneByRid","__EXPERIMENTAL__NOT_SUPPORTED_YET__fetchPageByRid","__EXPERIMENTAL__NOT_SUPPORTED_YET__getBulkLinks","symbolClientContext","UnknownError","errorType","foundryPlatformFetch","client","httpMethodNum","origPath","flags","contentType","responseContentType","args","path","body","queryArgs","headerArgs","method","apiFetch","oldSymbolClientContext","clientCtx","endpointPath","data","queryArguments","headers","requestMediaType","responseMediaType","url","parseUrl","key","value","item","headersInit","response","convertedError","e","baseUrl","_apply","apply","$ctx","$foundryPlatformFetch","_applyBatch","applyBatch","_get","get","_upload","upload","headerParams","_a","_read","read","_getMediaContent","getMediaContent","_getMediaMetadata","getMediaMetadata","_getFullMetadata","getFullMetadata","_search","search","_load","load","_loadMultipleObjectTypes","loadMultipleObjectTypes","_aggregate","aggregate","_execute","execute","_getFirstPoint","getFirstPoint","_getLastPoint","getLastPoint","_streamPoints","streamPoints","_getLatestValue","getLatestValue","_streamValues","streamValues","conjureFetch","fetchFn","servicePath","tokenProvider","params","accept","queryParams","stringValue","query","body2","readBody","ConjureError","error","status","__publicField","getBulkLinksPage","ctx","request","bulkLoadOntologyEntities","onBehalfOf","getLinkTypesForObjectTypes","loadAllOntologies","prefix","invariant","condition","conjureUnionType","type","makeConjureContext","getResults","x","applyPageToken","payload","pageToken","pageRequestAsAsyncIter","call","values","nextArgs","initialPayload","r","q","createSimpleCache","map","fn","set","createSimpleAsyncCache","createCacheLocal","cache","inProgress","ret","k","v","cachedAllOntologies","getOntologyVersionForRid","ontologyRid","strongMemoAsync","weakMemoAsync","MetadataClient","__privateAdd","_client","_ctx","_logger","rid","__privateGet","_objectPropertyMapping","_objectLinkMapping","_getConjureObjectType","objectApiName","objectDef","objectTypeRid","conjureObjectType","createObjectPropertyMapping","linkTypes","l","helper","apiName","linkSide","otherObjectType","objectTypeRidManySide","manyToOneLinkMetadata","objectTypeRidOneSide","oneToManyLinkMetadata","objectTypeRidA","objectTypeAToBLinkMetadata","objectTypeRidB","objectTypeBToALinkMetadata","entities","_b","__privateSet","metadataCacheClient","conjureOT","pkRid","pkProperty","a","propertyIdToApiNameMapping","property","propertyApiNameToIdMapping","createBulkLinksAsyncIterFactory","objs","mcc","propertyMapping","fullLinkMapping","linkMapping","linkType","req","directedLinkTypeRid","o","bulkLinksIter","objectIdentifier","obj","findObject","link","ref","pk","getPrimaryKeyOrThrow","otherObjectApiName","mappedLink","pkValue","pks","createFetchHeaderMutator","mutator","requestInit","createFetchOrThrow","convertError","fallbackMessage","unknownError","msgIfNotError","global","factory","module","this","fetchRetry","fetch","defaults","ArgumentError","isPositiveInteger","baseDefaults","input","init","retries","retryDelay","retryOn","resolve","reject","wrappedFetch","attempt","_input","retryOnResponse","retry","delay","INITIAL_DELAY","JITTER_FACTOR","MAX_RETRIES","createRetryingFetch","jitter","isRetryable","SERVICE_UNAVAILABLE","TOO_MANY_REQUESTS","addUserAgentAndRequestContextHeaders","withMetadata","augmentRequestContext","augment","isAttachmentUpload","isAttachmentFile","isMediaReference","extractNamespace","fqApiName","last","modernToLegacyWhereClause","whereClause","objectOrInterface","clause","parts","handleWherePair","makeGeoFilterBbox","bbox","filterType","propertyIdentifier","field","makeGeoFilterPolygon","coordinates","fieldName","filter","structFieldSelector","fullyQualifyPropName","keysOfFilter","hasDollarSign","structFieldApiName","firstKey","withinBody","intersectsBody","objApiNamespace","fieldApiNamespace","fieldShortName","derivedPropertyDefinitionFactory","wireDefinition","definitionMap","definition","getDefinitionFromMap","part","arg","createWithPropertiesObjectSet","objectType","objectSet","fromBaseObjectSet","aggregation","opt","splitAggregation","aggregationPropertyName","aggregationOperation","aggregationOperationDefinition","wrappedObjectSet","selectorResult","name","legacyToModernSingleAggregationResult","entry","accumulator","curValue","metricType","directionFieldMap","dir","modernToLegacyAggregationClause","select","propAndMetric","aggregationType","colonPos","metric","modernToLegacyGroupByClause","groupByClause","range","convertRange","resolveBaseObjectSetType","result","OntologiesV2.OntologyObjectSets.aggregate","aggregationToCountResult","aggregateResult","extractRdpDefinition","extractRdpDefinitionInternal","methodInputObjectType","definitions","childObjectType","objDef","operationLevelObjectType","objectSets","objectSetTypes","os","acc","firstValidChildObjectType","objectSetToSearchJsonV2","expectedApiName","existingWhere","resolveInterfaceObjectSet","interfaceTypeApiName","fetchInterfacePage","interfaceType","OntologiesV2.OntologyInterfaces.search","applyFetchArgs","OntologiesV2.OntologyObjectSets.loadMultipleObjectTypes","fetchPageInternal","fetchObjectPage","fetchPageWithErrorsInternal","fetchPage","direction","OntologiesV2.OntologyObjectSets.load","fetchSingle","fetchSingleWithErrors","WIRE_OBJECT_SET_TYPES","isWireObjectSet","ws","WebSocket$1","MINIMUM_RECONNECT_DELAY_MS","doNothing","fillOutListener","onChange","onError","onOutOfDate","onSuccessfulSubscription","isReady","sub","subscriptionIsDone","_ObjectSetListenerWebsocket","minimumReconnectDelayMs","_ObjectSetListenerWebsocket_instances","_ws","_lastWsConnect","_pendingSubscriptions","_subscriptions","_endedSubscriptions","_maybeDisconnectTimeout","_onOpen","__privateMethod","sendSubscribeMessage_fn","_onMessage","_handleMessage_objectSetChanged","_handleMessage_refreshObjectSet","_handleMessage_subscribeResponses","handleMessage_subscriptionClosed_fn","objectUpdates","update","referenceUpdates","osdkObjectsWithReferenceUpdates","singleOsdkObject","fetchInterfaceMapping_fn","_c","_tryCatchOnError","osdkObjects","keysToDelete","osdkObject","_e","_d","_f","id","responses","subs","i","unsubscribe_fn","_cycleWebsocket","shouldFireOutOfDate","_onClose","event","WebSocket","s","ensureWebsocket_fn","subscriptionClosed","onErrorError","instance","_instances","listener","properties","objOrInterfaceDef","objectProperties","referenceProperties","p","nextUuid","initiateSubscribe_fn","readySubs","subscribe","requestedProperties","requestedReferenceProperties","interfaceApiName","newStatus","constructWebsocketUrl","token","nextConnectTime","cleanup","open","evt","objectTypeApiName","interfaceMap","ObjectSetListenerWebsocket","base","uuidCounter","isObjectTypeDefinition","def","isObjectSet","objectSetDefinitions","getWireObjectSet","createObjectSet","createSearchAround","$nextPageToken","primaryKey","options","createWithPk","opts","pendingSubscribe","derivedProperties","derivedPropertyDefinition","isInterfaceActionParam","isObjectSpecifiersObject","isOntologyObjectV2","isPoint","toDataValue","dataValue","converted","promiseArray","innerValue","attachment","OntologiesV2.Attachments.upload","promisedAcc","structValue","applyAction","action","clientWithHeaders","OntologiesV2.Actions.applyBatch","remapBatchActionParams","edits","remapActionResponse","OntologiesV2.Actions.apply","remapActionParams","parameterMap","param","editResponses","remappedActionResponse","editedObjectTypesSet","edit","osdkEdit","additionalContext","createSharedClientContext","userAgent","retryingFetchWithAuthOrThrow","betterError","START_TOKEN","OBJECT_OPEN_CHAR_CODE","OBJECT_CLOSE_CHAR_CODE","parseStreamedResponse","asyncIterable","utf8decoder","parsedStart","prevChunks","openBracesCount","chunk","startsWith","j","combineAndParse","b","prev","curr","str","iterateReadableStream","readableStream","res","getTimeRange","asyncIterPointsHelper","iterator","reader","point","GeotimeSeriesPropertyImpl","propertyName","initialValue","_triplet","latestPointPromise","OntologiesV2.TimeSeriesValueBankProperties.getLatestValue","latestPoint","err","allPoints","streamPointsIterator","OntologiesV2.TimeSeriesValueBankProperties.streamValues","timeseriesPoint","MediaReferencePropertyImpl","OntologiesV2.MediaReferenceProperties.getMediaContent","OntologiesV2.MediaReferenceProperties.getMediaMetadata","TimeSeriesPropertyImpl","OntologiesV2.TimeSeriesPropertiesV2.getFirstPoint","OntologiesV2.TimeSeriesPropertiesV2.getLastPoint","OntologiesV2.TimeSeriesPropertiesV2.streamPoints","hydrateAttachmentFromRidInternal","OntologiesV2.Attachments.read","OntologiesV2.Attachments.get","createObjectSpecifierFromPrimaryKey","extractPrimaryKeyFromObjectSpecifier","ObjectSpecifier","InterfaceDefinitions","UnderlyingOsdkObject","ObjectDefRef","InterfaceDefRef","ClientRef","createOsdkInterface","underlying","interfaceDef","clone","apiNamespace","targetPropName","remappedProps","mapProperty","get$as","$asFactory","osdkObjectToInterfaceView","targetMinDef","targetInterfaceApiName","existing","osdkInterface","get$link","holder","rawObj","linkName","linkDef","specialPropertyTypes","basePropDefs","createOsdkObject","newObject","simpleOsdkProperties","derivedPropertyTypeByName","propKey","createSpecialProperty","rawValue","rawObject","propDef","convertWireToOsdkObjects","objects","forceRemoveRid","derivedPropertyTypesByName","selectedProps","strictNonNull","fixObjectPropertiesInPlace","ifaceDef","ifaceSelected","objProps","conforming","invariantInterfacesAsViews","isConforming","reframeAsObjectInPlace","convertInterfacePropNamesToObjectPropNames","convertWireToOsdkObjects2","interfaceToObjectTypeMappings","interfaceToObjMapping","val","ifacePropsToMap","ifaceProp","newProps","sptProp","regularProp","propsToCheck","propName","warning","createClientCache","createAsyncClientCache","wirePropertyV2ToSdkPropertyDefinition","isNullable","log","sdkPropDefinition","objectPropertyTypeToSdkPropertyDefinition","propertyType","structMap","structField","__UNSTABLE_wireInterfaceTypeV2ToSdkObjectDefinition","v2","getModifiedEntityTypes","addedObjects","modifiedObjects","operation","wireActionTypeV2ToSdkActionMetadata","modifiedEntityTypes","wireActionParameterV2ToSdkParameterDefinition","createModifiedEntities","actionPropertyToSdkPropertyDefinition","parameterType","wirePropertyV2ToSdkPrimaryKeyTypeDefinition","wireObjectTypeFullMetadataToSdkObjectMetadata","objectTypeWithLink","impl","props","invertProps","supportedIconTypes","isNullableQueryDataType","wireQueryDataTypeToQueryDataTypeDefinition","allowNulls","nonNull","t","f","get2DQueryAggregationProps","get3DQueryAggregationProps","keyType","validMapKeyTypes","guardInvalidKeyTypes","wireQueryTypeV2ToSdkQueryMetadata","parameter","wireQueryParameterV2ToQueryParameterDefinition","loadActionMetadata","actionType","OntologiesV2.ActionTypesV2.get","loadFullObjectMetadata","full","OntologiesV2.ObjectTypesV2.getFullMetadata","loadInterfaceMetadata","OntologiesV2.OntologyInterfaces.get","loadQueryMetadata","queryTypeApiNameAndVersion","version","OntologiesV2.QueryTypes.get","createStandardOntologyProviderFactory","makeGetter","interfaceDefs","queryCache","USER_AGENT","createMinimalClient","metadata","objectSetFactory","createOntologyProviderFactory","processedBaseUrl","minimalClient","fetchMetadataInternal","objectTypeDef","noop","levels","BaseLogger","bindings","_factory","level","ourLevel","MinimalLogger","msgs","toDataValueQueries","desiredType","entrySet","mapValue","applyQuery","qd","OntologiesV2.Queries.execute","remapQueryParams","objectOutputDefs","getRequiredDefinitions","remapQueryResponse","paramTypes","responseDataType","responseValue","withoutMultiplicity","createQueryObjectResponse","subtype","requiresConversion","getObjectSpecifier","groups","subResult","subKey","dataType","ActionInvoker","actionDef","QueryInvoker","queryDef","createClientInternal","fetchMetadata","createWithRid","fileName","OntologiesV2.MediaReferenceProperties.upload","objectOrInterfaceType","rids","createClient","$osdkMetadata","$ontologyRid","buildLegsFlightPlanner20","calculateFlightTimes","calculateSunriseSunset","createFlightLogObject","createFlightWithWaypoints","createNewFlightFp2","editExistingFlightFp2","flightAppUpdateEtdAndCrew","flightFuelFpv2","flightWeatherRiskTriggeredLightningWaves","getGlobalWindsForFlight","getWeatherForAlternates","pseudoWeatherSegments","singleFlightAutomation","updateAlternantOneStep","updateFastPlannerFlight","updateWeatherByRegion","weatherWebookNorwayV9","AirportsData","AllGtLocationsV2","Asset","BristowHelidecks","FlightFuelDburbury","FlightLogObject","FuelPolicyBuilder","InternationalWeather","LegObjectOutputObject","MainFlightObjectFp2","MainFuelV2","NorwayWeatherDatav2","NorwayWeatherSegments","NorwayWeatherXv8","RegionalWeatherMinimaSettings","User","looseInstanceOf","expected","clockSkew","clockTolerance","customFetch","modifyAssertion","jweDecrypt","useMtlsAlias","encoder","decoder","buf","CHUNK_SIZE","encodeBase64Url","arr","decodeBase64Url","binary","bytes","cause","OPE","b64u","LRU","maxSize","UnsupportedOperationError","OperationProcessingError","dpopNonces","isCryptoKey","isPrivateKey","isPublicKey","processDpopNonce","nonce","isJsonObject","prepareHeaders","signal","validateString","randomBytes","generateRandomCodeVerifier","generateRandomState","calculatePKCECodeChallenge","codeVerifier","getKeyAndKid","formUrlEncode","clientSecretBasic","clientId","clientSecret","username","password","psAlg","rsAlg","esAlg","keyToJws","getClockSkew","skew","getClockTolerance","tolerance","epochTime","clientAssertion","as","now","privateKeyJwt","kid","header","jwt","assertAs","assertClient","assertClientSecret","assertNoClientPrivateKey","clientAuthMethod","clientPrivateKey","assertNoClientSecret","clientAuthentication","signature","keyToSubtle","dpopProofJwt","htm","accessToken","privateKey","publicKey","publicJwk","jwkCache","getSetPublicJwkCache","kty","y","crv","jwk","validateEndpoint","endpoint","resolveEndpoint","alias","isOAuth2Error","authenticatedRequest","tokenEndpointRequest","grantType","refreshTokenGrantRequest","refreshToken","idTokenClaims","processGenericAccessTokenResponse","ignoreIdToken","ignoreRefreshToken","handleOAuthBodyError","assertReadableResponse","json","claims","validateJwt","checkSigningAlgorithm","noSignatureCheck","validatePresence","validateIssuer","validateAudience","branded","brand","searchParams","authorizationCodeGrantRequest","callbackParameters","redirectUri","code","getURLSearchParameter","jwtClaimNames","required","claim","processAuthorizationCodeOAuth2Response","revocationRequest","processRevocationResponse","checkRsaKeyAlgorithm","algorithm","ecdsaHashName","namedCurve","validateJwsSignature","protectedHeader","jws","checkAlg","getKey","decryptJwt","encodedSignature","length","issuer","skipStateCheck","expectNoState","validateAuthResponse","expectedState","iss","state","id_token","throwIfError","CustomEvent","localStorageKey","saveLocal","removeLocal","readLocal","saveSession","removeSession","readSession","common","_signIn","oauthHttpOptions","refresh","refreshTokenMarker","scopes","eventTarget","TypedEventTarget","makeTokenAndSaveRefresh","resp","refresh_token","expires_in","access_token","refreshTimeout","rmTimeout","restartRefreshTimer","pendingSignIn","signIn","getTokenOrUndefined","createAuthorizationServer","ctxPath","createAbortError","clearMethods","createDelay","defaultClear","defaultSet","milliseconds","timeoutId","settle","rejectFunction","clear","signalListener","delayPromise","processOptionsAndAssignDefaults","redirect_uri","useHistory","loginPage","postLoginPage","createPublicOauthClient","client_id","joinedScopes","authServer","getToken","maybeRefresh","maybeHandleAuthReturn","initiateLoginRedirect","go","expectRefreshToken","lastRefreshTokenMarker","initialRequestedScopes","areScopesEqual","oldUrl","_deleteUser","deleteUser","_list","list","_getBatch","getBatch","_getCurrent","getCurrent","_getMarkings","getMarkings","_profilePicture","profilePicture"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146]}