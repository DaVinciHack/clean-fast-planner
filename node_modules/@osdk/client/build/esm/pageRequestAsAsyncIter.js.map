{"version":3,"file":"pageRequestAsAsyncIter.js","names":["getResults","x","results","applyPageToken","payload","pageToken","undefined","pageRequestAsAsyncIter","call","values","nextArgs","initialPayload","r","q"],"sources":["pageRequestAsAsyncIter.ts"],"sourcesContent":["/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function getResults<T extends { results: any[] }>(x: T): T[\"results\"] {\n  return x.results;\n}\nexport function applyPageToken<\n  X,\n  T extends { pageToken: X | undefined },\n>(\n  payload: T,\n  { pageToken }: { pageToken: X | undefined },\n): typeof payload | undefined {\n  return pageToken\n    ? {\n      ...payload,\n      pageToken,\n    }\n    : undefined;\n}\nexport async function* pageRequestAsAsyncIter<P, Z, R>(\n  call: (payload: P) => Promise<R>,\n  values: (x: R) => Iterable<Z>,\n  nextArgs: (previousPayload: P, previousResult: R) => P | undefined,\n  initialPayload: P,\n): AsyncGenerator<Awaited<Z>, void, unknown> {\n  let payload: P | undefined = initialPayload;\n\n  while (payload) {\n    const r = await call(payload);\n    for (const q of values(r)) {\n      yield q;\n    }\n    payload = nextArgs(payload, r);\n  }\n}\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,OAAO,SAASA,UAAUA,CAA+BC,CAAI,EAAgB;EAC3E,OAAOA,CAAC,CAACC,OAAO;AAClB;AACA,OAAO,SAASC,cAAcA,CAI5BC,OAAU,EACV;EAAEC;AAAwC,CAAC,EACf;EAC5B,OAAOA,SAAS,GACZ;IACA,GAAGD,OAAO;IACVC;EACF,CAAC,GACCC,SAAS;AACf;AACA,OAAO,gBAAgBC,sBAAsBA,CAC3CC,IAAgC,EAChCC,MAA6B,EAC7BC,QAAkE,EAClEC,cAAiB,EAC0B;EAC3C,IAAIP,OAAsB,GAAGO,cAAc;EAE3C,OAAOP,OAAO,EAAE;IACd,MAAMQ,CAAC,GAAG,MAAMJ,IAAI,CAACJ,OAAO,CAAC;IAC7B,KAAK,MAAMS,CAAC,IAAIJ,MAAM,CAACG,CAAC,CAAC,EAAE;MACzB,MAAMC,CAAC;IACT;IACAT,OAAO,GAAGM,QAAQ,CAACN,OAAO,EAAEQ,CAAC,CAAC;EAChC;AACF","ignoreList":[]}