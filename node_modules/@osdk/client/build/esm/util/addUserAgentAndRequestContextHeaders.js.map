{"version":3,"file":"addUserAgentAndRequestContextHeaders.js","names":["createFetchHeaderMutator","addUserAgentAndRequestContextHeaders","client","withMetadata","fetch","headers","set","JSON","stringify","requestContext","osdkMetadata","extraUserAgent"],"sources":["addUserAgentAndRequestContextHeaders.ts"],"sourcesContent":["/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ObjectOrInterfaceDefinition } from \"@osdk/api\";\nimport { createFetchHeaderMutator } from \"@osdk/shared.net.fetch\";\nimport type { MinimalClient } from \"../MinimalClientContext.js\";\n\nexport const addUserAgentAndRequestContextHeaders = (\n  client: MinimalClient,\n  withMetadata: Pick<ObjectOrInterfaceDefinition, \"osdkMetadata\">,\n): MinimalClient => ({\n  ...client,\n  fetch: createFetchHeaderMutator(\n    client.fetch,\n    (headers) => {\n      headers.set(\n        \"X-OSDK-Request-Context\",\n        JSON.stringify(client.requestContext),\n      );\n\n      if (withMetadata.osdkMetadata) {\n        headers.set(\n          \"Fetch-User-Agent\",\n          withMetadata.osdkMetadata.extraUserAgent,\n        );\n      }\n      return headers;\n    },\n  ),\n});\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA,SAASA,wBAAwB,QAAQ,wBAAwB;AAGjE,OAAO,MAAMC,oCAAoC,GAAGA,CAClDC,MAAqB,EACrBC,YAA+D,MAC5C;EACnB,GAAGD,MAAM;EACTE,KAAK,EAAEJ,wBAAwB,CAC7BE,MAAM,CAACE,KAAK,EACXC,OAAO,IAAK;IACXA,OAAO,CAACC,GAAG,CACT,wBAAwB,EACxBC,IAAI,CAACC,SAAS,CAACN,MAAM,CAACO,cAAc,CACtC,CAAC;IAED,IAAIN,YAAY,CAACO,YAAY,EAAE;MAC7BL,OAAO,CAACC,GAAG,CACT,kBAAkB,EAClBH,YAAY,CAACO,YAAY,CAACC,cAC5B,CAAC;IACH;IACA,OAAON,OAAO;EAChB,CACF;AACF,CAAC,CAAC","ignoreList":[]}